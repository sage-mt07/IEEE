---
conversation_id: "996d8745-a62e-42eb-b0af-f2d82e7d908c"
title: "SQL Server UTF-8 変更方法"
create_time: 1706275108.186606
update_time: 1706660396.066357
language_guess: "en"
num_messages: 36
part_index: 1
part_count: 1
---

### system — 2024-01-26T13:18:28.186606+00:00

_(empty)_

### user — 2024-01-26T13:18:28.187753+00:00

Sqlserverで文字コードを932からutf-8に変更する方法と照合順序の関係、
Varchar型設定した長さとの関係を示せ

### assistant — 2024-01-26T13:19:24.559337+00:00

SQL Serverで文字コード（エンコーディング）を変更することは、データベース作成時や特定のテキスト型のカラムを定義する際に考慮されるべきです。SQL Serverでは、文字コードは直接指定されるのではなく、照合順序（Collation）を通じて管理されます。照合順序は、文字の比較、並べ替え、およびデータの格納方法を決定します。

### 文字コードの変更: 932からUTF-8へ

SQL Server 2019 (15.x) CU8以降、`UTF-8`をサポートしています。これにより、`VARCHAR`にUTF-8エンコーディングを使用することが可能になりました。以前のバージョンでは、`NVARCHAR`を使用してUnicodeデータを格納する必要がありましたが、`NVARCHAR`はUTF-16を使用します。

#### 照合順序の指定

- **932 (Shift_JIS)**: SQL Serverで932コードページを使用する場合、照合順序には日本語固有のものを指定します。例えば、`Japanese_CI_AS`などです。

- **UTF-8**: UTF-8を使用するには、照合順序に`_UTF8`を含むものを指定する必要があります。例えば、`Latin1_General_100_CI_AS_SC_UTF8`です。これにより、その照合順序を使用する列はUTF-8でエンコードされます。

#### `VARCHAR`と`NVARCHAR`の長さの関係

- **`VARCHAR`**: SQL Serverでは、`VARCHAR`列の最大長は8000バイトです。UTF-8を使用すると、1文字を1から4バイトでエンコードするため、実際に格納できる文字数は指定したサイズに依存します。英数字などの基本的なラテン文字は1バイト、多くの日本語文字は3バイトでエンコードされます。

- **`NVARCHAR`**: `NVARCHAR`列の最大長は4000文字ですが、UTF-16を使用しているため、ほとんどの文字は2バイトでエンコードされます。これは、日本語文字を含む多くのUnicode文字を扱うのに適しています。

### 変更手順

1. **新規データベースの作成時**:
   SQL Serverで新規データベースを作成する際には、`CREATE DATABASE`文で照合順序を指定できます。UTF-8サポートが必要な場合は、照合順序に`_UTF8`を含むものを選択します。

2. **既存のカラムの変更**:
   既存のテーブルのカラムでエンコーディングを変更する場合、`ALTER TABLE`文を使用してカラムのデータ型を変更します。例えば、`VARCHAR`から`NVARCHAR`へ、またはUTF-8サポートを持つ`VARCHAR`への変更が考えられます。

3. **データの移行**:
   文字コードの変更はデータの再エンコーディングを伴うため、データのバックアップと適切な変換手順を計画することが重要です。

注意点として、UTF-8を使用することでデータの格納効率を向上させることができますが、アプリケーションの互換性や照合順序に関する挙動の変化にも注意を払う必要があります。

### user — 2024-01-26T13:22:55.331976+00:00

Japanese_CI_ASからLatin1_General_100_CI_AS_SC_UTF8に変更後、ソート順は変わるのか

### assistant — 2024-01-26T13:23:34.270821+00:00

はい、照合順序を`Japanese_CI_AS`から`Latin1_General_100_CI_AS_SC_UTF8`に変更すると、ソート順が変わる可能性があります。照合順序はデータベースやテーブル、カラムレベルで文字の比較やソートの方法を定義します。これには、大文字と小文字の区別、アクセントの有無、文字の種類（ラテン文字や日本語文字など）がどのように扱われるかが含まれます。

`Japanese_CI_AS`照合順序は、日本語の文字に特化しており、日本語のソート順（例えば五十音順）や比較ルールを適用します。これには、カタカナやひらがな、漢字の扱いが含まれ、日本語の比較やソートに適したルールが適用されます。

一方で、`Latin1_General_100_CI_AS_SC_UTF8`は、ラテン文字を主に対象とした照合順序で、UTF-8エンコーディングをサポートしています。この照合順序では、ラテン文字のソート順や比較ルールが適用されるため、日本語文字のソートや比較の挙動が変わる可能性があります。

具体的には、日本語文字のソート順が`Japanese_CI_AS`を使用していた時とは異なり、ラテン文字中心のソートルールに従うようになります。これにより、日本語文字の間での相対的な順序や、日本語文字とラテン文字の間でのソート順が変わる可能性があります。

アプリケーションが特定の言語の文字でのソート順や比較を重視する場合、照合順序を変更する前に、新しい照合順序が期待する挙動を提供するかどうかを慎重に検討する必要があります。特に多言語を扱う環境では、照合順序の選択がアプリケーションの動作に大きく影響することがあります。

### user — 2024-01-26T13:30:33.323021+00:00

Utf-8 を格納するのに適した型を示せ

### assistant — 2024-01-26T13:31:28.528594+00:00

SQL ServerでUTF-8エンコーディングを格納する場合、適したデータ型は次の通りです：

### `VARCHAR`（UTF-8を明示的にサポートする場合）

SQL Server 2019 (15.x) CU8以降では、`VARCHAR`列にUTF-8エンコーディングを使用することが可能です。これは`_UTF8`を含む照合順序を指定することで実現できます。この場合、`VARCHAR`データ型を使用することで、UTF-8でエンコードされたテキストデータを格納できます。例えば、以下のようにテーブルを作成できます：

```sql
CREATE TABLE ExampleTable (
    ExampleColumn VARCHAR(100) COLLATE Latin1_General_100_CI_AS_SC_UTF8
)
```

この定義では、`ExampleColumn`はUTF-8エンコーディングを使用して最大100文字のデータを格納できます。`VARCHAR`を使用する利点は、必要なストレージサイズが減少する可能性があることです（特に英数字のみのテキストの場合）。ただし、格納できる実際の文字数は、使用される特定の文字によって異なります（UTF-8では1文字あたり1～4バイトを使用）。

### `NVARCHAR`（従来のUnicodeサポート）

`NVARCHAR`データ型は従来からSQL Serverでサポートされており、Unicodeデータ（UTF-16エンコーディング）を格納するために広く使用されています。`NVARCHAR`はすべてのUnicode文字をサポートしているため、UTF-8を格納する必要がある場合でも使用できますが、UTF-16を使用するため、UTF-8と比較してストレージ効率が低い可能性があります。

```sql
CREATE TABLE ExampleTable (
    ExampleColumn NVARCHAR(100)
)
```

### 選択肢の比較

- **`VARCHAR`（UTF-8使用）**: ストレージ効率が良い（英数字などは1バイトで格納）。しかし、特定の文字（例：多くの日本語文字）は3バイトを使用するため、指定した列の長さよりも少ない文字数を格納できる場合がある。

- **`NVARCHAR`（UTF-16使用）**: すべてのUnicode文字を等しく2バイト（一部の補助文字は4バイト）で格納するため、文字によるバイト数の変動が少ない。しかし、英数字などの簡単なテキストに対しては、`VARCHAR`を使用するよりも多くのストレージを消費する。

適切なデータ型の選択は、格納されるデータの種類、ストレージ効率、およびアプリケーションの要件に基づいて行うべきです。UTF-8エンコーディングが必要な場合、SQL Server 2019以降で`VARCHAR`に`_UTF8`照合順序を使用するのが一般的です。

### user — 2024-01-26T13:33:25.518807+00:00

Utf-8 の1文字が使用する最大値は3バイトではないのか

### assistant — 2024-01-26T13:33:44.962170+00:00

UTF-8エンコーディングは、1文字を表現するのに1バイトから最大4バイトまで使用します。私の以前の回答で、日本語文字に関して一般的に3バイトを使用すると述べましたが、正確にはUTF-8が1文字をエンコードするのに使うバイト数の最大値は4バイトです。これは、基本的な英数字やASCII互換の文字が1バイト、ヨーロッパや中東のアルファベットが2バイト、東アジアの文字（一部の日本語文字を含む）が3バイト、補助文字や特殊な記号、絵文字などが4バイトを使用します。

この誤解を招く表現については、訂正します。UTF-8の使用において、1文字が最大で4バイトを使用する可能性があることを正しく認識することが重要です。これは、特にデータベースでのデータ型のサイズ指定や、テキストデータの格納に関して、考慮すべき点です。

SQL Server 2019以降でUTF-8エンコーディングを使用する`VARCHAR`列を定義する際は、列が受け入れることができる最大文字数が、使用される具体的な文字によって変わることを理解しておく必要があります。特に、多言語環境や絵文字などの特殊文字を多用するアプリケーションでは、これが重要になります。

### user — 2024-01-26T13:34:52.399466+00:00

サロゲートペアは4バイトを使用するのか

### assistant — 2024-01-26T13:35:32.413607+00:00

はい、UTF-8において、サロゲートペアを使用する文字は4バイトを消費します。サロゲートペアは、Unicode標準で基本多言語面（BMP）外の文字をエンコードするために使用される方法です。これには、追加の象形文字や絵文字、古代の言語の文字などが含まれます。

Unicodeでは、これらの文字を表現するために2つの16ビットのコード（合わせて32ビット、または4バイト）を使用します。これらは「ハイサロゲート」と「ローサロゲート」と呼ばれ、一緒になって1つのUnicode文字を形成します。

UTF-16では、これらのサロゲートペアは常に2つの16ビット単位（合計で32ビットまたは4バイト）としてエンコードされます。一方、UTF-8では、各文字を1バイトから4バイトの範囲でエンコードする可変長エンコーディングを使用します。そのため、サロゲートペアを表現するために必要なUTF-8エンコーディングは4バイトになります。

サロゲートペアを使用する文字は、Unicodeスカラ値の範囲U+10000からU+10FFFFに含まれます。UTF-8では、これらの文字をエンコードする際に11110xxx 10xxxxxx 10xxxxxx 10xxxxxxのパターンを使用します。ここでxは実際のビットで、4バイトの合計で文字のコードポイントを表します。

データベースや他のテキスト処理システムでこれらの文字を扱う場合は、適切なストレージ容量を確保するために、これらの文字が4バイトを使用することを考慮に入れる必要があります。特に、SQL ServerのようなシステムでUTF-8エンコーディングを使用する`VARCHAR`列を定義する際には、列の最大サイズを計画する上で重要です。

### user — 2024-01-28T06:56:51.317970+00:00

Utf-16の1文字の最大バイト数

### assistant — 2024-01-28T06:57:09.289371+00:00

UTF-16は可変長エンコーディングで、1文字を表現するために最大で4バイトを使用します。通常、UTF-16ではほとんどの文字が2バイトで表現されますが、補助文字（サロゲートペアを使用する文字）には4バイト（2つの16ビットコードユニット）が必要です。

このような補助文字には、いくつかの絵文字、特定の象形文字、古代言語の文字などが含まれます。これらは基本多言語面（BMP）を超えるUnicodeの範囲に属しており、サロゲートペアとしてエンコードされます。

要約すると、UTF-16では一般的な文字が2バイトを使用し、補助文字が4バイトを使用します。

### user — 2024-01-28T09:48:16.632315+00:00

以下のURLの情報をJapanese_CI_ASを照合順序としている前提でUTF-8を扱う際の問題点についてまとめよ
https://blog.engineer-memo.com/2022/03/17/sql-server-%E3%81%AE%E5%88%9D%E6%9C%9F%E8%A8%AD%E5%AE%9A%E3%81%AE%E7%85%A7%E5%90%88%E9%A0%86%E5%BA%8F-japanese_ci_as-sql_latin1_general_cp1_ci_as-%E3%81%A7%E3%80%81unicode-%E6%96%87%E5%AD%97/

### system — 2024-01-28T09:49:04.865038+00:00

_(empty)_

### assistant — 2024-01-28T09:49:04.865675+00:00

open_url("https://blog.engineer-memo.com/2022/03/17/sql-server-%E3%81%AE%E5%88%9D%E6%9C%9F%E8%A8%AD%E5%AE%9A%E3%81%AE%E7%85%A7%E5%90%88%E9%A0%86%E5%BA%8F-japanese_ci_as-sql_latin1_general_cp1_ci_as-%E3%81%A7%E3%80%81unicode-%E6%96%87%E5%AD%97/")

### tool — 2024-01-28T09:49:04.867920+00:00

Error when executing command `open_url(https://blog.engineer-memo.com/2022/03/17/sql-server-%E3%81%AE%E5%88%9D%E6%9C%9F%E8%A8%AD%E5%AE%9A%E3%81%AE%E7%85%A7%E5%90%88%E9%A0%86%E5%BA%8F-japanese_ci_as-sql_latin1_general_cp1_ci_as-%E3%81%A7%E3%80%81unicode-%E6%96%87%E5%AD%97/)`
Failed to fetch page w/ URL: https://blog.engineer-memo.com/2022/03/17/sql-server-%E3%81%AE%E5%88%9D%E6%9C%9F... (URL truncated at 80 chars)
URL does not appear to be text: https://blog.engineer-memo.com/2022/03/17/sql-server-%E3%81%AE%E5%88%9D%E6%9C%9F%E8%A8%AD%E5%AE%9A%E3%81%AE%E7%85%A7%E5%90%88%E9%A0%86%E5%BA%8F-japanese_ci_as-sql_latin1_general_cp1_ci_as-%E3%81%A7%E3%80%81unicode-%E6%96%87%E5%AD%97/

### assistant — 2024-01-28T09:49:04.868074+00:00

現在のツールでは、指定されたURLを直接開くことができません。しかし、一般的に、SQL Serverで`Japanese_CI_AS`照合順序を使用しながらUTF-8を扱う際にはいくつかの注意点があります：

1. **照合順序とエンコーディングの互換性**：`Japanese_CI_AS`は日本語の文字に特化しており、通常はShift-JISやEUC-JPなどのエンコーディングに最適化されています。UTF-8でエンコードされたデータを使用する場合、予期しないソート順や文字列比較の結果が生じる可能性があります。

2. **文字列関数の挙動**：日本語環境でUTF-8を使用する場合、特定の文字列関数が期待通りに動作しないことがあります。これは、UTF-8が可変長エンコーディングであり、特定の日本語文字が複数バイトを消費するためです。

3. **インデックスと検索パフォーマンス**：照合順序とエンコーディングの不一致は、インデックスの効率や検索クエリのパフォーマンスに影響を与える可能性があります。

これらのポイントを踏まえ、UTF-8と特定の照合順序を組み合わせる際は、アプリケーションの要件とデータベースの挙動を十分に検討し、適切なテストを行うことが重要です。

### user — 2024-01-28T09:50:15.584476+00:00

SQLServerでUNICODE3.2以降を使用する日本語の照合順序に設定する値を示せ

### assistant — 2024-01-28T09:50:35.018232+00:00

SQL ServerでUnicode 3.2以降の日本語文字をサポートする照合順序を使用するには、`Japanese_XJIS_140_CI_AS`または`Japanese_Bushu_Kakusu_140_CI_AS`のいずれかを指定します。これらの照合順序は、SQL Server 2017以降で導入されたもので、より最新のUnicodeバージョンに基づいた日本語の比較とソートを提供します。これにより、新しい日本語文字や異体字など、Unicode 3.2以降で追加された文字を適切に扱うことができます。これらの照合順序を使用することで、日本語のデータベース処理において、より現代的で包括的な文字サポートが可能になります。

### user — 2024-01-28T09:51:57.478211+00:00

Japanese_XJIS_140_CI_AS_UTF8はSQLServer 2019で使用できるのか

### assistant — 2024-01-28T09:52:21.751519+00:00

search("Japanese_XJIS_140_CI_AS_UTF8 SQL Server 2019 support")

### tool — 2024-01-28T09:52:21.753868+00:00

_(empty)_

### assistant — 2024-01-28T09:52:21.756767+00:00

Based on a [quick search](https://chat.openai.com/backend-api/bing/redirect?query=Japanese_XJIS_140_CI_AS_UTF8%20SQL%20Server%[[REDACTED_PHONE]]%20support), here's what I found.

### assistant — 2024-01-28T09:52:21.756947+00:00

mclick([7])

### tool — 2024-01-28T09:52:21.760776+00:00

accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_Bushu_Kakusu_140_CS_AS_KS_WS_VSS_UTF8 Japanese-Bushu-Kakusu-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_Bushu_Kakusu_140_CI_AI_UTF8 Japanese-Bushu-Kakusu-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CI_AI_WS_UTF8 Japanese-Bushu-Kakusu-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CI_AI_KS_UTF8 Japanese-Bushu-Kakusu-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CI_AI_KS_WS_UTF8 Japanese-Bushu-Kakusu-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CI_AS_UTF8 Japanese-Bushu-Kakusu-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CI_AS_WS_UTF8 Japanese-Bushu-Kakusu-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CI_AS_KS_UTF8 Japanese-Bushu-Kakusu-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CI_AS_KS_WS_UTF8 Japanese-Bushu-Kakusu-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CS_AI_UTF8 Japanese-Bushu-Kakusu-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CS_AI_WS_UTF8 Japanese-Bushu-Kakusu-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CS_AI_KS_UTF8 Japanese-Bushu-Kakusu-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CS_AI_KS_WS_UTF8 Japanese-Bushu-Kakusu-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CS_AS_UTF8 Japanese-Bushu-Kakusu-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CS_AS_WS_UTF8 Japanese-Bushu-Kakusu-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CS_AS_KS_UTF8 Japanese-Bushu-Kakusu-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_Bushu_Kakusu_140_CS_AS_KS_WS_UTF8 Japanese-Bushu-Kakusu-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_BIN Japanese-XJIS-140, binary sort 

Japanese_XJIS_140_BIN2 Japanese-XJIS-140, binary code point comparison sort 

Japanese_XJIS_140_CI_AI_VSS Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CI_AI_WS_VSS Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CI_AI_KS_VSS Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CI_AI_KS_WS_VSS Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CI_AS_VSS Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CI_AS_WS_VSS Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CI_AS_KS_VSS Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CI_AS_KS_WS_VSS Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CS_AI_VSS Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CS_AI_WS_VSS Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CS_AI_KS_VSS Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CS_AI_KS_WS_VSS Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CS_AS_VSS Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CS_AS_WS_VSS Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CS_AS_KS_VSS Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CS_AS_KS_WS_VSS Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector sensitive 

Japanese_XJIS_140_CI_AI Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CI_AI_WS Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CI_AI_KS Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CI_AI_KS_WS Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CI_AS Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CI_AS_WS Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CI_AS_KS Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CI_AS_KS_WS Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CS_AI Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CS_AI_WS Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CS_AI_KS Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CS_AI_KS_WS Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CS_AS Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CS_AS_WS Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CS_AS_KS Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CS_AS_KS_WS Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive 

Japanese_XJIS_140_CI_AI_VSS_UTF8 Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CI_AI_WS_VSS_UTF8 Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CI_AI_KS_VSS_UTF8 Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CI_AI_KS_WS_VSS_UTF8 Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CI_AS_VSS_UTF8 Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CI_AS_WS_VSS_UTF8 Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CI_AS_KS_VSS_UTF8 Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CI_AS_KS_WS_VSS_UTF8 Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CS_AI_VSS_UTF8 Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CS_AI_WS_VSS_UTF8 Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CS_AI_KS_VSS_UTF8 Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CS_AI_KS_WS_VSS_UTF8 Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CS_AS_VSS_UTF8 Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CS_AS_WS_VSS_UTF8 Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CS_AS_KS_VSS_UTF8 Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CS_AS_KS_WS_VSS_UTF8 Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector sensitive, UTF8 

Japanese_XJIS_140_CI_AI_UTF8 Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CI_AI_WS_UTF8 Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CI_AI_KS_UTF8 Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CI_AI_KS_WS_UTF8 Japanese-XJIS-140, case-insensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CI_AS_UTF8 Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CI_AS_WS_UTF8 Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CI_AS_KS_UTF8 Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CI_AS_KS_WS_UTF8 Japanese-XJIS-140, case-insensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CS_AI_UTF8 Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CS_AI_WS_UTF8 Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CS_AI_KS_UTF8 Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CS_AI_KS_WS_UTF8 Japanese-XJIS-140, case-sensitive, accent-insensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CS_AS_UTF8 Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CS_AS_WS_UTF8 Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-insensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CS_AS_KS_UTF8 Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-insensitive, supplementary characters, variation selector insensitive, UTF8 

Japanese_XJIS_140_CS_AS_KS_WS_UTF8 Japanese-XJIS-140, case-sensitive, accent-sensitive, kanatype-sensitive, width-sensitive, supplementary characters, variation selector insensitive, UTF8

Viewing 3 posts - 1 through 2 (of 2 total)

You must be logged in to reply to this topic. 【19†Login to reply】

[Image 2: 2024 State of the Database Landscape]

  * 【25†About SQLServerCentral】
  * 【26†Contact Us】
  * 【27†Terms of Use】
  * 【28†Privacy Policy】
  * 【29†Contribute】
  * 【30†Contributors】
  * 【31†Authors】
  * 【32†Newsletters】

[Image 3: Redgate logo]
Visible: 44% - 100%

### assistant — 2024-01-28T09:52:21.763602+00:00

SQL Server 2019では、`Japanese_XJIS_140`に基づく様々なUTF-8対応の照合順序が利用可能です。これらには`Japanese_XJIS_140_CI_AS_UTF8`などが含まれ、日本語の処理において、ケース感度、アクセント感度、かなタイプ感度、幅感度、補助文字、および変種セレクタの感度に関する様々なオプションが提供されています。これにより、SQL Server 2019でより洗練された日本語の処理とUTF-8エンコーディングのサポートが実現されています【24†source】。

### user — 2024-01-31T00:09:34.238228+00:00

以下の文を読みやすくしてください
SQLServer2019以降でUTF-8をサポートしております。
以降の説明はSQLServer2019を前提に記載します。
　アプリケーションでUTF-8を利用する場合、格納対象ではUTF-8を利用するための照合順序の設定が必要になります。
　設定しない場合、他の形式での格納となるため、一部の文字が使用できないことが想定されます。
　特にUTF-8特有の組合せ文字、サロゲートペアに対する検索は誤った値を返す可能性があります。
　設定する照合順序についてはCodePage932の標準から考えると、Japanese_XJIS_140_CI_AS_UTF8が適していると考えられます。
　UTF-8を使用する場合VARCHAR型を使用します。定義した長さは格納バイト数を示すため、
　１文字あたり１～４バイトを使用するUTF-8を使用する場合、定義する長さを変更する必要があります。
　格納サイズの増加はインデックス、使用メモリ、ディスクサイズに影響を与えることが考えられます。
   SQLServerはインストール時に設定した文字コードをtempdbに適用するため
　ソート、一時テーブルを利用する場合にインストール時に設定した文字コードと異なる場合
　想定した処理結果にならないことが生じます。

### assistant — 2024-01-31T00:09:54.855490+00:00

SQL Server 2019以降では、UTF-8がサポートされています。UTF-8を使用する場合、適切な照合順序の設定が重要です。これを設定しないと、一部の文字が正しく格納されない可能性があります。特に、UTF-8の組み合わせ文字やサロゲートペアの検索に影響があります。`Japanese_XJIS_140_CI_AS_UTF8`が適切な照合順序と考えられます。UTF-8を使用する際には`VARCHAR`型を選択し、文字によって1～4バイトを使用するため、定義する列の長さを調整する必要があります。この変更はストレージサイズやパフォーマンスに影響を与える可能性があります。また、インストール時の文字コード設定はtempdbにも適用され、ソートや一時テーブルの処理に影響することがあります。

### user — 2024-01-31T00:11:44.514884+00:00

UTF-8を使用する際にはVARCHAR型を選択し、文字によって1～4バイトを使用するため
の部分はUTF-8が文字によって1～4バイトを使用するためとなる意味にとれるよう変更

### assistant — 2024-01-31T00:11:51.156938+00:00

UTF-8を使用する際、`VARCHAR`型を選択します。UTF-8は文字によって1～4バイトの範囲でバイト数を変えるため、列の長さを設定する際にこの特性を考慮する必要があります。

### user — 2024-01-31T00:14:00.088122+00:00

インストール時はSQLServerインストール時に変更

### assistant — 2024-01-31T00:14:14.542448+00:00

UTF-8を使用する際、`VARCHAR`型が適しています。UTF-8では、文字によって使用するバイト数が1～4バイトと変動するため、列の長さ設定にはこの特性を考慮する必要があります。また、SQL Serverのインストール時に設定された文字コードは、tempdbにも適用されます。このため、インストール時の設定と異なる文字コードを使用する場合、ソートや一時テーブルの処理結果が想定と異なることがあります。

### user — 2024-01-31T00:19:29.363342+00:00

以下の文を読みやすく
Server 2019以降では、UTF-8がサポートされています。以下UTF-8を使用するためのユーザーテーブルの設定とインスタンスの設定に関して記載します。

照合順序の設定

UTF-8を使用する場合、適切な照合順序の設定が重要です。これを設定しないと、一部の文字が正しく格納されない可能性があります。特に、UTF-8の組み合わせ文字やサロゲートペアの検索に影響があります。

設定する照合順序の値

Japanese_CI_ASから変更する値としてはJapanese_XJIS_140_CI_AS_UTF8が適切な照合順序と考えられます。

使用する型とサイズ

UTF-8を使用する際、VARCHAR型を選択します。UTF-8は文字によって1～4バイトの範囲でバイト数を変えるため、列の長さを設定する際にこの特性を考慮する必要があります。この変更はストレージサイズや使用メモリサイズに影響を与える可能性があります。

インスタンス設定に関して

また、SQL Serverのインストール時に設定された文字コードは、tempdbにも適用されます。このため、インストール時の設定と異なる文字コードを使用する場合、ソートや一時テーブルの処理結果が想定と異なることがあります。

### assistant — 2024-01-31T00:19:55.907772+00:00

SQL Server 2019以降ではUTF-8がサポートされています。UTF-8を使用する際の重要な点は以下の通りです：

1. **照合順序の設定**：適切な照合順序を設定することで、一部の文字の格納問題を防ぎます。特に、UTF-8の組み合わせ文字やサロゲートペアに影響があります。

2. **照合順序の値**：`Japanese_CI_AS`から変更する場合、`Japanese_XJIS_140_CI_AS_UTF8`が適切です。

3. **使用する型とサイズ**：`VARCHAR`型を選択し、UTF-8の1～4バイトの可変長特性に基づいて列の長さを設定します。これはストレージやメモリサイズに影響を与えます。

4. **インスタンス設定**：SQL Serverのインストール時の文字コード設定がtempdbに影響し、異なる文字コードの使用がソートや一時テーブル処理結果に影響する可能性があります。
