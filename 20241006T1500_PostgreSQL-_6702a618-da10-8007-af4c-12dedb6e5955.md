---
conversation_id: "6702a618-da10-8007-af4c-12dedb6e5955"
title: "PostgreSQL 行圧縮とページ圧縮"
create_time: 1728226841.087368
update_time: 1728227059.54321
language_guess: "en"
num_messages: 17
part_index: 1
part_count: 1
---

### system — 2024-10-06T15:00:41.087368+00:00

_(empty)_

### user — 2024-10-06T15:00:41.093066+00:00

Postgresql にpage圧縮　行圧縮はありのか

### assistant — 2024-10-06T15:00:49.479516+00:00

_(empty)_

### assistant — 2024-10-06T15:00:49.479600+00:00

PostgreSQL では、直接的な「行圧縮」や「ページ圧縮」の機能は標準的にはサポートされていませんが、データを圧縮するためのいくつかの手法があります。

1. **TOAST (The Oversized-Attribute Storage Technique)**:  
   PostgreSQL は、大きなデータ (例えば、TEXTやBYTEA型) を自動的に分割し、圧縮して保存するためにTOASTを利用します。これにより、大きな列データは圧縮されてストレージに保存されます。

2. **pg_hint_plan を用いたクエリの最適化**:
   データベースのクエリが効率的に処理されるように、pg_hint_plan などの拡張モジュールを使用することで、適切なインデックスの利用やデータ処理を改善し、結果的に I/O 負荷を減らすことができます。

3. **テーブルや列の圧縮**:
   データベースの物理的なサイズを小さくするために、 `pg_dump` と `pg_restore` を使ってデータベース全体を圧縮してバックアップし、復元する手法があります。ただし、これはバックアップの圧縮であり、データベースそのものの圧縮とは異なります。

4. **拡張モジュール (pg_compression、zheap)**:
   外部の拡張機能を使うことで、データベース自体にページや行の圧縮を実装することも可能です。例えば、`zheap` というプロジェクトがあり、これはページ圧縮と行圧縮を提供するための実験的な取り組みです。

標準的な PostgreSQL では、ページ圧縮や行圧縮の機能はないものの、TOASTによる大規模データの圧縮や、クエリの最適化によってデータベースのパフォーマンスを改善する手法が主に使われています。

### user — 2024-10-06T15:02:52.618436+00:00

Azure postgresql でzheapは使える

### assistant — 2024-10-06T15:03:03.873116+00:00

search("Azure PostgreSQL support for zheap")

### tool — 2024-10-06T15:03:03.873215+00:00

_(empty)_

### assistant — 2024-10-06T15:03:03.873649+00:00

mclick([0, 16, 13, 10, 17])

### tool — 2024-10-06T15:03:03.874043+00:00

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

【0†Download Microsoft Edge†go.microsoft.com】 【1†More info about Internet Explorer and Microsoft Edge】 

Table of contents Exit focus mode

  Read in English Save 【2† †github.com】  

Table of contents  Read in English Save Add to Plan 【2† Edit †github.com】

* * *

#### Share via

Facebook x.com LinkedIn Email

* * *

Print

Table of contents

# Supported PostgreSQL versions in Azure Database for PostgreSQL - Flexible Server

  * Article 
  * 09/30/2024
  * 10 contributors

   Feedback

## In this article

APPLIES TO: [Image 0] Azure Database for PostgreSQL - Flexible Server

Azure Database for PostgreSQL flexible server currently supports the following major versions.

## PostgreSQL version 17 (preview)

PostgreSQL 17 preview is now available available in "East Asia" starting immediately with more regions coming soon. Refer to the 【3†PostgreSQL documentation†www.postgresql.org】 to learn more about new feature and improvements in this latest postgres release.

## PostgreSQL version 16

The current minor release is 16.4. Refer to the 【4†PostgreSQL documentation†www.postgresql.org】 to learn more about improvements and fixes in this release. New servers are created with this minor version.

## PostgreSQL version 15

The current minor release is 15.8. Refer to the 【5†PostgreSQL documentation†www.postgresql.org】 to learn more about improvements and fixes in this release. New servers are created with this minor version.

## PostgreSQL version 14

The current minor release is 14.13. Refer to the 【6†PostgreSQL documentation†www.postgresql.org】 to learn more about improvements and fixes in this release. New servers are created with this minor version.

## PostgreSQL version 13

The current minor release is 13.16. Refer to the 【7†PostgreSQL documentation†www.postgresql.org】 to learn more about improvements and fixes in this release. New servers are created with this minor version.

## PostgreSQL version 12

The current minor release is 12.20. Refer to the 【8†PostgreSQL documentation†www.postgresql.org】 to learn more about improvements and fixes in this release. New servers are created with this minor version. Your existing servers are automatically upgraded to the latest supported minor version in your future scheduled maintenance window.

## PostgreSQL version 11

The current minor release is 11.22. Refer to the 【9†PostgreSQL documentation†www.postgresql.org】 to learn more about improvements and fixes in this release. New servers are created with this minor version. Your existing servers are automatically upgraded to the latest supported minor version in your future scheduled maintenance window.

## PostgreSQL version 10 and older

We don't support PostgreSQL version 10 and older for Azure Database for PostgreSQL flexible server. Use the 【10†Azure Database for PostgreSQL single server】 deployment option if you require older versions.

## Managing upgrades

The PostgreSQL project regularly issues minor releases to fix reported bugs. Azure Database for PostgreSQL flexible server automatically patches servers with minor releases during the service's monthly deployments.

It's also possible to do in-place major version upgrades by using the 【11†major version upgrade】 feature. This feature greatly simplifies the upgrade process of an instance from a major version (PostgreSQL 11, for example) to any higher supported version (like PostgreSQL 16).

## Supportability and retirement policy of the underlying operating system

Azure Database for PostgreSQL flexible server is a fully managed open-source database. The underlying operating system is an integral part of the service. Microsoft continually works to ensure ongoing security updates and maintenance for security compliance and vulnerability mitigation, whether a partner or an internal vendor provides them. Automatic upgrades during scheduled maintenance help keep your managed database secure, stable, and up to date.

## Managing PostgreSQL engine defects

Microsoft has a team of committers and contributors who work full time on the open-source Postgres project and are long-term members of the community. Our contributions include features, performance enhancements, bug fixes, and security patches, among other things. Our open-source team also incorporates feedback from our Azure fleet (and customers) when prioritizing work. But keep in mind that the Postgres project has its own independent contribution guidelines, review process, and release schedule.

When we identify a defect with PostgreSQL engine, we take immediate action to mitigate the problem. If it requires code change, we fix the defect to address the production issue, if possible. We work with the community to incorporate the fix as quickly as possible.

## Next steps

Learn about 【12†PostgreSQL extensions】.

* * *

## Feedback

Was this page helpful?

Yes No

【13† Provide product feedback †feedback.azure.com】|

【14† Get help at Microsoft Q&A 】

* * *

## Additional resources

【15† California Consumer Privacy Act (CCPA) Opt-Out Icon Your Privacy Choices †aka.ms】 

Theme

  * Light
  * Dark
  * High contrast

  *   * 【16†Previous Versions】
  * 【17†Blog†techcommunity.microsoft.com】
  * 【18†Contribute】
  * 【19†Privacy†go.microsoft.com】
  * 【20†Terms of Use】
  * 【21†Trademarks†www.microsoft.com】
  * © Microsoft 2024

## Additional resources

### In this article

【15† California Consumer Privacy Act (CCPA) Opt-Out Icon Your Privacy Choices †aka.ms】 

Theme

  * Light
  * Dark
  * High contrast

  *   * 【16†Previous Versions】
  * 【17†Blog†techcommunity.microsoft.com】
  * 【18†Contribute】
  * 【19†Privacy†go.microsoft.com】
  * 【20†Te

### tool — 2024-10-06T15:03:03.874374+00:00

Cancel  Submit feedback 

#  Saved searches 

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our 【40†documentation†docs.github.com】. 

Cancel  Create saved search 

【1† Sign in 】 

【41† Sign up 】 

You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session.   Dismiss alert

{{ message }}

【42† EnterpriseDB 】  / 【43†zheap】  Public

  * 【44† Notifications 】 You must be signed in to change notification settings
  * 【44† Fork 37 】 
  * 【44† Star 223 】 

new heap with in-place update, powered by undo, for eventual integration into PostgreSQL 

【45† 223 stars 】 【46† 37 forks 】 【47† Branches 】 【48† Tags 】 【49† Activity 】 

【44† Star 】 

【44† Notifications 】 You must be signed in to change notification settings

  * 【43† Code 】
  * 【50† Issues 1 】
  * 【51† Pull requests 0 】
  * 【52† Actions 】
  * 【53† Projects 0 】
  * 【54† Security 】
  * 【55† Insights 】

  Additional navigation options  

  * 【43† Code 】 
  * 【50† Issues 】 
  * 【51† Pull requests 】 
  * 【52† Actions 】 
  * 【53† Projects 】 
  * 【54† Security 】 
  * 【55† Insights 】 

# EnterpriseDB/zheap

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

 master

【47†Branches】【48†Tags】

Go to file 

Code

## Folders and files 

Name Name 

Last commit message 

Last commit date   

## Latest commit

## History

【56†47,249 Commits】  

【57†config】

【57†config】

【58†contrib】

【58†contrib】

【59†doc】

【59†doc】

【60†src】

【60†src】

【61†.dir-locals.el】

【61†.dir-locals.el】

【62†.gitattributes】

【62†.gitattributes】

【63†.gitignore】

【63†.gitignore】

【64†COPYRIGHT】

【64†COPYRIGHT】

【65†GNUmakefile.in】

【65†GNUmakefile.in】

【66†HISTORY】

【66†HISTORY】

【67†Makefile】

【67†Makefile】

【68†README】

【68†README】

【69†README.git】

【69†README.git】

【70†README.md】

【70†README.md】

【71†aclocal.m4】

【71†aclocal.m4】

【72†configure】

【72†configure】

【73†configure.in】

【73†configure.in】

【74†q】

【74†q】

View all files   

## Repository files navigation 

  * README 
  * License 

The purpose of this document is to let users know how they can use zheap (a new storage format for PostgreSQL) and the work that is still pending. This new storage format provides a better control over bloat, reduces the tuple size and reduces the write amplification. The detail design of zheap is present in zheap design document (src/backend/access/zheap/README).

# How do I use zheap?

We have provided a storage engine option which you can set when creating a table. For example:

create table t_zheap(c1 int, c2 varchar) USING zheap;

Index creation for zheap tables doesn't need any special syntax.

You can also set the GUC parameter default_table_access_method. The default value is “heap", but you can set it to “zheap”. If you do, all subsequently-created tables will use zheap.

These interfaces will probably change once the storage format API work is integrated into PostgreSQL. We’ll adjust this code to use whatever interfaces are agreed by the PostgreSQL community.

Each zheap page has fixed set of transaction slots each of which contains the transaction information (transaction id and epoch) and the latest undo record pointer for that transaction. By default, we have four transaction slots per page, but this can be changed by setting --with-trans_slots_per_zheap_page=value while configuring zheap.

# What doesn’t work yet?

  * Logical decoding
  * Snapshot too old - We might want to implement this after first version is committed as this will work differently for zheap.
  * Alter Table <table_name> Set Tablesapce <tbs_name> - For this feature to work correctly in zheap, while copying pages, we need to ensure that pending aborts gets applied before copying the page.

Tools

  * pg_undo_dump similar to pg_wal_dump: We would like to develop this utility as it can be used to view undo record contents and can help us debug problems related to undo chains.
  * We also want to develop tools like pgstattuple, pgrowlocks that allow us to inspect the contents of database pages at a low level.
  * wal consistency checker: This will be used to check for bugs in the WAL redo routines. Currently, it is quite similar to what we have in current heap, but we want to extend it to check the consistency of undo pages similar to how it checks for data and index pages.

# Open Issues

  * Currently, the TPD pages are not added to FSM even if they can be completely reused.
  * Sing

### tool — 2024-10-06T15:03:03.874438+00:00

Accelerate apps with high-throughput, low-latency data caching

    * [Image 64] 【68† Azure Database Migration Service (classic) 】 

Accelerate your data migration to Azure

    * [Image 65] 【69† Azure Managed Instance for Apache Cassandra 】 

Modernize Cassandra data clusters with a managed instance in the cloud

    * [Image 66] 【70† Azure Database for MariaDB 】 

Deploy applications to the cloud with enterprise-ready, fully managed community MariaDB

Products  DevOps

## DevOps

Deliver innovation faster with simple, reliable tools for continuous delivery

    * [Image 67] 【71† Azure DevOps 】 

Services for teams to share code, track work, and ship software

    * [Image 68] 【72† Azure Pipelines 】 

Continuously build, test, and deploy to any platform and cloud

    * [Image 69] 【73† Azure Boards 】 

Plan, track, and discuss work across your teams

    * [Image 70] 【74† Azure Repos 】 

Get unlimited, cloud-hosted private Git repos for your project

    * [Image 71] 【75† Azure Artifacts 】 

Create, host, and share packages with your team

    * [Image 72] 【76† Azure Test Plans 】 

Test and ship confidently with an exploratory test toolkit

    * [Image 73] 【77† Azure DevTest Labs 】 

Quickly create environments using reusable templates and artifacts

    * [Image 74] 【78† DevOps tool integrations 】 

Use your favorite DevOps tools with Azure

    * [Image 75] 【79† Azure Monitor 】 

Full observability into your applications, infrastructure, and network

    * [Image 76] 【80† Azure Load Testing 】 

Optimize app performance with high-scale load testing

    * [Image 77] 【81† Azure Deployment Environments 】 

Quickly spin up app infrastructure environments with project-based templates

    * 【82† See all DevOps products 】 

Products  Developer tools

## Developer tools

Build, manage, and continuously deliver cloud applications—using any platform or language

    * [Image 78] 【83† Visual Studio 】 

Powerful and flexible environment to develop apps in the cloud

    * [Image 79] 【84† Visual Studio Code 】 

A powerful, lightweight code editor for cloud development

    * [Image 80] 【85† GitHub 】 

World’s leading developer platform, seamlessly integrated with Azure

    * [Image 81] 【86† Visual Studio Subscriptions 】 

Comprehensive set of resources to create, deploy, and manage apps

    * [Image 82] 【87† Power Apps 】 

A powerful, low-code platform for building apps quickly

    * [Image 83] 【88† SDKs 】 

Get the SDKs and command-line tools you need

    * [Image 84] 【89† App Center 】 

Build, test, release, and monitor your mobile and desktop apps

    * [Image 85] 【79† Azure Monitor 】 

Full observability into your applications, infrastructure, and network

    * [Image 86] 【80† Azure Load Testing 】 

Optimize app performance with high-scale load testing

    * [Image 87] 【81† Azure Deployment Environments 】 

Quickly spin up app infrastructure environments with project-based templates

    * [Image 88] 【55† Microsoft Dev Box 】 

Streamline development with secure, ready-to-code workstations in the cloud

Products  Hybrid + multicloud

## Hybrid + multicloud

Get Azure innovation everywhere—bring the agility and innovation of cloud computing to your on-premises workloads

    * [Image 89] 【25† Azure Arc 】 

Secure, develop, and operate infrastructure, apps, and Azure services anywhere

    * [Image 90] 【90† Microsoft Sentinel †www.microsoft.com】 

Cloud-native SIEM and intelligent security analytics

    * [Image 91] 【91† Azure Stack 】 

Build and run innovative hybrid apps across cloud boundaries

    * [Image 92] 【92† Azure ExpressRoute 】 

Experience a fast, reliable, and private connection to Azure

    * [Image 93] 【93† Microsoft Entra ID (formerly Azure AD) †www.microsoft.com】 

Synchronize on-premises directories and enable single sign-on

    * [Image 94] 【17† Azure SQL 】 

Migrate, modernize, and innovate on the modern SQL family of cloud databases

    * [Image 95] 【71† Azure DevOps 】 

Services for teams to share code, track work, and ship software

    * [Image 96] 【64† Azure Database for PostgreSQL 】 

Fully managed, intelligent, and scalable PostgreSQL

    * [Image 97] 【94† Azure IoT Edge 】 

Extend cloud intelligence and analytics to edge devices

    * [Image 98] 【79† Azure Monitor 】 

Full observability into your applications, infrastructure, and network

Products  Identity

## Identity

Manage user identities and access to protect against advanced threats across devices, data, apps, and infrastructure

    * [Image 99] 【95† Azure Active Directory B2C 】 

Consumer identity and access management in the cloud

    * [Image 100] 【96† Microsoft Entra Domain Services 】 

Manage your domain controllers in the cloud

    * [Image 101] 【97† Microsoft Entra External ID †www.microsoft.com】 

Personalize and help secure access to any application for customers and partners

Products  Integration

## Inte

### tool — 2024-10-06T15:03:03.874495+00:00

URL: https://learn.microsoft.com/en-us/azure/postgresql/
Skip to main content

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

【0†Download Microsoft Edge†go.microsoft.com】 【1†More info about Internet Explorer and Microsoft Edge】 

Table of contents Exit focus mode

  Read in English 【2† †github.com】  

Table of contents  Read in English 【2† Edit †github.com】

* * *

#### Share via

Facebook x.com LinkedIn Email

Table of contents

# Azure Database for PostgreSQL - Flexible Server documentation

Azure Database for PostgreSQL - Flexible Server is a relational database service based on the open-source Postgres database engine. It's a fully managed database-as-a-service that can handle mission-critical workloads with predictable performance, security, high availability, and dynamic scalability.

## Azure Database for PostgreSQL - Flexible Server

###  Overview 

  * 【3†What is Azure Database for PostgreSQL - Flexible Server?】 

###  What's new 

  * 【4†Check out our blog†techcommunity.microsoft.com】 

## Azure Database for PostgreSQL - Flexible Server

###  Get Started 

  * 【5†Try Azure Database for PostgreSQL - Flexible Server for free】 

###  Concept 

  * 【6†Server concepts】 
  * 【7†Understand compute and storage】 
  * 【8†Limitations】 

###  Quickstart 

  * 【9†Create an Azure Database for PostgreSQL - Flexible Server instance using Azure portal】 
  * 【10†Create an Azure Database for PostgreSQL - Flexible Server instance using ARM template】 
  * 【11†Create an Azure Database for PostgreSQL - Flexible Server instance using Azure CLI】 

###  Tutorial 

  * 【12†Create App and database server in virtual network】 

## Manage Azure Database for PostgreSQL - Flexible Server

###  Concept 

  * 【7†Compute and storage options】 
  * 【13†Networking】 
  * 【14†Firewall rules】 
  * 【15†PostgreSQL versions】 
  * 【16†Extensions】 
  * 【17†Security】 
  * 【18†Monitor】 
  * 【19†Logical replication】 
  * 【20†Intelligent tuning】 
  * 【21†Azure Advisor recommendations】 

###  How-To Guide 

  * 【22†Manage server】 
  * 【23†Stop/Start server】 
  * 【24†Scale up】 
  * 【25†Restart a server】 
  * 【26†Set up private networking】 
  * 【27†Connect securely using TLS】 
  * 【28†Configure and access logs】 
  * 【29†Schedule maintenance】 

## Business continuity

###  Concept 

  * 【30†Business continuity overview】 
  * 【31†High availability】 
  * 【32†Back up and restore】 

###  How-To Guide 

  * 【33†Manage high availability】 
  * 【34†Restore a server】 

## Connect and query

###  Concept 

  * 【14†Enable firewall rules to connect】 
  * 【35†Configure SSL for secure connections】 

###  Quickstart 

  * 【36†Connect using Python】 
  * 【37†Connect using Node.js】 
  * 【38†Connect using Java】 
  * 【39†Connect using Ruby】 
  * 【40†Connect using PHP】 
  * 【41†Connect using .NET】 
  * 【42†Connect using Go】 

###  Tutorial 

  * 【12†Connect Web App in virtual network】 

## Application development

###  Concept 

  * 【43†Connection resiliency】 

###  Tutorial 

  * 【44†Deploy Django app on AKS】 

## Migrate

###  How-To Guide 

  * 【45†Migrate a database using pg_dump and pg_restore】 
  * 【46†Migrate online】 

## Reference

###  Training 

  * 【47†Learning module: Create an Azure Database for PostgreSQL - Flexible Server instance】 

###  Deploy 

  * 【48†Azure CLI scripts for common tasks】 
  * 【49†Azure Resource Manager templates】 

###  Reference 

  * 【50†Azure CLI developer reference】 
  * 【51†REST API developer reference】 
  * 【49†Azure Resource Manager templates】 

###  Get Started 

  * 【52†Azure CLI scripts for common tasks】 

## Get training

###  Training 

  * 【53†Azure Database for PostgreSQL - Flexible Server】 

【54† California Consumer Privacy Act (CCPA) Opt-Out Icon Your Privacy Choices †aka.ms】 

Theme

  * Light
  * Dark
  * High contrast

  *   * 【55†Previous Versions】
  * 【56†Blog†techcommunity.microsoft.com】
  * 【57†Contribute】
  * 【58†Privacy†go.microsoft.com】
  * 【59†Terms of Use】
  * 【60†Trademarks†www.microsoft.com】
  * © Microsoft 2024

【54† California Consumer Privacy Act (CCPA) Opt-Out Icon Your Privacy Choices †aka.ms】 

Theme

  * Light
  * Dark
  * High contrast

  *   * 【55†Previous Versions】
  * 【56†Blog†techcommunity.microsoft.com】
  * 【57†Contribute】
  * 【58†Privacy†go.microsoft.com】
  * 【59†Terms of Use】
  * 【60†Trademarks†www.microsoft.com】
  * © Microsoft 2024
Visible: 0% - 100%

### tool — 2024-10-06T15:03:03.874563+00:00

URL: https://wiki.postgresql.org/wiki/Zheap
【0†Want to edit, but don't see an edit button when logged in? Click here.】

# Zheap

From PostgreSQL wiki 

Jump to navigationJump to search

## Contents

  * 【1†1 Overview】
  * 【2†2 Pending Items】
  * 【3†3 Open Issues】
  * 【4†4 Integration with Pluggable Storage API】
  * 【5†5 Code】

### Overview

The purpose of this page is to track the pending code items and open issues in zheap. We have also mentioned about some of the points that need to be considered for integrating with Pluggable storage API. 

## Pending Items

  * Delete marking in indexes: This will allow inplace updates even when index columns are updated and additionally with this we can avoid the need for a dedicated vacuum process to perform retail deletes.

  * Page wise undo: To save locking and repeated writing of same page, we want to collect all the undo records that belong to same page and then apply them together. Currently, we collect all consecutive records which apply to the same page and then apply them at one shot. This will be okay for cases where most of the changes to heap pages are performed together, but if the changes are randomly distributed across the undo of a transaction, it won’t work. So, we want some efficient mechanism to collect all the undo records that belong to a page.

  * We have to perform additional buffer locking to do the allocation for tuple before zheap_lock_tuple which can be fixed if we change that API. However, we want to be compatible with existing heap_lock_tuple. During integration with storage API, we need some work to make a standard API, so that we can avoid additional allocation and locking.

## Open Issues

  * More testing is needed for recovery and rollbacks. We will not be surprised if we some issues in that area.

## Integration with Pluggable Storage API

  * Currently, we don't have a nice way to handle different type of heaps in the backend. So, we have used storage engine option to define different code path for zheap. To integrate it with storage API, we need to check for all the places where RelationStorageIsZHeap is used.

  * HeapTuple is used widely in the backend, so instead of changing all such places, we have written converter functions zheap_to_heap, heap_to_zheap which will convert tuples from one format to another. To integrate it with storage API, we need to check for all the places where these API's are used.

  * Currently, we have stored ZHeapTuple in TupleTableSlot as a separate variable which doesn't appear to be the best way. We would like to integrate it with storage API. Andres has proposed an idea for the same. 
    * 【6†TupleTableSlot abstraction†www.postgresql.org】

  * Snapshot satisfies API's - The snapshot mechanism works differently in zheap as we need to traverse the undo chain to check if the prior tuple is visible to a snapshot.

## Code

  * The original implementation (developed by 【7†EDB†www.enterprisedb.com】):【8†[1]†github.com】
  * 【9†Cybertec†www.cybertec-postgresql.com】 fork, currently merged into PostgreSQL 14.1: 【10†[2]†github.com】

It includes the following changes: 

  *     * The new undo log infrastructure incorporated. The 【11†original version†github.com】 was designed by EDB. The 【12†current version†commitfest.postgresql.org】 includes the following changes: 
      * checkpoint does not include the undo request metadata. Instead, the undo log itself is used to find the data changes that need to be rolled back during server restart.
      * preprocessor constant (UNDO_DEBUG) added. If it's defined during the build, the undo record set chunks are much smaller so that various corner cases can be tested.
      * temporary undo is discarded (and the undo segments unlinked) by the backend that wrote the undo records.
      * test framework for the undo log reader (undoread.c) added
      * draft of the pg_undodump tool added, as well as views to read the undo contents from memory (pg_stat_undo_chunks, pg_stat_undo_records)
      * draft of the undo discard worker.
    * Implemented logical decoding for zheap tables.

Retrieved from "【13†https://wiki.postgresql.org/index.php?title=Zheap&oldid=36598】"

## Navigation menu

### Page actions

  * 【14†Page】
  * 【15†Discussion】
  * 【16†View source】
  * 【17†History】

### Page actions

  * 【14†Page】
  * 【15†Discussion】
  * More 
  * Tools 
  * In other languages

### Personal tools

  * 【18†Log in】

### Navigation

  * 【19†Main Page】
  * 【20†Random page】
  * 【21†Recent changes】
  * 【22†Help†www.mediawiki.org】

### Tools

  * 【23†What links here】
  * 【24†Related changes】
  * 【25†Special pages】
  * Printable version
  * 【13†Permanent link】
  * 【26†Page information】

### Search

[Image 0: Powered by MediaWiki]

  *  This page was last edited on 1 December 2021, at 09:18.
  * 【27†Privacy policy】
  * 【28†About PostgreSQL wiki】
  * 【29†Disclaimers】
Visible: 0% - 100%

### assistant — 2024-10-06T15:03:03.874621+00:00

Currently, **zheap** is not supported by default in **Azure Database for PostgreSQL**. Azure's managed PostgreSQL services, such as the Flexible Server, follow the standard PostgreSQL implementation, and while they allow a variety of extensions, zheap is still an experimental storage format and is not yet fully integrated into the core PostgreSQL releases that Azure offers【8†source】【9†source】.

If you wish to use zheap, you would typically need to manage your own PostgreSQL deployment (on VMs, for example) where you can apply custom builds or extensions like zheap. However, such custom setups aren't available in the fully managed Azure PostgreSQL services【10†source】【12†source】.

For now, it's best to keep track of the progress of zheap's development, as it could become available in future PostgreSQL releases or be offered by cloud providers like Azure once it's fully integrated and stable.

### user — 2024-10-06T15:04:06.167406+00:00

Pg compressionは

### assistant — 2024-10-06T15:04:19.015705+00:00

In PostgreSQL, **pg_compression** refers to mechanisms used for compressing data to reduce storage space and potentially improve performance. The most common form of compression in PostgreSQL involves the **TOAST** mechanism (The Oversized-Attribute Storage Technique), which automatically compresses large values (like large text fields) that exceed a certain size threshold. This is typically applied to data types like `TEXT`, `BYTEA`, and `JSONB`.

Additionally, PostgreSQL supports **WAL (Write-Ahead Logging) compression** and **archive compression** to reduce the size of the transaction log files, improving storage efficiency for write-heavy workloads. These compression methods can be configured using settings like `wal_compression` and `archive_mode`.

There are also **extensions** such as `pg_partman` or `pg_compression`, which allow for more customized data compression strategies. For example, in newer versions of PostgreSQL (PostgreSQL 14 and onwards), **columnar storage** with compression (available through extensions like `cstore_fdw` or `zstd_fdw`) allows further compression optimization for certain use cases, particularly in analytic workloads【9†source】【11†source】.

In Azure Database for PostgreSQL, these native PostgreSQL compression mechanisms are available, but there is no direct built-in page or row-level compression similar to what might be seen in proprietary database systems like SQL Server or Oracle. However, extensions or external tools can be explored to introduce additional compression techniques.
