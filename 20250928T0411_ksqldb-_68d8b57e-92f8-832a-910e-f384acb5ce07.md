---
conversation_id: "68d8b57e-92f8-832a-910e-f384acb5ce07"
title: "ksqldb ログ出力方法"
create_time: 1759032710.75917
update_time: 1759032722.146104
language_guess: "en"
num_messages: 8
part_index: 1
part_count: 1
---

### assistant — 2025-09-28T04:11:50.608333+00:00

_(empty)_

### assistant — 2025-09-28T04:11:50.628466+00:00

ksqldb のログ出力方法はいくつか段階があります。運用の目的（開発デバッグか、本番監視か）に応じて使い分けできます。整理すると以下のようになります。

---

## 1. サーバーログの出力
ksqldb サーバーは Java アプリケーションなので、標準的な **Log4j** 設定でログが出力されます。

- Docker や Confluent Platform で動かしている場合は **コンテナの stdout/stderr** に出ます。
  ```bash
  docker logs ksqldb-server
  ```
- ログレベルは環境変数で制御可能です：
  ```bash
  KSQL_LOG4J_OPTS="-Dlog4j.configuration=file:/etc/ksqldb/log4j.properties"
  ```
- `log4j.properties` 内で個別のクラスごとにログレベルを指定できます：
  ```properties
  log4j.rootLogger=INFO, stdout
  log4j.logger.io.confluent.ksql=DEBUG
  log4j.logger.org.apache.kafka=ERROR
  ```

---

## 2. ksqlDB CLI / REST API からの診断出力
- `SHOW QUERIES;`  
  実行中のクエリとステータスを表示。
- `DESCRIBE EXTENDED <stream/table>;`  
  内部トポロジや統計情報、メトリクスが出力される。
- `EXPLAIN <queryId>;`  
  クエリプランと実行情報を確認可能。

---

## 3. 実行クエリの結果ログ
クエリ実行時に `PRINT <topic>;` を使うと、Kafka トピックの内容をそのまま CLI にストリーム表示できます。  
開発時に「クエリの出力が正しく Kafka に流れているか」を直接確認できます。

---

## 4. メトリクス連携
本番での監視用には、JMX 経由で Prometheus / Datadog などにメトリクスを吐き出すのが一般的です。

```bash
KSQL_JMX_OPTS="-Dcom.sun.management.jmxremote \
 -Dcom.sun.management.jmxremote.port=1099 \
 -Dcom.sun.management.jmxremote.authenticate=false \
 -Dcom.sun.management.jmxremote.ssl=false"
```

---

✅ まとめると：
- **開発中の確認** → `PRINT` / `SHOW QUERIES` / `DESCRIBE EXTENDED`
- **サーバー側デバッグ** → `docker logs` + `log4j.properties` で制御
- **本番監視** → JMX / Prometheus など外部監視システムと連携

---

司令は **物理テストでの診断ログ** を重視しているようですが（前回やりとりで `SHOW QUERIES` や `DESCRIBE` を追加してましたね）、今回の質問は「ksqldb のサーバーレベルログの話」と「クエリ実行結果の確認ログ」のどちらを求めてますか？  

🕒送信日時: [[REDACTED_PHONE]]:34:52（日本時間）

### system — 2025-09-28T04:11:50.759170+00:00

_(empty)_

### system — 2025-09-28T04:11:50.759170+00:00

_(empty)_

### system — 2025-09-28T04:11:50.890790+00:00

_(empty)_

### user — 2025-09-28T04:11:51.660000+00:00

ksqldbのログ出力方法

### user — 2025-09-28T04:12:02.118493+00:00

_(empty)_
