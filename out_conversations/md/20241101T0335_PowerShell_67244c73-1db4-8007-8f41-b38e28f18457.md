---
conversation_id: "67244c73-1db4-8007-8f41-b38e28f18457"
title: "PowerShellスクリプトの実行"
create_time: 1730432115.341988
update_time: 1730432376.711872
language_guess: "en"
num_messages: 11
part_index: 1
part_count: 1
---

### system — 2024-11-01T03:35:15.341988+00:00

_(empty)_

### user — 2024-11-01T03:35:15.352711+00:00

PowerShellで１分前くらいに起動し、５５秒でコマンドを実行するスクリプト

### assistant — 2024-11-01T03:35:19.380841+00:00

_(empty)_

### assistant — 2024-11-01T03:35:19.380991+00:00

以下のPowerShellスクリプトは、1分前にスクリプトを開始し、55秒後に指定したコマンドを実行する仕組みになっています。

```powershell
# スクリプトを1分前に起動したように見せる（特定の時間まで待つ）
Start-Sleep -Seconds 60

# 55秒後に実行したいコマンド（例：Get-Process）
Start-Sleep -Seconds 55
Get-Process # 実行したいコマンドをここに記述
```

上記のスクリプトでは、まず `Start-Sleep -Seconds 60` で1分待機した後、さらに55秒待機してから指定のコマンド（例：`Get-Process`）が実行されます。

実行したいコマンドを `Get-Process` の部分に置き換えてください。

### user — 2024-11-01T03:35:48.032087+00:00

５５秒はシステム時刻とする

### assistant — 2024-11-01T03:35:54.236350+00:00

システム時刻に基づいて指定の分秒にコマンドを実行する場合、以下のようなPowerShellスクリプトを使用します。ここでは「現在の時刻から最も近い55秒のタイミング」に達した時にコマンドを実行します。

```powershell
# 55秒のタイミングまで待機
while ((Get-Date).Second -ne 55) {
    Start-Sleep -Milliseconds 100  # 100ミリ秒ごとに時刻をチェック
}

# 55秒に到達した時点でコマンドを実行
Get-Process  # 実行したいコマンドをここに記述
```

このスクリプトでは、システム時刻の「秒」が「55秒」になるまでループで待機し、55秒に達した時点で `Get-Process` コマンドが実行されます。`Get-Process` の部分を実行したいコマンドに置き換えてください。

**補足**: この方法では、スクリプトの実行タイミングが「55秒」になるまでの待機時間は動的に変わりますが、常に「55秒」に実行されることが保証されます。

### user — 2024-11-01T03:36:36.913080+00:00

この５５を時分秒で指定可能とする

### assistant — 2024-11-01T03:36:42.694094+00:00

以下のPowerShellスクリプトでは、指定した時分秒（例えば「XX分55秒」）に到達するまで待機し、指定した時間にコマンドを実行します。

```powershell
# 実行する時刻を指定（例：XX分55秒）
$targetMinute = 12  # 指定の分
$targetSecond = 55  # 指定の秒

# 現在時刻を取得
$current = Get-Date

# 次に指定された分と秒が来るまでの待機時間を計算
$waitTime = (($targetMinute - $current.Minute) * 60 + ($targetSecond - $current.Second))
if ($waitTime -lt 0) {
    $waitTime += 3600  # 次の1時間後の指定時刻を目指す
}

# 指定された時間まで待機
Start-Sleep -Seconds $waitTime

# 指定された時刻にコマンドを実行
Get-Process  # 実行したいコマンドをここに記述
```

### 使用方法
- `$targetMinute` に目的の「分」を指定し、`$targetSecond` に「秒」を指定します（例：`$targetMinute = 12; $targetSecond = 55` で「XX分55秒」に実行されます）。
- 実行したいコマンドを `Get-Process` の部分に置き換えてください。

このスクリプトは、現在時刻から指定された「分」「秒」までの待機時間を計算し、その時間が到達したらコマンドを実行します。

### user — 2024-11-01T03:39:28.446532+00:00

POWERSHELL　DE　FAILOVER　CLUSTER MANAGERNO　YAKUWARIWO TEIASISURU　KOMANDOWO JIKKOUSURU

### assistant — 2024-11-01T03:39:35.886304+00:00

PowerShellでFailover Cluster Managerの役割（リソースやサービス）を管理するには、`FailoverClusters`モジュールに含まれているコマンドレットを使用します。以下の例は、Failover Clusterの役割（リソース）の状態を取得し、特定の役割を操作する方法です。

### Failover Clusterの役割を一覧表示する

まず、Failover Clusterに構成されているすべての役割を一覧表示するには、以下のコマンドを使用します。

```powershell
Get-ClusterGroup
```

これにより、現在のクラスタに構成されている役割が表示されます。

### 役割の詳細情報を表示する

特定の役割（例えば、`MyClusterRole`）の詳細情報を表示する場合は、以下のようにします。

```powershell
Get-ClusterGroup -Name "MyClusterRole"
```

### 役割をオンラインまたはオフラインにする

役割をオンラインにするには、次のコマンドを使用します。

```powershell
Start-ClusterGroup -Name "MyClusterRole"
```

逆に、役割をオフラインにするには、次のコマンドです。

```powershell
Stop-ClusterGroup -Name "MyClusterRole"
```

### 役割を別のノードにフェイルオーバーさせる

役割を別のノードに移動させたい場合（フェイルオーバーさせる場合）は、次のコマンドを使用します。

```powershell
Move-ClusterGroup -Name "MyClusterRole" -Node "TargetNodeName"
```

### 使用例

Failover Clusterで`MyClusterRole`という役割をターゲットノード`Node2`にフェイルオーバーさせる場合の例です。

```powershell
Move-ClusterGroup -Name "MyClusterRole" -Node "Node2"
```

### Failover Clusterモジュールのインポート

クラスタコマンドを実行する前に、`FailoverClusters`モジュールがインポートされていない場合は、次のようにインポートします。

```powershell
Import-Module FailoverClusters
```

このコマンドを実行すると、Failover Cluster Managerの役割をPowerShellから管理できるようになります。
