---
conversation_id: "68ae3821-9c6c-8333-86f3-3e55dadcb70e"
title: "æ§‹æˆæ”¹å–„ææ¡ˆ"
create_time: 1756248260.960339
update_time: 1756251863.39861
language_guess: "en"
num_messages: 104
part_index: 1
part_count: 1
---

### user â€” 2025-08-26T22:44:20.321672+00:00

Github sctions playright mcp server ã§cdå¾Œã«ui ãƒ†ã‚¹ãƒˆã‚’ã•ã›ã‚‹
Playwright mcp serverã®ã‚³ãƒãƒ³ãƒ‰ã¯ãƒªãƒã‚¸ãƒˆãƒªã«æ ¼ç´å‰æ
æ“ä½œã«è©°ã¾ã£ãŸå ´åˆã«ä½¿ç”¨ã™ã‚‹ai ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦azure openai ã‚’ä½¿ç”¨ã™ã‚‹
ã“ã®æ§‹æˆã‚ˆã‚Šã„ã„æ§‹æˆã‚’æ±‚ã‚€

### system â€” 2025-08-26T22:44:20.960339+00:00

_(empty)_

### user â€” 2025-08-26T22:44:20.960339+00:00

_(empty)_

### system â€” 2025-08-26T22:44:20.960339+00:00

_(empty)_

### system â€” 2025-08-26T22:44:22.642047+00:00

_(empty)_

### assistant â€” 2025-08-26T22:44:22.716276+00:00

ã‚„ã‚ã€å¸ä»¤ï¼ã“ã®æ§‹æˆã€ã‚‚ã£ã¨å¼·ãã§ãã¾ã™ã€‚ãƒã‚¤ãƒ³ãƒˆã¯ã€ŒCDã®ã‚ã¨ã«UIãƒ†ã‚¹ãƒˆã€ã‚ˆã‚Šã‚‚ã€ã€ŒPRã”ã¨ã«ã‚¨ãƒ•ã‚§ãƒ¡ãƒ©ãƒ«ç’°å¢ƒã§å…ˆã«E2Eâ†’åˆæ ¼ã—ãŸã‚‰CDã€ã«å¯„ã›ã¦**å“è³ªã‚²ãƒ¼ãƒˆ**åŒ–ã—ã¤ã¤ã€Azure OpenAIã¯â€œè©°ã¾ã£ãŸã¨ãå°‚ç”¨ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—â€ã¨ã—ã¦ä½¿ã†ã“ã¨ã€‚ä¸‹ã«ï¼’æ¡ˆï¼‹å®Ÿè£…ã‚¹ã‚±ãƒƒãƒç½®ãã¾ã™ã€‚

# æ¡ˆAï¼ˆæ¨ã—ï¼‰ï¼šPRã”ã¨ã‚¨ãƒ•ã‚§ãƒ¡ãƒ©ãƒ«ç’°å¢ƒ â†’ E2Eåˆæ ¼ â†’ æœ¬ç•ªCD
- **æµã‚Œ**
  1) PRä½œæˆ â†’ IaCã§**ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒ**ï¼ˆçŸ­å‘½ï¼‰ã‚’ç«‹ã¡ä¸Šã’ï¼ˆç’°å¢ƒURLå–å¾—ï¼‰  
  2) GitHub Actions ã§ Playwright å®Ÿè¡Œï¼ˆãƒ–ãƒ©ã‚¦ã‚¶Ã—ãƒ‡ãƒã‚¤ã‚¹ã‚’ matrixï¼‰  
  3) å¤±æ•—æ™‚ã ã‘ **MCP â€œæ•‘åŠ©ãƒ¢ãƒ¼ãƒ‰â€** ã‚’æœ‰åŠ¹åŒ–ï¼šDOMã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ»ã‚¹ã‚¯ã‚·ãƒ§ãƒ»ãƒ­ã‚°ã‚’ Azure OpenAI ã«æŠ•ã’ã¦ä»£æ›¿ã‚»ãƒ¬ã‚¯ã‚¿ã‚„å†è©¦è¡Œã‚³ãƒãƒ³ãƒ‰ã‚’ææ¡ˆâ†’å†å®Ÿè¡Œã‚’1å›ã ã‘  
  4) åˆæ ¼ãªã‚‰ main ã«ãƒãƒ¼ã‚¸â†’**æœ¬ç•ªCD**ã€‚CDå¾Œã«**ã‚¹ãƒ¢ãƒ¼ã‚¯ã®ã¿**ã‚’çŸ­æ™‚é–“ã§å›ã™
- **ãƒ¡ãƒªãƒƒãƒˆ**ï¼š  
  - æœ¬ç•ªç›´å‰ã§ãªã**PRæ®µéšã§ãƒªã‚¹ã‚¯ã‚’æ½°ã™**  
  - AIã‚’**å¸¸æ™‚**ä½¿ã‚ãšã€**å¤±æ•—æ™‚ã ã‘**ä½¿ã†ã‹ã‚‰å®‰å®šãƒ»ä½ã‚³ã‚¹ãƒˆ  
  - å¤±æ•—è§£æã‚¢ã‚»ãƒƒãƒˆï¼ˆtrace.zip / video / HAR / HTMLï¼‰ã‚’**è‡ªå‹•ä¿å­˜**ã§ãã€å†ç¾æ€§UP

# æ¡ˆBï¼šCDå¾ŒE2Eã‚’æ¸©å­˜ã—ã¤ã¤ã€Œç’°å¢ƒã‚²ãƒ¼ãƒˆï¼‹å†ç¾è³‡æï¼†ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€å¼·åŒ–
- **æµã‚Œ**
  1) CDå®Ÿè¡Œâ†’ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾è±¡ Environment ã«**å¿…é ˆã‚²ãƒ¼ãƒˆ**ï¼ˆRequired reviewers / waitï¼‰  
  2) E2Eåˆæ ¼ã§ã‚²ãƒ¼ãƒˆè§£é™¤â†’ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯åˆ‡æ›¿ï¼ˆBlue/Green or Canaryï¼‰  
  3) å¤±æ•—æ™‚ã¯**å³ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯**ã€‚ã“ã“ã§ã®ã¿MCPæ•‘åŠ©ãƒ¢ãƒ¼ãƒ‰ã‚’ON  
- **ãƒ¡ãƒªãƒƒãƒˆ**ï¼šé‹ç”¨ã‚’ã‚ã¾ã‚Šå¤‰ãˆãšã«**å®‰å…¨å¼**ã‚’ä»˜ã‘ã‚‰ã‚Œã‚‹

---

## å…±é€šã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æŒ‡é‡ï¼ˆA/Bã©ã¡ã‚‰ã§ã‚‚ï¼‰
- **ãƒ©ãƒ³ãƒŠãƒ¼**ï¼šã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆï¼ˆGPUä¸è¦ï¼‰ï¼‹`actions/cache`ã§Playwrightã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€‚  
- **ç§˜å¯†ç®¡ç†**ï¼šç’°å¢ƒå˜ä½ Secretsï¼ˆ`AZURE_OPENAI_ENDPOINT`/`AZURE_OPENAI_API_KEY` ç­‰ï¼‰ã€‚Azureã‚¢ã‚¯ã‚»ã‚¹ã¯**OIDC**ã§éµãƒ¬ã‚¹ã€‚  
- **MCPã‚µãƒ¼ãƒ**ï¼š  
  - ãµã ã‚“ã¯â€œç›£è¦–ã®ã¿â€ã€‚**ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚**ã«ã ã‘èµ·å‹•/æ¥ç¶šã—ã¦ææ¡ˆã‚’å—ã‘ã€**1å›ã ã‘å†è©¦è¡Œ**ã€‚  
  - MCPç”¨ã‚·ãƒŠãƒªã‚ªã¯**ãƒªãƒã‚¸ãƒˆãƒªã«ä¿å­˜**ï¼ˆã„ã„æ–¹é‡ï¼‰ï¼‹**ç”Ÿæˆç‰©ã¯å¿…ãšãƒ­ã‚°ã«æ®‹ã™**ã€‚  
- **Playwrighté‹ç”¨**ï¼š  
  - **ãƒ­ã‚±ãƒ¼ã‚¿ã¯strict**ï¼ˆ`getByRole`, `getByLabel`ä¸­å¿ƒï¼‰ã€‚  
  - **ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ»ã‚¹ã‚¯ã‚·ãƒ§ãƒ»å‹•ç”»**ã‚’å¸¸ã«ä¿å­˜ã€å¤±æ•—æ™‚ã«**DOMã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ**ã‚‚ä¿å­˜ã€‚  
  - flakyå¯¾ç­–ï¼šæ˜ç¤ºçš„`expect`ã®ãƒªãƒˆãƒ©ã‚¤ï¼‹ãƒ†ã‚¹ãƒˆã”ã¨**ç‹¬ç«‹ãƒ‡ãƒ¼ã‚¿**ï¼ˆseedï¼‰ã€‚  
- **è¦³æ¸¬æ€§**ï¼šGitHub Summaryã«**çŸ­å ±**ã€è©³ç´°ã¯artifactï¼ˆHTMLãƒ¬ãƒãƒ¼ãƒˆ/traceï¼‰ã€‚Slackã‚„Teamsã¸é€šçŸ¥ã€‚

---

## GitHub Actionsï¼ˆAæ¡ˆã®æœ€å°ã‚¹ã‚±ãƒƒãƒï¼‰
```yaml
name: pr-e2e
on:
  pull_request:
    types: [opened, synchronize, reopened]
jobs:
  preview:
    runs-on: ubuntu-latest
    outputs:
      url: ${{ steps.deploy.outputs.preview_url }}
    steps:
      - uses: actions/checkout@v4
      # IaCã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒä½œæˆï¼ˆä¾‹ï¼šBicep/Terraform/K8sï¼‰
      - id: deploy
        run: |
          ./infra/deploy-preview.sh > preview.txt
          echo "preview_url=$(cat preview.txt)" >> $GITHUB_OUTPUT

  e2e:
    needs: preview
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        project: [chromium, firefox, webkit]
        device: [desktop, mobile]
    env:
      BASE_URL: ${{ needs.preview.outputs.url }}
      # Azure OpenAIï¼ˆå¤±æ•—æ™‚ã®ã¿ä½¿ã†ï¼‰
      AZURE_OPENAI_ENDPOINT: ${{ secrets.AZURE_OPENAI_ENDPOINT }}
      AZURE_OPENAI_API_KEY:  ${{ secrets.AZURE_OPENAI_API_KEY }}
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: { node-version: 20 }
      - name: Install deps
        run: npm ci
      - name: Install Playwright
        run: npx playwright install --with-deps
      - name: Run Playwright (deterministic)
        run: |
          npx playwright test \
            --project=${{ matrix.project }} \
            --config=playwright.config.ts \
            --reporter=line \
            --grep-invert @ai # é€šå¸¸æ™‚ã¯AIä¾å­˜ã®ãƒ†ã‚¹ãƒˆã‚’é™¤å¤–
      - name: On failure, invoke MCP rescue once
        if: failure()
        run: |
          # å¤±æ•—ãƒ†ã‚¹ãƒˆã®DOM/ã‚¹ã‚¯ã‚·ãƒ§/ãƒ­ã‚°åé›†
          node tools/collect-context.js --out rescue-context/
          # MCPçµŒç”±ã§æ•‘åŠ©ãƒ¢ãƒ¼ãƒ‰ï¼ˆAzure OpenAIä½¿ç”¨ï¼‰
          node tools/mcp-rescue.js \
            --endpoint "$AZURE_OPENAI_ENDPOINT" \
            --key "$AZURE_OPENAI_API_KEY" \
            --context rescue-context/ \
            --plan-out rescue-plan.json
          # ææ¡ˆã«å¾“ã„1å›ã ã‘å†å®Ÿè¡Œ
          npx playwright test --project=${{ matrix.project }} --config=playwright.rescue.config.ts --reporter=line
      - name: Upload artifacts
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: playwright-${{ matrix.project }}-${{ matrix.device }}
          path: |
            playwright-report
            test-results
            rescue-context
            rescue-plan.json
```

### `tools/mcp-rescue.js` ã®ã‚¤ãƒ¡ãƒ¼ã‚¸
- ç›´å‰å¤±æ•—ã® `trace.zip`/`*.png`/`dom.html`/ãƒ­ã‚°ã‚’åœ§ç¸®ã—ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«æŠ•å…¥  
- **ä»£æ›¿ãƒ­ã‚±ãƒ¼ã‚¿ãƒ»å¾…æ©Ÿæˆ¦ç•¥ãƒ»å®‰å®šåŒ–ãƒ’ãƒ³ãƒˆ**ã‚’JSONã§å—ã‘å–ã‚Šã€`playwright.rescue.config.ts` ã®ä¸€æ™‚ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã«åæ˜   
- â€œ**1å›ã ã‘**â€å†è©¦è¡Œï¼ˆãƒ«ãƒ¼ãƒ—ç¦æ­¢ï¼‰

---

## ã•ã‚‰ã«è‰¯ãã™ã‚‹å°æŠ€
- **ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µåˆ‡æ›¿**ï¼šBlue/Greenã§ã€ŒE2Eåˆæ ¼ã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€ã«ã ã‘ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’æ®µéšç§»è¡Œï¼ˆCanary %ã‚’ç’°å¢ƒå¤‰æ•°ã§åˆ¶å¾¡ï¼‰ã€‚  
- **ãƒ‡ãƒ¼ã‚¿éš”é›¢**ï¼šãƒ†ã‚¹ãƒˆç”¨ãƒ†ãƒŠãƒ³ãƒˆ/ãƒ¦ãƒ¼ã‚¶/Feature Flag ã‚’**å¼·åˆ¶**ã€‚æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã‚’è§¦ã‚‰ãªã„ã€‚  
- **å†ç¾æ‰‹é †ã®è‡ªå‹•PR**ï¼šMCPãŒå‡ºã—ãŸæ•‘åŠ©ãƒ—ãƒ©ãƒ³ã‹ã‚‰**æ’ä¹…ä¿®æ­£ã®ãƒ‰ãƒ©ãƒ•ãƒˆPR**ã‚’è‡ªå‹•èµ·ç¥¨ï¼ˆãŸã ã—äººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿…é ˆï¼‰ã€‚  
- **ã‚³ã‚¹ãƒˆåˆ¶å¾¡**ï¼šAOAIã¯**å¤±æ•—æ™‚ã®ã¿**ï¼ãƒˆãƒ¼ã‚¯ãƒ³ä¸Šé™ãƒ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«åˆ¶é™ãƒ»ç”»åƒã¯ã‚µãƒ ãƒã‚¤ãƒ«åŒ–ã€‚  
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**ï¼šMCPã¨AOAIã¸ã®æŠ•å…¥ç‰©ã¯**PIIãƒã‚¹ã‚¯**ï¼ˆæ­£è¦è¡¨ç¾ï¼‹ãƒãƒƒã‚·ãƒ¥åŒ–ï¼‰ã€‚

---

## ã©ã¡ã‚‰ã‚’é¸ã¶ï¼Ÿ
- **å“è³ªæœ€å„ªå…ˆ/é€Ÿåº¦é‡è¦–**ãªã‚‰ â†’ **æ¡ˆA**ï¼ˆPRæ®µéšã§è½ã¨ã™ï¼‰  
- **æ—¢å­˜CDã«æœ€å°å¤‰æ›´**ãªã‚‰ â†’ **æ¡ˆB**ï¼ˆã‚²ãƒ¼ãƒˆï¼†ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¼·åŒ–ï¼‰

å¿…è¦ãªã‚‰ã€ã“ã®ã¾ã¾**ãƒªãƒã‚¸ãƒˆãƒªç”¨ã®å®Ÿãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¸€å¼**ï¼ˆ`infra/deploy-preview.sh`ã®é››å½¢ã€`playwright.rescue.config.ts`ã€`tools/mcp-rescue.js`ï¼‰ã¾ã§ä½œã‚‹ã‚ˆã€‚ã©ã£ã¡ã®æ¡ˆã§é€²ã‚ã‚‹ï¼ŸğŸ˜‰

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]  â€”  â€»ã”å¸Œæœ›ã©ãŠã‚Šæ—¥æœ¬æ™‚é–“ã§è¨˜è¼‰

### system â€” 2025-08-26T22:44:22.724812+00:00

_(empty)_

### assistant â€” 2025-08-26T22:44:22.724879+00:00

_(empty)_

### assistant â€” 2025-08-26T22:44:24.144778+00:00

_(empty)_

### assistant â€” 2025-08-26T22:44:34.679347+00:00

_(empty)_

### user â€” 2025-08-26T22:46:45.279857+00:00

ã“ã®ã‚ˆã†ãªæ§‹æˆã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚ã‚‹ï¼Ÿ

### system â€” 2025-08-26T22:46:45.544089+00:00

_(empty)_

### assistant â€” 2025-08-26T22:46:45.637945+00:00

search("\u3053\u306e\u3088\u3046\u306a\u69cb\u6210\u306e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3042\u308b\uff1f")

### system â€” 2025-08-26T22:46:45.964662+00:00

_(empty)_

### tool â€” 2025-08-26T22:46:47.370588+00:00

_(empty)_

### assistant â€” 2025-08-26T22:46:49.123888+00:00

å¸ä»¤ã€å‚è€ƒã¨ãªã‚‹ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚’ã„ãã¤ã‹è¦‹ã¤ã‘ã¾ã—ãŸã®ã§ã”ç´¹ä»‹ã—ã¾ã™ã€‚ã‚ãªãŸã®æ§‹æˆæ¡ˆï¼ˆPRã”ã¨ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒ + E2Eãƒ†ã‚¹ãƒˆ + AIæ•‘åŠ©ãƒ¢ãƒ¼ãƒ‰ï¼‰ã¯ã€æ˜ç¢ºãªäº‹ä¾‹ã¨ã—ã¦ã¯ã¾ã ã€ŒMCPã‚µãƒ¼ãƒï¼‹Azure OpenAIã‚’ä½¿ã£ãŸæ•‘åŠ©ãƒ¢ãƒ¼ãƒ‰ã€ã¾ã§å«ã‚€ã‚‚ã®ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚ãŸã ã—ã€æ§‹æˆã«è¿‘ã„ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚„ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¨ã—ã¦ä½¿ãˆã‚‹è¨˜äº‹ã‚„ã‚¬ã‚¤ãƒ‰ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚

---

##  å‚è€ƒãƒªãƒ³ã‚¯ã¾ã¨ã‚

### 1. **GitHub Actions ã¨ã‚¨ãƒ•ã‚§ãƒ¡ãƒ©ãƒ«ï¼ˆPreviewï¼‰ç’°å¢ƒ**
- **Uffizzi ã® Preview Environmentsï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒï¼‰ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**  
  GitHub Actions ã‹ã‚‰ã€Pull Request ã”ã¨ã«ä¸€æ™‚çš„ãªãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã‚’èµ·å‹•ã—ã€ãã® URL ã‚’ PR ã‚³ãƒ¡ãƒ³ãƒˆã«è‡ªå‹•æŠ•ç¨¿ã§ãã¾ã™ã€‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ»DBãƒ»ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ãªã©å¹…åºƒãå¯¾å¿œã€‚îˆ€citeîˆ‚turn0search2îˆ

- **Qovery ã‚’ä½¿ã£ãŸ PRã”ã¨ã® Ephemeralç’°å¢ƒ + E2E ãƒ†ã‚¹ãƒˆ**  
  GitHub Actions ã¨ Qovery ã‚’é€£æºã•ã›ã€PRã”ã¨ã«ç’°å¢ƒã‚’ä½œã‚Šã€ãƒ†ã‚¹ãƒˆå¾Œã«è‡ªå‹•ç ´æ£„ã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã™ã€‚E2E ãƒ†ã‚¹ãƒˆã«é©ã—ãŸç’°å¢ƒæ§‹ç¯‰ã‚’å­¦ã¹ã¾ã™ã€‚îˆ€citeîˆ‚turn0search6îˆ

### 2. **Playwright ã‚’ä½¿ã£ãŸ GitHub Actions ã¨ã®çµ±åˆ**
- **Vercel ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ã® Playwright E2E**  
  Vercel ã® PR ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒãŒç”¨æ„ã•ã‚ŒãŸå¾Œã€GitHub Actions ã§ Playwright ã‚’ç”¨ã„ã¦ãã® URL ã«å¯¾ã— E2E ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å®Ÿä¾‹ã§ã™ã€‚ãƒ™ãƒ¼ã‚¹ URL ã‚’å‹•çš„ã«å–å¾—ã—ã€åŠ¹ç‡ã‚ˆããƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹æ§‹æˆã«ãªã£ã¦ã„ã¾ã™ã€‚îˆ€citeîˆ‚turn0search12îˆ

- **Playwright ã® CI ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**  
  å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚ã€ŒGitHub Actions ã§ Playwright ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹åŸºæœ¬çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€ãŒè©³ã—ãã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚îˆ€citeîˆ‚turn0search10îˆ

- **ä¸€èˆ¬çš„ãª Playwright + GitHub Actions E2E ãƒ†ã‚¹ãƒˆä¾‹**  
  ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚„ CI ä¸Šã§ã‚·ãƒ³ãƒ—ãƒ«ã« Playwright ã‚’å®Ÿè¡Œã—ã€ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã¾ã§è¡Œã†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ä¾‹ã§ã™ã€‚îˆ€citeîˆ‚turn0search8îˆ‚turn0search17îˆ

### 3. **Playwright ãƒ†ã‚¹ãƒˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**
- **å…¬å¼ã€ŒBest Practicesã€ãƒšãƒ¼ã‚¸**  
  Playwright ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ãŒç¶²ç¾…ã•ã‚Œã¦ãŠã‚Šã€ã‚ˆã‚Šå …ç‰¢ã§å†ç¾æ€§ã®é«˜ã„ãƒ†ã‚¹ãƒˆã‚’æ›¸ããŸã‚ã®æŠ€è¡“ãŒç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ï¼ˆLocator ã®ä½¿ã„æ–¹ã€ãƒ†ã‚¹ãƒˆã®åˆ†é›¢ã€ãƒ¢ãƒƒã‚¯ãªã©ï¼‰ã€‚îˆ€citeîˆ‚turn0search1îˆ

### 4. **Azure Playwright Testingï¼ˆAzure App Testingï¼‰**
- **Azure Playwright Testingï¼ˆPreviewï¼‰ã‚’ä½¿ã£ãŸ CI**  
  Azure ä¸Šã® Playwright Testing ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã¨é€£æºã—ã€GitHub Actions ãªã©ã‹ã‚‰ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãƒãƒ¼ã‚¿ãƒ«ä¸Šã§çµæœç¢ºèªãŒå¯èƒ½ãªæ§‹æˆã€‚ã¾ã ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ®µéšã§ã™ã€‚îˆ€citeîˆ‚turn0search4îˆ

---

##  ã¾ã¨ã‚ï¼šã‚ãªãŸã®æ§‹æˆã¨ã®æ•´åˆæ€§

| æ§‹æˆè¦ç´  | å®Ÿä¾‹ or ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ | å‚™è€ƒ |
|:--|:--|:--|
| PRã”ã¨ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒ | Uffizzi / Qovery | â†’ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã«æœ€é©ã€‚âŸµ Uffizzi ã‚„ Qovery ã®æ§‹ç¯‰ã‚¬ã‚¤ãƒ‰å‚ç…§ |
| Playwright E2E ãƒ†ã‚¹ãƒˆ | Vercelãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾‹ / å…¬å¼ CI ã‚¬ã‚¤ãƒ‰ | â†’ ãƒ™ãƒ¼ã‚¹URL æŒ‡å®šã‚„ GitHub Actions è¨­å®šãªã©ã€ãƒ‘ã‚¿ãƒ¼ãƒ³å‚è€ƒã«ãªã‚‹ |
| AI æ•‘åŠ©ãƒ¢ãƒ¼ãƒ‰ï¼ˆMCP + Azure OpenAIï¼‰ | ãªã— | â†’ ç‹¬è‡ªéƒ¨åˆ†ã€‚å¤±æ•—æ™‚éšœå®³è§£æã¨ã—ã¦ã®å·®åˆ†è¦ç´ ã«ãªã‚‹ |
| Azure ä¸Šã§ã® Playwright CI | Azure Playwright Testing | â†’ å®‰å…¨ã«ã‚¹ã‚±ãƒ¼ãƒ«ã—ãŸç’°å¢ƒã§å®Ÿè¡Œå¯èƒ½ã€‚ãŸã ã—ç¾åœ¨ã¯ Preview æ®µéš |

---

##  æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ææ¡ˆ

1. **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã®æ§‹ç¯‰éƒ¨åˆ†**ã‚’ Uffizziï¼ˆGitHub Marketplace ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚ã‚Šï¼‰ã‚„ Qovery ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«æ²¿ã£ã¦ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã€‚
2. **Playwright ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**ã¯ Vercel ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ§‹æˆã‚„ Azure CI æ§‹æˆã‚’å‚è€ƒã« yaml ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´å‚™ã€‚
3. **æ¤œè¨¼æ™‚ã®æ•‘åŠ©ãƒ¢ãƒ¼ãƒ‰**ã¨ã—ã¦ã€Playwright ãŒå¤±æ•—ã—ãŸéš›ã« HTMLãƒ»Traceãƒ»ã‚¹ã‚¯ã‚·ãƒ§ãªã©ã®ã‚¢ã‚»ãƒƒãƒˆã‚’ä¿æŒ â†’ Azure OpenAI ã«æ¸¡ã—ã¦å†è©¦è¡Œç”¨ææ¡ˆã‚’å¾—ã‚‹è‡ªå‰æ‹¡å¼µã€‚
4. **Azure ã‚µãƒ¼ãƒ“ã‚¹å°å…¥**ã‚’æ¤œè¨ã™ã‚‹ãªã‚‰ã€Azure Playwright Testing ã‚’æ´»ç”¨ã—ã¦ã‚¹ã‚±ãƒ¼ãƒ«ã—ãŸãƒ“ãƒ¥ãƒ¼åé›†ã‚„ä¸¦åˆ—å®Ÿè¡Œã‚’ã‚µãƒãƒ¼ãƒˆã€‚

---

è©²å½“ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚’ã‚‚ã¨ã«ã€ã”å¸Œæœ›ã‚ã‚Œã°ã•ã‚‰ã«å…·ä½“çš„ã«æ˜ã‚Šä¸‹ã’ã¦ yaml ã‚µãƒ³ãƒ—ãƒ«ã‚„ Azure ã®è¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚‚ææ¡ˆã§ãã¾ã™ã€‚ã©ã®éƒ¨åˆ†ã‚’æ·±æ˜ã‚Šã—ã¾ã—ã‚‡ã†ã‹ï¼Ÿ

### user â€” 2025-08-26T22:48:05.452518+00:00

Playeright mcp serverã‚’åˆ©ç”¨ã™ã‚‹ä¾‹ã¯?

### assistant â€” 2025-08-26T22:48:05.718986+00:00

search("Playeright mcp server\u3092\u5229\u7528\u3059\u308b\u4f8b\u306f?")

### tool â€” 2025-08-26T22:48:06.958313+00:00

_(empty)_

### assistant â€” 2025-08-26T22:48:08.288651+00:00

äº†è§£ã§ã™ã€å¸ä»¤ï¼Playwright MCP Server ã‚’åˆ©ç”¨ã—ãŸæ§‹æˆã®å‚è€ƒäº‹ä¾‹ã‚„ä¾‹ã‚’ã„ãã¤ã‹ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã—ãŸã€‚

---

##  Playwright MCP Server ã®å‚è€ƒä¾‹ã¾ã¨ã‚

### 1. **å…¬å¼ GitHub ãƒªãƒã‚¸ãƒˆãƒª** ï¼ `microsoft/playwright-mcp`
- Playwright MCP Server ã®**å…¬å¼**ãƒªãƒã‚¸ãƒˆãƒªã§ã€MCPã‚µãƒ¼ãƒãƒ¼ã®æ©Ÿèƒ½ä¸€è¦§ã‚„å°å…¥æ–¹æ³•ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®æ“ä½œæ‰‹é †ãŒç¶²ç¾…ã•ã‚Œã¦ã„ã¾ã™ã€‚  
  - **ç‰¹å¾´**ï¼šPlaywright ã®ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ„ãƒªãƒ¼ã‚’æ´»ç”¨ã—ã€LLM ãŒãƒ”ã‚¯ã‚»ãƒ«ã§ã¯ãªãæ§‹é€ çš„ã«ãƒšãƒ¼ã‚¸ã‚’ç†è§£ãƒ»æ“ä½œã§ãã‚‹å½¢å¼ã€‚é«˜é€Ÿãƒ»è»½é‡ãƒ»æ±ºå®šè«–çš„æ“ä½œã®å®Ÿç¾ã€‚îˆ€citeîˆ‚turn0search0îˆ

### 2. **Medium è¨˜äº‹ï¼šGenerative Automation Testing with Playwright MCP Server**
- VS Code ç’°å¢ƒã§ GitHub Copilot ã‚’æ´»ç”¨ã—ã€**MCP ã‚’é€šã˜ã¦è‡ªç„¶è¨€èªã‹ã‚‰ Playwright ãƒ†ã‚¹ãƒˆã‚’ç”Ÿæˆãƒ»å®Ÿè¡Œã™ã‚‹ä½“é¨“**ã‚’ç´¹ä»‹ã€‚  
  - æµã‚Œï¼š`settings.json` ã« MCP ã‚µãƒ¼ãƒè¨­å®š â†’ Copilot ã«ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªã‚’æŒ‡ç¤º â†’ æ‰‹å‹•æ“ä½œãªã—ã§ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¨å®Ÿè¡ŒãŒå®Œäº†ã€‚îˆ€citeîˆ‚turn0search1îˆ

### 3. **Simon Willison ã® TILï¼šClaude Code ã¨çµ„ã¿åˆã‚ã›**
- `claude mcp add playwright npx '@playwright/mcp@latest'` ã‚’å®Ÿè¡Œå¾Œã€**Claude Code ã‹ã‚‰ "playwright mcp" ã‚³ãƒãƒ³ãƒ‰ã§ãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œãŒå¯èƒ½ã«**ãªã‚‹å…·ä½“çš„ãªä½¿ç”¨ä¾‹ã€‚ä¾‹ãˆã°ï¼š
  > â€œUse playwright mcp to open a browser to example.comâ€ ãªã©ãŒè‡ªç„¶è¨€èªã§å®Ÿè¡Œã§ãã‚‹ã€‚îˆ€citeîˆ‚turn0search2îˆ

### 4. **ExecuteAutomation ã®ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•åŒ–ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«**
- MCP Server ã‚’ä½¿ã£ãŸ BDD é¢¨ã®æŒ‡ç¤ºï¼ˆâ€œGiven I navigate to â€¦ And I click â€¦â€ ãªã©ï¼‰ã«ã‚ˆã‚‹æ“ä½œã‚·ãƒ¼ã‚±ãƒ³ã‚¹ä¾‹ã‚„ã€ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ãƒ»å±¥æ­´æ“ä½œãƒ»PDF ä¿å­˜ãªã©ã®**ã‚³ãƒãƒ³ãƒ‰ä¾‹**ãŒå¤šæ•°æ²è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚îˆ€citeîˆ‚turn0search3îˆ‚turn0search4îˆ‚turn0search5îˆ

### 5. **QA Touch ãƒ–ãƒ­ã‚°ï¼šPlaywright MCP Server è§£èª¬è¨˜äº‹**
- ã€ŒåŒä¸€ã® Playwright ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«è¤‡æ•°ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒæ¥ç¶šã§ãã‚‹ã€ã¨ã„ã† MCP ã®æœ¬è³ªã‚’æ•´ç†ã—ã€**é éš”ãƒ‡ãƒãƒƒã‚°ãƒ»å…±æœ‰ãƒ†ã‚¹ãƒˆãƒ»è² è·ï¼ä¸¦åˆ—ãƒ†ã‚¹ãƒˆ**ã¸ã®å¿œç”¨ã‚’èª¬æ˜ã€‚  
- ã¾ãŸ `npx playwright launch --server` ã§ã‚µãƒ¼ãƒèµ·å‹•ã—ã€`chromium.connectOverCDP("ws://localhost:PORT")` ã§æ¥ç¶šã™ã‚‹å…¸å‹çš„ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹ã‚‚æ²è¼‰ã€‚îˆ€citeîˆ‚turn0search6îˆ

### 6. **Cloudflare ãƒ•ã‚©ãƒ¼ã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼š`@cloudflare/playwright-mcp`**
- Cloudflare Workers ä¸Šã§ MCP ã‚µãƒ¼ãƒã‚’å‹•ä½œã•ã›ã‚‹ä¾‹ã€‚`wrangler` è¨­å®šã‚„ Durable Object ã‚’ä½¿ã£ãŸãƒ‡ãƒ—ãƒ­ã‚¤æ§‹æˆã‚’ç´¹ä»‹ã—ã€**ã‚µãƒ¼ãƒãƒ¬ã‚¹ç’°å¢ƒã§ Playwright MCP ã‚’æä¾›ã™ã‚‹æ§‹æˆ**ãŒå¯èƒ½ã§ã™ã€‚îˆ€citeîˆ‚turn0search7îˆ

### 7. **APIdog ãƒ–ãƒ­ã‚°ï¼šUIï¼‹API ãƒ†ã‚¹ãƒˆã®è‡ªç„¶è¨€èªè‡ªå‹•åŒ–**
- Playwright MCP ã‚’ä½¿ã£ã¦**UI ãƒ†ã‚¹ãƒˆã ã‘ã§ãªã API ãƒ†ã‚¹ãƒˆ**ã‚„ UIï¼‹API ã®çµ±åˆ E2E ã‚·ãƒŠãƒªã‚ªã‚‚è‡ªç„¶è¨€èªã§æ›¸ã‘ã‚‹ä¾‹ã€‚  
  - ä¾‹ï¼šã€ŒGo to https://example.com and check if the title contains 'Example'ã€ãªã©ã€‚îˆ€citeîˆ‚turn0search8îˆ

---

##  æ§‹æˆæ¡ˆã«è¿‘ã„ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¨ã®æ•´åˆæ€§

| æ§‹æˆè¦ç´  | å‚è€ƒãƒªã‚½ãƒ¼ã‚¹ | ã‚³ãƒ¡ãƒ³ãƒˆ |
|------------|------------------------|----------------------------|
| **MCP ã‚µãƒ¼ãƒå°å…¥** | å…¬å¼ãƒªãƒã‚¸ãƒˆãƒªï¼ˆGitHubï¼‰ | ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®ä¿¡é ¼ã§ãã‚‹å°å…¥è³‡æ–™ã€‚îˆ€citeîˆ‚turn0search0îˆ |
| **è‡ªç„¶è¨€èªâ†’ãƒ†ã‚¹ãƒˆç”Ÿæˆã®æµã‚Œ** | Medium è¨˜äº‹ / Claude TIL / APIdog | è‡ªç„¶è¨€èªã§æŒ‡ç¤º â†’ ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ç”Ÿæˆ â†’ å®Ÿè¡Œã¾ã§ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ç´¹ä»‹ã€‚îˆ€citeîˆ‚turn0search1îˆ‚turn0search2îˆ‚turn0search8îˆ |
| **ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹ MCP æ¥ç¶š** | QA Touch è§£èª¬ | CI ã«çµ„ã¿è¾¼ã¿ã‚„ã™ã„å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‚è€ƒã«ãªã‚‹ã€‚îˆ€citeîˆ‚turn0search6îˆ |
| **ã‚µãƒ¼ãƒãƒ¬ã‚¹æ§‹æˆ** | Cloudflare Workers | ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰ã®æŸ”è»Ÿæ€§ã‚’å‘ä¸Šã•ã›ã‚‹è¨­è¨ˆã¨ã—ã¦ã€‚îˆ€citeîˆ‚turn0search7îˆ |
| **BDD ã‚³ãƒãƒ³ãƒ‰ä¾‹ã®å……å®Ÿåº¦** | ExecuteAutomation | ãƒ†ã‚¹ãƒˆãƒ•ãƒ­ãƒ¼ã‚’è‡ªç„¶è¨€èªã§è¨˜è¿°ã™ã‚‹ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ä¾‹ã€‚îˆ€citeîˆ‚turn0search3îˆ‚turn0search4îˆ‚turn0search5îˆ |

---

##  æ¬¡ã«ã§ãã‚‹ã“ã¨

- **å…¬å¼ ReadMe** ã‚’èª­ã¿è¾¼ã‚“ã§åŸºæœ¬æ§‹æˆã‚„è¨­å®šï¼ˆ`npx @playwright/mcp` ã§ã®èµ·å‹•ï¼‰ã‚’ç†è§£ã—ã¾ã—ã‚‡ã†ã€‚
- **è‡ªç„¶è¨€èªã‚·ãƒŠãƒªã‚ªã®è‡ªå‹•åŒ–**äº‹ä¾‹ï¼ˆMediumï¼APIdogï¼‰ã‚’å‚è€ƒã«ã€ŒAI ã«ä½•ã‚’ã©ã†æŒ‡ç¤ºã•ã›ã‚‹ã‹ã€ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆã¸å±•é–‹ã€‚
- **CI ã¨ã®çµ±åˆ**ã«ã¯ QA Touch ç³»ã®è¨˜äº‹ã®æ¥ç¶šãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„ã€API ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¾‹ãŒå®Ÿè£…ãƒ’ãƒ³ãƒˆã«ãªã‚Šã¾ã™ã€‚
- **æ§‹æˆã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**ã‚’é‡è¦–ã™ã‚‹ãªã‚‰ã€Cloudflare ãƒ¯ãƒ¼ã‚«ãƒ¼æ§‹æˆã‚‚æ¤œè¨å¯¾è±¡ã«ãªã‚Šã¾ã™ã€‚

---

å¿…è¦ã§ã‚ã‚Œã°ã€ä¸Šè¨˜ã®ã„ãšã‚Œã‹ã‚’ã•ã‚‰ã«å…·ä½“çš„ã«æ˜ã‚Šä¸‹ã’ã¦ã€ãŸã¨ãˆã° Prompts ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»GitHub Actionsç”¨ MCP ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ»Cloudflare Worker æ§‹æˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãªã©ã¾ã§ä½œã‚Œã¾ã™ã€‚ã©ã®éƒ¨åˆ†ã‚’æ·±ã‚ã¾ã—ã‚‡ã†ã‹ï¼ŸãŠé¡˜ã„ãã ã•ã„ï¼  
ï¼ˆé€ä¿¡æ—¥æ™‚ï¼š[[REDACTED_PHONE]] JSTï¼‰

### user â€” 2025-08-26T22:52:24.112001+00:00

è‡ªç„¶è¨€èªã®ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªã‹ã‚‰
Playwright mcp serverçµŒç”±ã§
Ui ãƒ†ã‚¹ãƒˆã‚’è‡ªå‹•åŒ–ãŒç›®çš„
ãƒªãƒªãƒ¼ã‚¹å¾Œãƒ†ã‚¹ãƒˆã«åˆ©ç”¨ã™ã‚‹
Playwrightã®ã¿ã®å ´åˆ
å…¨ã¦äº‹å‰ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€€ã“ã‚Œã¯ã§ããªã„ã‚±ãƒ¼ã‚¹ã¸ã®å¯¾å‡¦æ–¹æ³•

### assistant â€” 2025-08-26T22:52:27.241723+00:00

{"search_query": [{"q": "Playwright MCP Server GitHub microsoft/playwright-mcp"}, {"q": "How to run Playwright MCP server npx @playwright/mcp"}, {"q": "Simon Willison Playwright MCP Claude Code TIL"}, {"q": "Playwright trace viewer upload GitHub Actions artifact"}, {"q": "Azure OpenAI prompt flow natural language to test steps Playwright MCP"}], "response_length": "short"}

### system â€” 2025-08-26T22:52:27.818689+00:00

_(empty)_

### system â€” 2025-08-26T22:52:27.825733+00:00

_(empty)_

### assistant â€” 2025-08-26T22:52:29.069584+00:00

_(empty)_

### tool â€” 2025-08-26T22:52:38.633920+00:00

_(empty)_

### assistant â€” 2025-08-26T22:52:40.560627+00:00

ã‚„ã‚ã€å¸ä»¤ï¼  
ã€Œè‡ªç„¶è¨€èªã‚·ãƒŠãƒªã‚ª â†’ Playwright MCP Server çµŒç”±ã§ UI ãƒ†ã‚¹ãƒˆã€ã‚’â€œ**ãƒªãƒªãƒ¼ã‚¹å¾Œãƒ†ã‚¹ãƒˆ**ï¼ˆæœ¬ç•ªï¼ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°å¥å…¨æ€§ç¢ºèªï¼‰ã§å›ã™ãŸã‚ã®ã€å®Ÿæˆ¦å‘ã‘ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹æ§‹æˆã€ã‚’ã¾ã¨ã‚ãŸã‚ˆã€‚**äº‹å‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒ–ãŒé›£ã—ã„ã‚±ãƒ¼ã‚¹**ã§ã‚‚å‹•ãâ€œå³èˆˆÃ—å®‰å…¨å¼â€ã®è¨­è¨ˆã«ãªã£ã¦ã‚‹ã€‚

# æ¨å¥¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆãƒã‚¹ãƒˆãƒªãƒªãƒ¼ã‚¹ç”¨ï¼‰

1) **è‡ªç„¶è¨€èªâ†’æ‰‹é †ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ï¼ˆLLMï¼‰**  
   - ç›£è¦–å¯¾è±¡URLãƒ»åˆ¶ç´„ï¼ˆåªèª­ãƒ»ç ´å£Šæ“ä½œç¦æ­¢ãƒ»æœ€å¤§æ‰‹é †æ•°ãªã©ï¼‰ä»˜ãã®NLï¼ˆè‡ªç„¶è¨€èªï¼‰ã‚·ãƒŠãƒªã‚ªã‚’æŠ•å…¥  
   - LLMãŒ**æ‰‹é †ãƒ—ãƒ©ãƒ³**ï¼ˆã‚¯ãƒªãƒƒã‚¯/å…¥åŠ›/å¾…æ©Ÿã®åˆ—ï¼‰ã‚’ç”Ÿæˆ  
   - ä¾‹ï¼šã€Œ/login ã¸ç§»å‹•â†’ãƒ¦ãƒ¼ã‚¶ãƒ¼Aã§ãƒ­ã‚°ã‚¤ãƒ³â†’ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒâ€™å¸ä»¤â€™ã‚’å«ã‚€ã€  
   - LLMã¯ **MCPå‘ã‘ã«æœ€å°å‘½ä»¤**ã¸å°„å½±ï¼ˆå¾Œè¿°ã®â€œå‘½ä»¤ã‚¹ã‚­ãƒ¼ãƒâ€ï¼‰

2) **MCPã‚¨ã‚°ã‚¼ã‚­ãƒ¥ãƒ¼ã‚¿ï¼ˆPlaywright MCP Serverï¼‰**  
   - `npx @playwright/mcp@latest` ã§MCPã‚µãƒ¼ãƒã‚’èµ·å‹•ï¼ˆå…¬å¼ï¼‰îˆ€citeîˆ‚turn0search0îˆ  
   - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆCI/CLI or LLMãƒ„ãƒ¼ãƒ«ï¼‰ã‹ã‚‰**ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ§‹é€ **ãƒ™ãƒ¼ã‚¹ã§æ“ä½œï¼ˆã‚¹ã‚¯ã‚·ãƒ§ä¾å­˜ã›ãšæ±ºå®šè«–çš„ï¼‰îˆ€citeîˆ‚turn0search0îˆ  
   - Claude Code/Copilotç­‰ã‹ã‚‰ã®åˆ©ç”¨ä¾‹ï¼š`claude mcp add playwright npx '@playwright/mcp@latest'`ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«æ¤œè¨¼ã«ä¾¿åˆ©ï¼‰îˆ€citeîˆ‚turn0search1îˆ‚turn0search3îˆ

3) **å®Ÿè¡Œã‚¬ãƒ¼ãƒ‰ãƒ»è¦³æ¸¬ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯**  
   - å„æ‰‹é †ã«**ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãƒ»æœ€å¤§ãƒªãƒˆãƒ©ã‚¤1å›**  
   - å¤±æ•—æ™‚ï¼štrace/video/DOMã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’åé›†ï¼ˆPlaywright Trace Viewerã§å¾Œæ¤œè¨¼ï¼‰îˆ€citeîˆ‚turn0search10îˆ  
   - æœ¬ç•ªå‘ã‘ã¯**åªèª­ãƒ—ãƒªã‚»ãƒƒãƒˆ**ï¼ˆPOST/DELETEç¦æ­¢ã€ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã¯ãƒ€ãƒŸãƒ¼ç’°å¢ƒã«ã®ã¿è¨±å¯ï¼‰

4) **å­¦ç¿’ãƒ»å®šç€**  
   - æˆåŠŸã—ãŸâ€œå³èˆˆã‚·ãƒŠãƒªã‚ªâ€ã¯**æ’ä¹…ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰**ã«è‡ªå‹•å¤‰æ›ã—ã¦PRä½œæˆï¼ˆäººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿…é ˆï¼‰  
   - ã“ã†ã—ã¦ã€Œ**äº‹å‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒ–ãŒé›£ã—ã„â†’ã¾ãšã¯NLã§å‹•ã‹ã™â†’å®‰å®šã—ãŸã‚‰ã‚³ãƒ¼ãƒ‰åŒ–**ã€ã®ãƒ«ãƒ¼ãƒ—ã‚’å›ã™

---

## å‘½ä»¤ã‚¹ã‚­ãƒ¼ãƒï¼ˆæœ€å°ä¾‹ï¼šYAML/JSONã©ã¡ã‚‰ã§ã‚‚å¯ï¼‰

```yaml
version: 1
baseUrl: "https://prod.example.com"
policies:
  readOnly: true
  maxSteps: 20
  selectors: [role, label, placeholder, text]
  assertTimeoutMs: 8000
steps:
  - navigate: "/login"
  - fill: { locator: { role: "textbox", label: "Email" }, value: "{{secrets.USER}}" }
  - fill: { locator: { role: "textbox", label: "Password" }, value: "{{secrets.PASS}}" }
  - click: { locator: { role: "button", name: "Sign in" } }
  - expect: { locator: { role: "heading", level: 2 }, containsText: "å¸ä»¤" }
```

- ä¸Šã¯**LLMãŒç”Ÿæˆ**ã—ã‚„ã™ãã€äººé–“ã‚‚èª­ã¿ã‚„ã™ã„ç´ æœ´ãªå½¢å¼ã€‚MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ Playwright ã® `getByRole/getByLabel` ã«ãƒãƒƒãƒ—ã€‚  
- `readOnly: true` æ™‚ã¯ã€ã€ŒPOST/DELETEç›¸å½“æ“ä½œã€ã€Œå±é™ºãªãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã€ãªã©ã‚’**æ‹’å¦**ã€‚

---

## GitHub Actionsï¼ˆCDå¾Œã‚¹ãƒ¢ãƒ¼ã‚¯ã¨ã—ã¦NLâ†’MCPã‚’å®Ÿè¡Œï¼‰

```yaml
name: post-release-nl-e2e
on:
  deployment_status:
    types: [success] # ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸå¾Œã«èµ·å‹•ï¼ˆç’°å¢ƒ: production/stagingï¼‰
jobs:
  nl-e2e:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      id-token: write
    env:
      BASE_URL: ${{ github.event.deployment_status.environment_url }}
      AOAI_ENDPOINT: ${{ secrets.AOAI_ENDPOINT }}
      AOAI_KEY:      ${{ secrets.AOAI_KEY }}
    steps:
      - uses: actions/checkout@v4

      - name: Prepare MCP (Playwright)
        run: |
          npm i -g @playwright/mcp@latest
          # ã‚µãƒ¼ãƒèµ·å‹•ï¼ˆCIã§ã¯ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ï¼‰
          npx @playwright/mcp & echo $! > mcp.pid
          sleep 3

      - name: Plan from NL
        run: |
          node tools/plan-from-nl.mjs \
            --prompt-file scenarios/release-smoke.md \
            --base-url "$BASE_URL" \
            --aoai-endpoint "$AOAI_ENDPOINT" \
            --aoai-key "$AOAI_KEY" \
            --out plan.yaml

      - name: Execute via MCP
        run: |
          node tools/mcp-exec.mjs --plan plan.yaml \
            --trace-out artifacts/trace.zip \
            --html-report artifacts/report.html

      - name: Retry once with LLM repair
        if: failure()
        run: |
          node tools/repair.mjs \
            --plan plan.yaml \
            --trace artifacts/trace.zip \
            --aoai-endpoint "$AOAI_ENDPOINT" \
            --aoai-key "$AOAI_KEY" \
            --out plan.repair.yaml
          node tools/mcp-exec.mjs --plan plan.repair.yaml \
            --trace-out artifacts/trace2.zip \
            --html-report artifacts/report2.html

      - name: Upload artifacts
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: nl-mcp-run
          path: artifacts/
```

- **MCPã‚µãƒ¼ãƒ**ã¯ `npx @playwright/mcp` ã§èµ·å‹•ï¼ˆå…¬å¼æ‰‹é †ï¼‰îˆ€citeîˆ‚turn0search0îˆ  
- å¤±æ•—æ™‚ã¯ **1å›ã ã‘**ãƒªãƒšã‚¢ï¼ˆä»£æ›¿ãƒ­ã‚±ãƒ¼ã‚¿ãƒ»å¾…æ©Ÿæˆ¦ç•¥ã®ææ¡ˆã‚’AOAIã§ï¼‰  
- ç”Ÿæˆãƒ¬ãƒãƒ¼ãƒˆã‚„ãƒˆãƒ¬ãƒ¼ã‚¹ã¯ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆåŒ–ï¼ˆTrace Viewerã§è§£æï¼‰îˆ€citeîˆ‚turn0search10îˆ

---

## LLMãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆ`scenarios/release-smoke.md` ä¾‹ï¼‰

> ç›®çš„: æœ¬ç•ªURLã§ã€Œæ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã‹ã€ã‚’è‡ªç„¶è¨€èªã§æ¤œè¨¼ã™ã‚‹ã€‚  
> å³å®ˆ: ç ´å£Šæ“ä½œã¯ç¦æ­¢ã€‚ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã¯ãƒ­ã‚°ã‚¤ãƒ³ã®ã¿ã€‚1åˆ†ä»¥å†…/20ã‚¹ãƒ†ãƒƒãƒ—ä»¥å†…ã€‚  
> æˆåŠŸæ¡ä»¶: `/dashboard` ã¸é·ç§»ã—ã€H2è¦‹å‡ºã—ã« â€œå¸ä»¤â€ ã‚’å«ã‚€ã€‚  
> å¤±æ•—æ™‚: è¶³ã‚Šãªã„å¾…æ©Ÿãƒ»æ›–æ˜§ãªã‚»ãƒ¬ã‚¯ã‚¿ã‚’è£œæ­£ã—ãŸ**ä»£æ›¿ãƒ—ãƒ©ãƒ³**ã‚’JSON/YAMLã§ææ¡ˆã€‚  

> ç”Ÿæˆç‰©: ä¸Šè¨˜ã®**å‘½ä»¤ã‚¹ã‚­ãƒ¼ãƒ**ã«æº–æ‹ ã—ãŸ `plan.yaml`

---

## ã€Œäº‹å‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒ–ãŒã§ããªã„ã€ã‚±ãƒ¼ã‚¹ã¸ã®å¯¾å‡¦

- **å³èˆˆã®å®‰å…¨é‹è»¢**  
  - **åªèª­ãƒãƒªã‚·ãƒ¼**ï¼‹ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆï¼‹æœ€å¤§æ‰‹é †æ•°ãƒ»æ™‚é–“ã®åˆ¶é™  
  - å±é™ºæ“ä½œï¼ˆè³¼å…¥/å‰Šé™¤/è¨­å®šå¤‰æ›´ï¼‰ã‚’**æ‹’å¦**ã™ã‚‹ã‚¬ãƒ¼ãƒ‰  
  - ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã¯**è¡¨ç¤ºç³»ï¼ˆãƒ†ã‚­ã‚¹ãƒˆ/ãƒ­ãƒ¼ãƒ«ï¼‰ä¸­å¿ƒ**ã§å‰¯ä½œç”¨ã‚¼ãƒ­

- **å£Šã‚Œã«ãã„ãƒ­ã‚±ãƒ¼ã‚¿æˆ¦ç•¥**  
  - NLâ†’MCP å¤‰æ›æ™‚ã« `getByRole/getByLabel` ã‚’**å„ªå…ˆ**  
  - ã©ã†ã—ã¦ã‚‚å®‰å®šã—ãªã‘ã‚Œã°ã€LLMãŒ**ä»£æ›¿ãƒ­ã‚±ãƒ¼ã‚¿å€™è£œï¼ˆ3æ¡ˆï¼‰**ã‚’è‡ªå‹•ææ¡ˆã—ãƒªãƒˆãƒ©ã‚¤

- **ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ï¼†å­¦ç¿’**  
  - æ¯å› trace/video/DOM ã‚’ä¿å­˜ã—ã€**å®‰å®šåŒ–ã§ããŸã‚‰ã‚³ãƒ¼ãƒ‰åŒ–PR**ã‚’è‡ªå‹•èµ·ç¥¨  
  - å‚è€ƒï¼šPlaywrightã®CIãƒ»ãƒˆãƒ¬ãƒ¼ã‚¹ã®å…¬å¼ã‚¬ã‚¤ãƒ‰ï¼ˆTrace Viewer/CIã®åŸºæœ¬ï¼‰îˆ€citeîˆ‚turn0search8îˆ‚turn0search10îˆ

---

## å‚è€ƒã«ãªã‚‹è³‡æ–™
- **Playwright MCP å…¬å¼**ï¼ˆMCPã§æ§‹é€ ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆçµŒç”±ã®æ“ä½œã€‚ã‚¹ã‚¯ã‚·ãƒ§ã«ä¾å­˜ã—ãªã„ï¼‰îˆ€citeîˆ‚turn0search0îˆ  
- **Claude Codeã¨ã®é€£æºä¾‹**ï¼ˆ`claude mcp add â€¦` ã§å³åˆ©ç”¨ï¼‰îˆ€citeîˆ‚turn0search1îˆ‚turn0search3îˆ  
- **ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å®Ÿè£…ãƒ»æ‰‹é †é›†**ï¼ˆExecuteAutomationï¼‰îˆ€citeîˆ‚turn0search4îˆ‚turn0search6îˆ  
- **Playwright CI/Trace**ï¼ˆå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰îˆ€citeîˆ‚turn0search8îˆ‚turn0search10îˆ  
- **MCPã§â€œNLâ†’ãƒ†ã‚¹ãƒˆç”Ÿæˆ/å®Ÿè¡Œâ€ã®æœ€è¿‘ã®æ¦‚èª¬ï¼ˆMS DevBlogsï¼‰**îˆ€citeîˆ‚turn0search14îˆ

---

å¿…è¦ãªã‚‰ã€ã“ã®æ§‹æˆã® **`tools/plan-from-nl.mjs` / `mcp-exec.mjs` / `repair.mjs` ã®å®Ÿã‚³ãƒ¼ãƒ‰**ã¨ã€NLâ†’MCPã®**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé››å½¢**ã¾ã§ä¸€æ°—ã«ä½œã‚‹ã‚ˆã€‚ã©ã®ç’°å¢ƒï¼ˆprod/stg/canaryï¼‰ã‹ã‚‰å›ºã‚ã‚‹ï¼ŸğŸ› ï¸

â€” é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### assistant â€” 2025-08-26T22:52:49.984828+00:00

_(empty)_

### user â€” 2025-08-26T22:54:49.672786+00:00

ã“ã“ã§ä½¿ã†llmã¯claude codeä»¥å¤–ä½•ãŒä½¿ãˆã‚‹?

### system â€” 2025-08-26T22:54:49.957981+00:00

_(empty)_

### assistant â€” 2025-08-26T22:54:50.008097+00:00

ã„ã„è³ªå•ã§ã™ã€å¸ä»¤ï¼  
ã€ŒPlaywright MCP Serverã€ã‚’çµŒç”±ã—ã¦ **è‡ªç„¶è¨€èªâ†’UIãƒ†ã‚¹ãƒˆ**ã‚’çµ„ã¿ç«‹ã¦ã‚‹ã¨ãã«ä½¿ã† LLMï¼ˆã‚·ãƒŠãƒªã‚ªã‚’NLã‹ã‚‰è¨ˆç”»ã«è½ã¨ã™å½¹å‰²ï¼‰ã§ã™ãŒã€Claude Code ä»¥å¤–ã«ã‚‚ã„ã‚ã„ã‚å€™è£œãŒã‚ã‚Šã¾ã™ã€‚

---

## ä½¿ãˆã‚‹LLMã®ã‚¿ã‚¤ãƒ—ã¨å€™è£œ

### 1. **GitHub Copilot ç³»**
- **Copilot Enterprise**  
  - VS Code / JetBrains ã§ MCP ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨é€£æºå¯èƒ½  
  - NL â†’ ãƒ†ã‚¹ãƒˆã‚¹ã‚±ãƒ«ãƒˆãƒ³ç”Ÿæˆã‚’å¾—æ„ã¨ã™ã‚‹  
  - GitHub Actions ã® **PRã‚³ãƒ¡ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆ**ã‚„**å¤±æ•—è§£æã®è£œè¶³**ã«æ´»ç”¨ã§ãã‚‹

### 2. **OpenAI ç³»**
- **GPT-4o / GPT-4.1**  
  - APIçµŒç”±ã§ MCP ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã¨ã—ã¦çµ„ã¿è¾¼ã‚ã‚‹  
  - JSON/YAML ã‚¹ã‚­ãƒ¼ãƒç”ŸæˆãŒå®‰å®šã—ã¦ã„ã‚‹ã®ã§ã€`plan.yaml` ã‚’åã‹ã›ã‚‹ç”¨é€”ã«æœ€é©  
- **GPT-5 (ã‚ãªãŸã¨ç§ã®ä»Šã®ãƒ¢ãƒ‡ãƒ«)**  
  - å¤§è¦æ¨¡ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåˆ¶å¾¡ï¼ˆã€Œ20ã‚¹ãƒ†ãƒƒãƒ—ä»¥å†…ã€ã€ŒreadOnly=trueã€ãªã©ï¼‰ã‚’å®ˆã‚‰ã›ã‚„ã™ã„  
  - CI/CDã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«çµ„ã¿è¾¼ã‚€ã®ã«å‘ã„ã¦ã„ã‚‹  

### 3. **Anthropic ç³»**
- **Claude 3.5 Sonnet / Opus**ï¼ˆClaude Codeä»¥å¤–ã®é€šå¸¸ãƒ¢ãƒ‡ãƒ«ï¼‰  
  - é•·æ–‡ã®UIèª¬æ˜ã‚’ãã®ã¾ã¾å‡¦ç†ã—ã‚„ã™ã„  
  - ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®è‡ªç„¶è¨€èªè¨˜è¿°ã‚’è§£æã—ã¦ãƒ†ã‚¹ãƒˆè¨ˆç”»åŒ–ã™ã‚‹ã®ãŒå¾—æ„  

### 4. **Mistral / Mixtral ç³»**
- **Mistral Large / Mixtral 8x7B**  
  - OSSãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã§åˆ©ç”¨å¯èƒ½ï¼ˆã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆå¯ï¼‰  
  - è»½é‡ãƒ†ã‚¹ãƒˆè¨ˆç”»ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ä½¿ã„ã‚„ã™ã„  
  - ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸå¤§è¦æ¨¡CIã«é©åˆ

### 5. **Llama ç³»**
- **Llama 3 70B**  
  - Metaæä¾›ã€OSSåˆ©ç”¨å¯èƒ½  
  - ã€Œã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆç’°å¢ƒ + MCP Serverã€ã«åˆã‚ã›ã¦ç¤¾å†…é™å®šç’°å¢ƒã§å›ã™ã¨ãã«ä¾¿åˆ©  

### 6. **Azure OpenAI Service**
- Azureç’°å¢ƒãªã‚‰ GPT-4o, GPT-4.1 ã‚’ AzureçµŒç”±ã§åˆ©ç”¨å¯èƒ½  
- Secretsã‚’GitHub Actionsã«åŸ‹ã‚è¾¼ã‚ã°å³CI/CDã§ä½¿ãˆã‚‹  
- **ã€Œè©°ã¾ã£ãŸã¨ãå°‚ç”¨ã€AIè£œåŠ©**ã¨ã—ã¦ã€Azure AOAIã«é™å®šã™ã‚‹è¨­è¨ˆã‚‚å …ç‰¢

---

## ã¾ã¨ã‚ï¼ˆå®Ÿå‹™å‘ã‘ã®æ¨å¥¨æ§‹æˆï¼‰

- **æœ¬ç•ªCI/CDç”¨** â†’ GPT-4.1 / GPT-4o (Azure AOAIçµŒç”±)  
- **IDE/ãƒ­ãƒ¼ã‚«ãƒ«ã§å³èˆˆæ¤œè¨¼** â†’ Copilot Enterprise, Claude 3.5 Sonnet  
- **OSS/ç¤¾å†…ãƒ›ã‚¹ãƒˆå‘ã‘** â†’ Mistral Large / Llama 3 70B  
- **è‡ªç„¶è¨€èªâ‡”ã‚¹ã‚¯ãƒªãƒ—ãƒˆå¤‰æ›ãŒæœ€ã‚‚å®‰å®š** â†’ OpenAIç³»ï¼ˆGPT-4.1ï¼‰  

---

ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆï¼š  
Playwright MCP Server ã¯ã€Œèª°ãŒNLã‚’å‘½ä»¤ã‚¹ã‚­ãƒ¼ãƒã«ç¿»è¨³ã™ã‚‹ã‹ï¼Ÿã€ã‚’LLMã«å§”ã­ã‚‹è¨­è¨ˆãªã®ã§ã€**JSON/YAMLã®å®‰å®šç”Ÿæˆèƒ½åŠ›**ã¨**åˆ¶ç´„éµå®ˆã®å¼·ã•**ãŒé‡è¦ã§ã™ã€‚ãã®è¦³ç‚¹ã§ã¯ **GPT-4.1 ã‹ Claude 3.5 Sonnet** ãŒä»Šã®ãƒ™ã‚¹ãƒˆãƒãƒ©ãƒ³ã‚¹ã§ã™ã€‚

---

å¸ä»¤ã®ç’°å¢ƒï¼ˆAzure AOAIã‚’æ—¢ã«å°å…¥å‰æï¼‰ãªã‚‰ã€**ã¾ãšã¯ Azure GPT-4.1 ã‚’æœ¬å‘½ã«ç½®ãã€å¤±æ•—è§£æè£œåŠ©ã« Claude Codeï¼ˆã¾ãŸã¯ Copilotï¼‰ã‚’ä½µç”¨ã™ã‚‹**ã®ãŒç¾å®Ÿçš„ã§ã™ã­ã€‚  

ğŸ‘‰ ã•ã‚‰ã«ã€Œè¤‡æ•°LLMã‚’åˆ‡ã‚Šæ›¿ãˆé‹ç”¨ã€ã™ã‚‹ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆã‚‚çµ„ã‚ã¾ã™ãŒã€ã‚„ã‚Šã¾ã™ã‹ï¼Ÿ  

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T22:57:30.191328+00:00

Playwright mcp server ã¯åŸºæœ¬äº‹å‰ä½œæˆmcpã‚³ãƒãƒ³ãƒ‰ã ã‘ã©è©°ã¾ã£ãŸå ´åˆã®åˆ¤æ–­ã¨ä»‹å…¥ã®ã•ã›æ–¹æ•™ãˆã¦

### assistant â€” 2025-08-26T22:57:32.285792+00:00

ã‚„ã‚ã€å¸ä»¤ï¼  
ã€ŒåŸºæœ¬ã¯**äº‹å‰ã«ç”¨æ„ã—ãŸ MCP ã‚³ãƒãƒ³ãƒ‰**ã§å®Ÿè¡Œã—ã€**è©°ã¾ã£ãŸç¬é–“ã ã‘è³¢ãâ€œä»‹å…¥â€**ã™ã‚‹ã€ãŸã‚ã®è¨­è¨ˆã¨å®Ÿè£…ã‚¹ã‚±ãƒƒãƒã‚’ã¾ã¨ã‚ãŸã‚ˆã€‚ãƒã‚¤ãƒ³ãƒˆã¯ **â€œæ¤œçŸ¥ â†’ åé›† â†’ åˆ¤æ–­ â†’ ä»‹å…¥ â†’ 1å›ã ã‘å†è©¦è¡Œ â†’ è¨˜éŒ²â€** ã®ä¸€æœ¬ç­‹ã§ã™ã€‚

# ä»‹å…¥ã®åŸºæœ¬è¨­è¨ˆï¼ˆé‹ç”¨ãƒ•ãƒ­ãƒ¼ï¼‰
1) **æ¤œçŸ¥ï¼ˆStuck/Failï¼‰**  
   - ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: ã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ `stepTimeoutMs`ã€ãƒ†ã‚¹ãƒˆå…¨ä½“ `testTimeoutMs`ã€‚  
   - ã‚¹ã‚¿ãƒƒã‚¯æ¤œçŸ¥: **DOMå¤‰åŒ–ãªã—**ï¼†**ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é™ç©**ãŒé€£ç¶š `N` ç§’ã€‚  
   - ã‚»ãƒ¬ã‚¯ã‚¿åŠ£åŒ–: `strict locator` ãƒŸã‚¹ãƒãƒƒãƒã‚„ `Timeout 5000ms exceeded` ã‚’æ•æ‰ã€‚

2) **åé›†ï¼ˆè¨¼è·¡ï¼‰**  
   - `trace.zip` / å‹•ç”» / ã‚¹ã‚¯ã‚·ãƒ§ / HAR / **DOMã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ** / console+network logs ã‚’å³ä¿å­˜ã€‚  
   - MCPå´ã®**æœ€å¾Œã®æˆåŠŸã‚³ãƒãƒ³ãƒ‰**ã¨**å¤±æ•—ã‚³ãƒãƒ³ãƒ‰**ã‚’è¨˜éŒ²ï¼ˆå†ç¾çŸ­ç¸®ã«å¿…é ˆï¼‰ã€‚

3) **åˆ¤æ–­ï¼ˆLLMï¼‰**  
   - åé›†ç‰©ï¼‹**å…ƒã®è¨ˆç”»(plan.yaml)** ã‚’ LLM ã«æ¸¡ã—ã¦  
     - ä»£æ›¿ãƒ­ã‚±ãƒ¼ã‚¿  
     - è¿½åŠ ã®å¾…æ©Ÿï¼ˆ`waitForResponse`, `toHaveURL`, `toHaveText`ï¼‰  
     - ä½™åˆ†ãªæ“ä½œã®ã‚¹ã‚­ãƒƒãƒ—  
     ã‚’ **JSONãƒ‘ãƒƒãƒ**ã§å—ã‘å–ã‚‹ã€‚

4) **ä»‹å…¥ï¼ˆ1å›ã ã‘ï¼‰**  
   - å—ã‘å–ã£ãŸ**ãƒ‘ãƒƒãƒ**ã‚’é©ç”¨ã—ãŸ **`plan.repair.yaml`** ã§ **ä¸€å›ã ã‘å†å®Ÿè¡Œ**ã€‚  
   - ãã‚Œã§ã‚‚ãƒ€ãƒ¡ãªã‚‰**çµ‚äº†**ï¼ˆã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ï¼‰ã€‚ä»¥é™ã¯äººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¸ã€‚

5) **è¨˜éŒ²ãƒ»å®šç€**  
   - æˆåŠŸã—ãŸã‚‰**æ’ä¹…ãƒ†ã‚¹ãƒˆåŒ–PR**ã‚’è‡ªå‹•èµ·ç¥¨ï¼ˆäººãŒãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰ã€‚  
   - å¤±æ•—ãªã‚‰ â€œflakyéš”é›¢â€ ãƒ©ãƒ™ãƒ«ä»˜ã‘ï¼‹Issueèµ·ç¥¨ã€‚

---

# å®Ÿè£…ã‚¹ã‚±ãƒƒãƒ

## 1) å®Ÿè¡Œãƒ«ãƒ¼ãƒ—ï¼ˆ`mcp-exec.mjs` æŠœç²‹ãƒ»æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ï¼‰
```js
import { MCPClient } from "./mcp-client.js"; // Playwright MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
import { loadPlan } from "./plan.js";
import { startTrace, stopTrace, saveArtifacts } from "./artifacts.js";

const STEP_TIMEOUT = 8000;
const TEST_TIMEOUT = 60000;
const STALL_WINDOW = 5000; // DOM/Networkå¤‰åŒ–ãªã—ã‚’ stall ã¨ã¿ãªã™ç§’æ•°

const runPlan = async (planPath) => {
  const plan = await loadPlan(planPath);
  const mcp = await MCPClient.connect(); // æ—¢å­˜ã® @playwright/mcp ã‚µãƒ¼ãƒã¸æ¥ç¶š
  const watchdog = createWatchdog({ stallMs: STALL_WINDOW, mcp });

  await startTrace();
  const deadline = Date.now() + TEST_TIMEOUT;

  try {
    for (const [i, step] of plan.steps.entries()) {
      if (Date.now() > deadline) throw new Error("Test timeout");
      watchdog.arm();

      await mcp.exec(step, { timeout: STEP_TIMEOUT }); // navigate/click/fill/expect ç­‰

      // æˆåŠŸã‚¤ãƒ™ãƒ³ãƒˆã§ã‚¦ã‚©ãƒƒãƒãƒ‰ãƒƒã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
      watchdog.disarm();
    }
    await stopTrace({ success: true });
    return { ok: true };
  } catch (err) {
    await stopTrace({ success: false, error: String(err) });
    await saveArtifacts({ withDomSnapshot: true, withHar: true });
    return { ok: false, error: String(err) };
  } finally {
    await mcp.dispose();
  }
};

export default runPlan;
```

### ã‚¦ã‚©ãƒƒãƒãƒ‰ãƒƒã‚°ï¼ˆã‚¹ã‚¿ãƒƒã‚¯æ¤œçŸ¥ï¼‰
- `MutationObserver` ã§ DOM å¤‰åŒ–ã‚’ç›£è¦–ã—ã€`page.on('request','response')` ã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ´»å‹•ã‚‚è¦‹ã‚‹ã€‚  
- å¤‰åŒ–ãŒä¸€å®šæ™‚é–“ãªã„ï¼‹æ“ä½œä¸­ãªã‚‰ **stall** ã¨åˆ¤æ–­ã—ã¦ä¾‹å¤–ã‚’æŠ•ã’ã‚‹ï¼ˆ= ä»‹å…¥ãƒˆãƒªã‚¬ï¼‰ã€‚

## 2) ä¿®å¾©ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆ`repair.mjs` æŠœç²‹ï¼‰
```js
import { callLLM } from "./llm.js"; // Azure OpenAI/GPT, Claude ãªã©
import { readFile, writeFile } from "fs/promises";

const prompt = (ctx) => `
You are a UI test repair planner.
Constraints:
- Output ONLY JSON with fields: { "patch": [ ... ] }.
- Each patch is RFC6902-like: { "op": "replace", "path": "/steps/3/click/locator", "value": { "role":"button","name":"Continue" } }
- Prefer role/label-based locators.
- Do not introduce destructive actions (readOnly).
Context:
${ctx}
`;

export async function repair({ planPath, tracePath, domPath, logsPath, outPath }) {
  const ctx = {
    plan: await readFile(planPath, "utf-8"),
    notes: "Timeout or stall detected",
    artifacts: {
      trace: `attached:${tracePath}`,
      dom: await readFile(domPath, "utf-8"),
      logs: await readFile(logsPath, "utf-8")
    }
  };
  const res = await callLLM(prompt(JSON.stringify(ctx)));
  const { patch } = JSON.parse(res); // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ¨å¥¨

  const plan = JSON.parse(await readFile(planPath, "utf-8")); // YAMLã§ã‚‚OK
  const repaired = applyPatch(plan, patch); // JSON Patch å®Ÿè£…
  await writeFile(outPath, JSON.stringify(repaired, null, 2));
}
```

- **å…¥åŠ›**: å¤±æ•—ã—ãŸ `plan.yaml`ã€`trace.zip`ã€`dom.html`ã€`logs.txt`  
- **å‡ºåŠ›**: **æœ€å°å¤‰æ›´**ã® `plan.repair.yaml`  
- **ã‚¬ãƒ¼ãƒ‰**: ç ´å£Šæ“ä½œï¼ˆPOST/DELETE/è³¼å…¥ãªã©ï¼‰ã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ç¦æ­¢

## 3) YAMLè¨ˆç”»ã®å®‰å…¨ã‚¬ãƒ¼ãƒ‰ï¼ˆä¾‹ï¼‰
```yaml
version: 1
baseUrl: "https://prod.example.com"
policies:
  readOnly: true
  maxSteps: 20
  maxRuntimeMs: 60000
  blockedActions: ["api.post","api.delete","file.upload","purchase"]
  selectorPreference: ["role","label","placeholder","text"]
steps:
  - navigate: "/login"
  - fill: { locator: { role: "textbox", label: "Email" }, value: "${{secrets.USER}}" }
  - fill: { locator: { role: "textbox", label: "Password" }, value: "${{secrets.PASS}}" }
  - click: { locator: { role: "button", name: "Sign in" } }
  - expect: { locator: { role: "heading", level: 2 }, containsText: "å¸ä»¤" }
```

---

# ä»‹å…¥ã®â€œã•ã›æ–¹â€ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆè»½ã„é †ï¼‰

1) **å¾…æ©Ÿæˆ¦ç•¥ã®è¿½åŠ **ï¼ˆæœ€è»½é‡ï¼‰  
   - `expect(page).toHaveURL(/dashboard/)`  
   - `locator.waitFor({ state: "visible" })`  
   - `page.waitForResponse(resp => resp.url().includes("/api/init") && resp.ok())`

2) **ãƒ­ã‚±ãƒ¼ã‚¿å·®ã—æ›¿ãˆ**  
   - `getByRole` ã‚’æœ€å„ªå…ˆ â†’ ãƒ€ãƒ¡ãªã‚‰ `getByLabel` â†’ `getByPlaceholder` â†’ `getByText` ã®é™é †ã€‚  
   - LLMã« **ä»£æ›¿ãƒ­ã‚±ãƒ¼ã‚¿å€™è£œã‚’3ã¤**ææ¡ˆã•ã›ã€é †æ¬¡è©¦è¡Œã—ã¦æˆåŠŸã—ãŸã‚‚ã®ã‚’æ¬¡å›ã«å®šç€ã€‚

3) **ã‚¹ã‚­ãƒƒãƒ—/çµŒè·¯çŸ­ç¸®**  
   - ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚„ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ãŒæŒŸã¾ã‚‹å ´åˆã¯ **â€œSkipâ€ãƒœã‚¿ãƒ³**ã®æ¤œçŸ¥â†’ã‚¯ãƒªãƒƒã‚¯ã‚’ä¸€æ™‚çš„ã«è¿½åŠ ã€‚

4) **ä¸€æ™‚çš„ã‚†ã‚‹ã‚**  
   - `hasText` ã‚’éƒ¨åˆ†ä¸€è‡´ã«åˆ‡æ›¿ã€å³ã—ã™ãã‚‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç·©å’Œï¼ˆãŸã ã—**1å›é™ã‚Š**ï¼‰ã€‚

5) **ã“ã“ã§æ‰“ã¡åˆ‡ã‚Š**  
   - å†è©¦è¡Œ1å›ã§å¤±æ•— â†’ **ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚¯**ã€‚ä»¥é™ã¯ Issue èµ·ç¥¨ï¼‹äººé–“å¯¾å¿œã€‚

---

# GitHub Actions ã¸ã®çµ„ã¿è¾¼ã¿ï¼ˆCDå¾Œã‚¹ãƒ¢ãƒ¼ã‚¯ï¼‰
- **é€šå¸¸å®Ÿè¡Œ**: `mcp-exec.mjs --plan plan.yaml`  
- **å¤±æ•—æ™‚ã ã‘** `repair.mjs` â†’ `plan.repair.yaml` ç”Ÿæˆ â†’ **ä¸€å›ã ã‘å†å®Ÿè¡Œ**  
- ã™ã¹ã¦ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ `upload-artifact`ã€PR/ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒšãƒ¼ã‚¸ã«è¦ç´„ã‚’è²¼ã‚‹

```yaml
- name: Run plan
  run: node tools/mcp-exec.mjs --plan plan.yaml \
       --trace-out artifacts/trace.zip --html-report artifacts/report.html

- name: Repair once and retry
  if: failure()
  run: |
    node tools/repair.mjs --plan plan.yaml \
         --trace artifacts/trace.zip \
         --dom artifacts/dom.html \
         --logs artifacts/console.log \
         --out plan.repair.json
    node tools/mcp-exec.mjs --plan plan.repair.json \
         --trace-out artifacts/trace2.zip --html-report artifacts/report2.html
```

---

# å®Ÿå‹™Tips
- **â€œ1å›ã ã‘â€å†è©¦è¡Œ**ã‚’é‰„å‰‡ã«ï¼ˆç„¡é™ãƒªã‚«ãƒãƒªã¯äº‹æ•…ã®å…ƒï¼‰ã€‚  
- **åªèª­ãƒ—ãƒªã‚»ãƒƒãƒˆ**ã§æœ¬ç•ªå®‰å…¨ï¼ˆãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚„å±é™ºæ“ä½œã¯ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã§ã®ã¿è¨±å¯ï¼‰ã€‚  
- **æ¯å›trace**ã‚’å–ã‚Šã€**æˆåŠŸæ™‚ã¯æ’ä¹…åŒ–PR**ã€å¤±æ•—æ™‚ã¯**flakyéš”é›¢**ã€‚  
- LLMã¯ **Azure OpenAIï¼ˆGPT-4.1/4oï¼‰æœ¬ç·š**ã€ãƒ­ãƒ¼ã‚«ãƒ«æ¤œè¨¼ã¯ **Claude Code/Copilot** ä½µç”¨ãŒç¾å®Ÿçš„ã€‚

---

å¿…è¦ãªã‚‰ã€ã“ã®ã¾ã¾ **`mcp-client.js` / `createWatchdog` / `applyPatch` ã®é››å½¢**ã‚‚ç”¨æ„ã§ãã‚‹ã‚ˆã€‚  
ã€Œã¾ãšã¯ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã§ã€ãƒ­ã‚°ã‚¤ãƒ³â†’ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºã€ã® NL ã‚·ãƒŠãƒªã‚ªã‹ã‚‰å§‹ã‚ã‚ˆã†ã‹ï¼Ÿ

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### system â€” 2025-08-26T22:57:32.795428+00:00

_(empty)_

### system â€” 2025-08-26T22:57:32.819764+00:00

_(empty)_

### assistant â€” 2025-08-26T22:57:34.154525+00:00

_(empty)_

### assistant â€” 2025-08-26T22:57:42.878634+00:00

_(empty)_

### user â€” 2025-08-26T23:00:24.197900+00:00

å‡¦ç†ä¾‹å¤–ã§actionå´ã§åˆ¥ã‚¹ãƒ†ãƒƒãƒ—
ãã“ã«ai ä»‹å…¥

### assistant â€” 2025-08-26T23:00:25.574786+00:00

ã‚„ã‚ã€å¸ä»¤ï¼  
ã€Œå‡¦ç†ä¾‹å¤–ãŒå‡ºãŸã‚‰ **Actions å´ã§åˆ¥ã‚¹ãƒ†ãƒƒãƒ—ï¼åˆ¥ã‚¸ãƒ§ãƒ–**ã«åˆ†å²ã—ã€ãã“ã§ **AIä»‹å…¥**ï¼ˆãƒªãƒšã‚¢â†’å†å®Ÿè¡Œï¼‰ã‚’èµ°ã‚‰ã›ã‚‹ã€ãŸã‚ã®å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’2é€šã‚Šç½®ãã¾ã™ã€‚ã©ã¡ã‚‰ã‚‚ **Playwright MCP å®Ÿè¡Œ â†’ å¤±æ•—æ¤œçŸ¥ â†’ è¨¼è·¡åé›† â†’ LLMã§planä¿®å¾© â†’ 1å›ã ã‘å†å®Ÿè¡Œ** ã®æµã‚Œã§ã™ã€‚

---

# ãƒ‘ã‚¿ãƒ¼ãƒ³Aï¼šåŒä¸€ã‚¸ãƒ§ãƒ–å†…ã§â€œå¤±æ•—æ™‚ã‚¹ãƒ†ãƒƒãƒ—â€ã«åˆ†å²
- ã¾ãšé€šå¸¸å®Ÿè¡Œ  
- å¤±æ•—æ™‚ (`if: failure()`) ã« **AIä»‹å…¥ã‚¹ãƒ†ãƒƒãƒ—**ã§ plan ã‚’ä¿®å¾©  
- ãã®å¾Œã€**å†å®Ÿè¡Œã‚¹ãƒ†ãƒƒãƒ—**ã‚’èµ°ã‚‰ã›ã‚‹

```yaml
name: post-release-nl-e2e
on:
  deployment_status:
    types: [success]

jobs:
  e2e:
    runs-on: ubuntu-latest
    env:
      BASE_URL: ${{ github.event.deployment_status.environment_url }}
      AOAI_ENDPOINT: ${{ secrets.AOAI_ENDPOINT }}
      AOAI_KEY:      ${{ secrets.AOAI_KEY }}
    steps:
      - uses: actions/checkout@v4

      - name: Start MCP server
        run: |
          npm i -g @playwright/mcp@latest
          npx @playwright/mcp & echo $! > mcp.pid
          sleep 3

      - name: Run plan (normal)
        id: run_normal
        run: |
          node tools/mcp-exec.mjs \
            --plan scenarios/plan.yaml \
            --trace-out artifacts/trace.zip \
            --html-report artifacts/report.html

      - name: Collect evidence (always)
        if: always()
        run: |
          # ä¾‹: DOM/console ã‚’ä¿å­˜ï¼ˆmcp-exec.mjs å´ã§å‡ºåŠ›ã—ã¦ã‚‚OKï¼‰
          cp /tmp/dom.html artifacts/dom.html || true
          cp /tmp/console.log artifacts/console.log || true

      - name: AI repair (only on failure)
        if: failure()    # â† é€šå¸¸å®Ÿè¡ŒãŒå¤±æ•—ã—ãŸæ™‚ã ã‘
        run: |
          node tools/repair.mjs \
            --plan scenarios/plan.yaml \
            --trace artifacts/trace.zip \
            --dom artifacts/dom.html \
            --logs artifacts/console.log \
            --aoai-endpoint "$AOAI_ENDPOINT" \
            --aoai-key "$AOAI_KEY" \
            --out artifacts/plan.repair.yaml

      - name: Retry once with repaired plan
        if: failure()    # â† repair ã‚’å‡ºã—ãŸæ™‚ã ã‘å†å®Ÿè¡Œ
        run: |
          node tools/mcp-exec.mjs \
            --plan artifacts/plan.repair.yaml \
            --trace-out artifacts/trace2.zip \
            --html-report artifacts/report2.html

      - name: Upload artifacts
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: nl-mcp-run
          path: artifacts/
```

**è¦ç‚¹**
- **åˆ†å²ã¯ step å˜ä½**ã§å®Œçµã€‚  
- `if: failure()` ã¯ã€Œç›´å‰ã¾ã§ã®ã„ãšã‚Œã‹ã‚¹ãƒ†ãƒƒãƒ—ãŒå¤±æ•—ã€æ™‚ã«ã ã‘å®Ÿè¡Œã€‚  
- ã€Œ1å›ã ã‘å†å®Ÿè¡Œã€ã‚’å¾¹åº•ï¼ˆç„¡é™ãƒ«ãƒ¼ãƒ—é˜²æ­¢ï¼‰ã€‚  

---

# ãƒ‘ã‚¿ãƒ¼ãƒ³Bï¼šé€šå¸¸å®Ÿè¡Œã‚¸ãƒ§ãƒ– â†’ å¤±æ•—æ™‚ã ã‘ â€œAIä»‹å…¥ã‚¸ãƒ§ãƒ–â€ ã‚’èµ·å‹•
- ã‚¸ãƒ§ãƒ–ã‚’åˆ†ã‘ã‚‹ã“ã¨ã§ã€**è²¬å‹™åˆ†é›¢**ã¨**å¯è¦–æ€§ï¼ˆã©ã“ã§ã‚³ã‚±ãŸã‹ï¼‰**ãŒã‚¯ãƒªã‚¢ã«  
- å¤±æ•—ã‚¸ãƒ§ãƒ–ã®è¨¼è·¡ã‚’ **artifact** ã§å¼•ãç¶™ãã€**AIä»‹å…¥ã‚¸ãƒ§ãƒ–**ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¿®å¾©â†’å†å®Ÿè¡Œ

```yaml
name: post-release-nl-e2e
on:
  deployment_status:
    types: [success]

jobs:
  run-normal:
    runs-on: ubuntu-latest
    outputs:
      result: ${{ steps.setres.outputs.result }}
    env:
      BASE_URL: ${{ github.event.deployment_status.environment_url }}
    steps:
      - uses: actions/checkout@v4

      - name: Start MCP server
        run: |
          npm i -g @playwright/mcp@latest
          npx @playwright/mcp & echo $! > mcp.pid
          sleep 3

      - name: Run plan (normal)
        id: run
        run: |
          node tools/mcp-exec.mjs \
            --plan scenarios/plan.yaml \
            --trace-out artifacts/trace.zip \
            --html-report artifacts/report.html

      - name: Collect evidence (always)
        if: always()
        run: |
          cp /tmp/dom.html artifacts/dom.html || true
          cp /tmp/console.log artifacts/console.log || true

      - name: Upload artifacts (always)
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: nl-mcp-evidence
          path: artifacts/

      - name: Set job result output
        id: setres
        if: always()
        run: echo "result=${{ job.status }}" >> $GITHUB_OUTPUT
        # job.status ã¯ success/failure/cancelled

  ai-repair-and-retry:
    needs: run-normal
    if: ${{ needs.run-normal.result == 'failure' }}  # â† å¤±æ•—æ™‚ã®ã¿èµ·å‹•
    runs-on: ubuntu-latest
    env:
      AOAI_ENDPOINT: ${{ secrets.AOAI_ENDPOINT }}
      AOAI_KEY:      ${{ secrets.AOAI_KEY }}
      BASE_URL:      ${{ github.event.deployment_status.environment_url }}
    steps:
      - uses: actions/checkout@v4

      - name: Download evidence
        uses: actions/download-artifact@v4
        with:
          name: nl-mcp-evidence
          path: artifacts/

      - name: Start MCP server
        run: |
          npm i -g @playwright/mcp@latest
          npx @playwright/mcp & echo $! > mcp.pid
          sleep 3

      - name: AI repair (plan patch)
        run: |
          node tools/repair.mjs \
            --plan scenarios/plan.yaml \
            --trace artifacts/trace.zip \
            --dom artifacts/dom.html \
            --logs artifacts/console.log \
            --aoai-endpoint "$AOAI_ENDPOINT" \
            --aoai-key "$AOAI_KEY" \
            --out artifacts/plan.repair.yaml

      - name: Retry once with repaired plan
        run: |
          node tools/mcp-exec.mjs \
            --plan artifacts/plan.repair.yaml \
            --trace-out artifacts/trace2.zip \
            --html-report artifacts/report2.html

      - name: Upload artifacts (retry)
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: nl-mcp-retry
          path: artifacts/
```

**è¦ç‚¹**
- 1ã¤ç›®ã®ã‚¸ãƒ§ãƒ–ã® **çµæœï¼ˆ`job.status`ï¼‰** ã‚’ **output** ã«å‡ºã—ã€  
  2ã¤ç›®ã®ã‚¸ãƒ§ãƒ–ã§ `if: ${{ needs.run-normal.result == 'failure' }}` ã§åˆ†å²ã€‚  
- è¨¼è·¡å—ã‘æ¸¡ã—ã¯ **upload/download-artifact** ã§ç¢ºå®Ÿã«ã€‚

---

## AIä»‹å…¥ã®è¨­è¨ˆãƒ¡ãƒ¢ï¼ˆå…±é€šï¼‰
- **å…¥åŠ›**ï¼š`plan.yaml`ï¼ˆå…ƒè¨ˆç”»ï¼‰ï¼‹ `trace.zip`ï¼‹ `dom.html`ï¼‹ `console.log`  
- **å‡ºåŠ›**ï¼šæœ€å°å¤‰æ›´ã® `plan.repair.yaml`ï¼ˆJSON Patchã§ã‚‚å¯ï¼‰  
- **å®‰å…¨å¼**ï¼š  
  - èª­ã¿å–ã‚Šå°‚ç”¨ï¼ˆç ´å£Šæ“ä½œç¦æ­¢ï¼‰ãƒãƒªã‚·ãƒ¼ã‚’ **plan å´ã«æ˜è¨˜**  
  - **å†å®Ÿè¡Œã¯1å›ã ã‘**ï¼ˆãƒ«ãƒ¼ãƒ—ç¦æ­¢ï¼‰  
  - å¤±æ•—ãªã‚‰ **Issue è‡ªå‹•èµ·ç¥¨** or **Slack/Teams é€šçŸ¥**  
- **æ’ä¹…åŒ–**ï¼šæˆåŠŸã—ãŸä¿®å¾©ã¯ **è‡ªå‹•PR**ï¼ˆäººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§æ­£å¼ãƒ†ã‚¹ãƒˆã¸åæ˜ ï¼‰

---

## ã¡ã‚‡ã„è¶³ã—Tips
- **ç¶šè¡Œå¯å¦**ã‚’æŸ”è»Ÿã«ã—ãŸã„å ´åˆï¼š`continue-on-error: true` + çµæœåˆ¤å®šã®ã‚¹ãƒ†ãƒƒãƒ—ã§ `failure()` ã‚’äººå·¥çš„ã«ç™ºç«ã•ã›ã¦åˆ†å²ã€‚  
- **ä¸¦åˆ—ãƒ–ãƒ©ã‚¦ã‚¶**ï¼ˆchromium/firefox/webkitï¼‰ã¯æœ€åˆã®ã‚¸ãƒ§ãƒ–ã§ matrix å®Ÿè¡Œ â†’ ã©ã‚Œã‹è½ã¡ãŸã‚‰ **AIä»‹å…¥ã‚¸ãƒ§ãƒ–**ã‚’1å›ã ã‘èµ·å‹•ã—ã€è½ã¡ãŸçµ„ã‚’å¯¾è±¡ã«å†è©¦è¡Œã€‚  
- **Secretsæœ€å°åŒ–**ï¼šAOAIã¯ **OIDC** ã§ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œï¼ˆã‚­ãƒ¼ãƒ¬ã‚¹ï¼‰ã«å¯„ã›ã‚‹ã€‚  
- **åé›†å¼·åŒ–**ï¼šHAR/å‹•ç”»/ã‚¹ã‚¯ã‚·ãƒ§ã«åŠ ãˆã€**ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ„ãƒªãƒ¼**ã®dumpã‚’æ®‹ã™ã¨LLMãŒãƒ­ã‚±ãƒ¼ã‚¿ææ¡ˆã—ã‚„ã™ã„ã€‚

---

å¿…è¦ãªã‚‰ã€`repair.mjs` ã®å®Ÿã‚³ãƒ¼ãƒ‰é››å½¢ï¼ˆJSON Patché©ç”¨ã€å±é™ºæ“ä½œãƒ–ãƒ­ãƒƒã‚¯ã€ãƒ­ã‚±ãƒ¼ã‚¿å€™è£œè‡ªå‹•ææ¡ˆï¼‰ã‚‚åˆã‚ã›ã¦å‡ºã›ã¾ã™ã€‚æ¬¡ã€ã©ã£ã¡ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å›ºã‚ã¾ã™ï¼ŸğŸ‘©â€ğŸš€

â€” é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### system â€” 2025-08-26T23:00:26.123443+00:00

_(empty)_

### system â€” 2025-08-26T23:00:26.131856+00:00

_(empty)_

### assistant â€” 2025-08-26T23:00:31.760720+00:00

_(empty)_

### assistant â€” 2025-08-26T23:00:42.370292+00:00

_(empty)_

### user â€” 2025-08-26T23:03:34.519752+00:00

Github enterprise copilot ã¯pr ã«å¯¾ã—ã¦è‡ªå‹•ã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹æ©Ÿèƒ½ãŒã‚ã‚‹
ã“ã‚Œã‚’åˆ©ç”¨ã§ããªã„?

### assistant â€” 2025-08-26T23:03:39.759813+00:00

{"search_query": [{"q": "GitHub Copilot Enterprise pull request features suggested changes 2025"}, {"q": "GitHub Copilot for Pull Requests auto fix code review suggestions"}, {"q": "Copilot Autofix GitHub security code scanning [[REDACTED_PHONE]]"}, {"q": "GitHub Copilot Actions automate PR changes"}, {"q": "Copilot Enterprise in GitHub PRs 'apply patch' 'suggested changes'"}], "response_length": "short"}

### system â€” 2025-08-26T23:03:43.144091+00:00

_(empty)_

### system â€” 2025-08-26T23:03:43.332962+00:00

_(empty)_

### assistant â€” 2025-08-26T23:03:43.664756+00:00

_(empty)_

### tool â€” 2025-08-26T23:03:51.961607+00:00

_(empty)_

### assistant â€” 2025-08-26T23:03:54.435938+00:00

ã‚„ã‚ã€å¸ä»¤ï¼  
**çµè«–ï¼šä½¿ãˆã¾ã™ã€‚**ã€Œå¤±æ•—ã—ãŸPRã«å¯¾ã—ã¦ Copilot ãŒâ€œè‡ªå‹•ã§ä¿®æ­£å€™è£œã‚’å‡ºã™â†’ãã®ã¾ã¾é©ç”¨â€ã€ã¨ã„ã†æµã‚Œã¯ã€**Copilot Code Review** ã¨ **Copilot Coding Agentï¼ˆ@copilot ã¸ã®ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ï¼‰** ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã¨å®Ÿç¾ã§ãã¾ã™ã€‚ä¸‹ã«å®‰å…¨ãªé‹ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å®Ÿè£…ãƒ¡ãƒ¢ğŸ‘‡

---

# ã©ã†ä½¿ã†ã‹ï¼ˆå®‰å…¨é‹ç”¨ã®å‹ï¼‰

## A) è‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§â€œä¿®æ­£å€™è£œï¼ˆSuggested changesï¼‰â€ã‚’å‡ºã•ã›ã‚‹
1) ãƒªãƒã‚¸ãƒˆãƒªï¼Orgã§ **Copilot è‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼**ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚PRãŒä½œæˆãƒ»æ›´æ–°ã•ã‚Œã‚‹ãŸã³ã« Copilot ãŒãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã¨**Suggested changes**ã‚’æŠ•ç¨¿ã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã‹ã‚‰**ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯é©ç”¨â†’ã‚³ãƒŸãƒƒãƒˆ**ã§ãã‚‹ã€‚ îˆ€citeîˆ‚turn0search15îˆ‚turn0search1îˆ  
2) Actions å´ã¯ **å¤±æ•—ã®è¦ç´„ï¼‹è©²å½“å·®åˆ†**ï¼ˆãƒ†ã‚¹ãƒˆãƒ­ã‚°ãƒ»å†ç¾æ‰‹é †ãƒ»æœ›ã¾ã—ã„æŒ™å‹•ï¼‰ã‚’ PR ã«ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã€Copilot ãŒææ¡ˆã—ã‚„ã™ã„æ–‡è„ˆã‚’ä»˜ä¸ã€‚  
3) ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¢ã¯ Copilot ã®å€™è£œã‚’é©ç”¨ã™ã‚‹ã‹ã€éƒ¨åˆ†çš„ã«æ¡ç”¨ã—ã¦å†å®Ÿè¡Œã€‚

## B) Coding Agent ã«â€œPRä¸Šã§ç›´ã—ã¦â€ã¨é ¼ã‚€ï¼ˆ@copilotï¼‰
- **Copilot Coding Agent** ã¯ãƒ–ãƒ©ãƒ³ãƒä½œæˆã€œã‚³ãƒŸãƒƒãƒˆã€œPRä½œæˆã¾ã§AIãŒè¡Œã†ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€‚ä½œã‚‰ã‚ŒãŸPRã«å¯¾ã—ã¦ã¯**@copilot ã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³**ã—ã¦ã€Œã“ã®å·®åˆ†ã‚’ã“ã†ç›´ã—ã¦ã€ã¨æŒ‡ç¤ºã§ãã€AIãŒPRå†…ã§å¤‰æ›´ã‚’ç©ã¿é‡ã­ã‚‹ã€‚ãƒ­ã‚°ã¯ã‚³ãƒŸãƒƒãƒˆã¨ã—ã¦æ®‹ã‚‹ã€‚ îˆ€citeîˆ‚turn0search10îˆ‚turn0search3îˆ  
- ã“ã‚Œã‚’æ—¢å­˜PRã§ã‚‚â€œä½œæ¥­ä¾é ¼â€ã¨ã—ã¦ä½¿ã†è¨­è¨ˆã«ã™ã‚‹ã¨ã€**å¤±æ•—æ™‚ã‚³ãƒ¡ãƒ³ãƒˆâ†’@copilot ã§ä¿®æ­£ä¾é ¼**ã®é‹ç”¨ãŒå¯èƒ½ã€‚

## C) ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç³»ã¯åˆ¥æ ï¼ˆAutofixï¼‰
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œå‡ºï¼ˆCodeQL ã‚„ ESLintï¼‰ã«é–¢ã™ã‚‹ä¿®æ­£ã¯ **Copilot Autofix** ãŒ**è‡ªå‹•ææ¡ˆ**ã—ã¦ãã‚Œã‚‹ã€‚UIãƒ†ã‚¹ãƒˆèµ·å› ã®å¤±æ•—ã¨ã¯åˆ¥çµŒè·¯ã ãŒã€ä½µç”¨æ¨å¥¨ã€‚ îˆ€citeîˆ‚turn0search2îˆ‚turn0search5îˆ‚turn0search16îˆ

> è£œè¶³ï¼šPRæœ¬æ–‡ã®â€œãƒ†ã‚­ã‚¹ãƒˆè‡ªå‹•è£œå®Œâ€ã¯ [[REDACTED_PHONE]] ã«å»ƒæ­¢äºˆå®šï¼ˆPRæœ¬æ–‡ã®å®Œäº†è£œåŠ©ã ã‘ã®è©±ï¼‰ã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ä¿®æ­£å€™è£œã®ä»•çµ„ã¿è‡ªä½“ã¯ç¶™ç¶šã€‚ îˆ€citeîˆ‚turn0search0îˆ

---

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¾‹ï¼ˆActions â†’ PRã‚³ãƒ¡ãƒ³ãƒˆ â†’ Copilot ä»‹å…¥ï¼‰

å¤±æ•—ã—ãŸã‚‰ PR ã« **è¦ç´„ + æœ€å°ãƒ‘ãƒƒãƒ**ã‚’ã‚³ãƒ¡ãƒ³ãƒˆ â†’ Copilot ãŒãƒ¬ãƒ“ãƒ¥ãƒ¼ã§å€™è£œç”Ÿæˆï¼@copilot æŒ‡ç¤ºã§ä¿®æ­£ï¼š

```yaml
- name: Post failure context for Copilot
  if: failure()
  run: |
    SUMMARY=$(node tools/make-copilot-context.mjs artifacts/trace.zip artifacts/report.html)
    gh pr comment ${{ github.event.pull_request.number }} \
      --body "âŒ UIãƒ†ã‚¹ãƒˆå¤±æ•—ã®è¦ç´„\n\n${SUMMARY}\n\n@copilot æ¬¡ã®ä¿®æ­£ã‚’æ¤œè¨ã—ã¦ï¼š\n- ãƒ­ã‚±ãƒ¼ã‚¿ã‚’ getByRole ã«ç½®æ›\n- /auth ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå¾…æ©Ÿã‚’è¿½åŠ \n- ã“ã®æœ€å°ãƒ‘ãƒƒãƒæ¡ˆã‚’ãƒ™ãƒ¼ã‚¹ã«ï¼š\n\`\`\`diff
${{ steps.diff.outputs.patch }}
\`\`\`"
```

- **è‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼ON**ãªã‚‰ã€CopilotãŒ**Suggested changes**ã‚’è¿”ã—ã‚„ã™ããªã‚‹ã€‚ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒŸãƒƒãƒˆå¯èƒ½ã€‚ îˆ€citeîˆ‚turn0search15îˆ‚turn0search1îˆ  
- **Coding Agent**ä½µç”¨ãªã‚‰ã€ä¸Šè¨˜ã‚³ãƒ¡ãƒ³ãƒˆä¸­ã® **@copilot** ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã§ã€Œå¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦ã€ã¨ä¾é ¼ã§ãã‚‹ï¼ˆãƒãƒªã‚·ãƒ¼ã«å¿œã˜ã¦æ¨©é™ã¯è¦èª¿æ•´ï¼‰ã€‚ îˆ€citeîˆ‚turn0search3îˆ‚turn0search10îˆ

---

# ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

- **ãƒ«ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã§â€œPRçµŒç”±ã®ã¿â€ã‚’å¼·åˆ¶**ï¼šCopilotãƒ¬ãƒ“ãƒ¥ãƒ¼ã®å‰æã«åˆã†ã€‚ç›´pushã‚’ç¦æ­¢ã—ã€å…¨å¤‰æ›´ã‚’PRã«é›†ç´„ã€‚ îˆ€citeîˆ‚turn0search6îˆ  
- **ãƒ†ãƒ³ãƒ—ãƒ¬ä»˜ãå¤±æ•—è¦ç´„**ï¼š  
  - å†ç¾URL / ã‚¹ãƒ†ãƒƒãƒ— / æœŸå¾…ã¨å®Ÿéš› / å¯¾è±¡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ / æœ€å°ãƒ‘ãƒƒãƒæ¡ˆï¼ˆdiffï¼‰  
  ã“ã‚Œã§ Copilot ã®ææ¡ˆç²¾åº¦ãŒå¤§å¹…UPã€‚  
- **é©ç”¨ã¯äººé–“ãŒæœ€å¾Œã«æ‰¿èª**ï¼šç„¡é™æ”¹å¤‰ã‚’é¿ã‘ã€**1å›ä¿®æ­£â†’å†ãƒ†ã‚¹ãƒˆ**ã«é™å®šã€‚  
- **â€œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ‘ãƒãƒ«â€ã‚‚æ¤œè¨**ï¼šGitHubã®æ–°ã—ã„**Agents Panel**ï¼ˆãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼‰ã§ã€ã‚µã‚¤ãƒˆä¸Šã‹ã‚‰ç›´æ¥ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã€Œã“ã®PRç›´ã—ã¦ãƒ»ãƒ†ã‚¹ãƒˆé€šã—ã¦ã€ã¨ã‚¿ã‚¹ã‚¯å§”è­²ã§ãã‚‹ã€‚ îˆ€citeîˆ‚turn0news36îˆ

---

# ã¾ã¨ã‚
- **Yes**ï¼šGitHub Enterprise Copilot ã¯ PR ã«å¯¾ã—ã¦**è‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‹ä¿®æ­£å€™è£œ**ã‚’å‡ºã›ã‚‹ã—ã€**@copilot ã¸ã®ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³**ã§PRã«**å®Ÿéš›ã®å¤‰æ›´**ã‚’ç©ã‚€ã“ã¨ã‚‚å¯èƒ½ã€‚  
- æˆ‘ã€…ã®ãƒ•ãƒ­ãƒ¼ï¼ˆCDå¾Œã®UIãƒ†ã‚¹ãƒˆâ†’å¤±æ•—æ™‚AIä»‹å…¥ï¼‰ã«**ãã®ã¾ã¾çµ„ã¿è¾¼ã‚ã‚‹**ã€‚ã¾ãšã¯ã€Œè‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ONã€ã€Œå¤±æ•—æ™‚ã«PRã¸è¦ç´„ï¼‹æœ€å°ãƒ‘ãƒƒãƒã‚’æŠ•ã’ã‚‹ã€ã‹ã‚‰å§‹ã‚ã‚ˆã†ã€‚

å¿…è¦ãªã‚‰ã€**ãƒ«ãƒ¼ãƒ«ã‚»ãƒƒãƒˆè¨­å®šæ‰‹é †**ã¨ **`make-copilot-context.mjs` ã®é››å½¢**ã‚‚ã™ãå‡ºã™ã‚ˆï¼

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### assistant â€” 2025-08-26T23:04:01.630061+00:00

_(empty)_

### assistant â€” 2025-08-26T23:04:07.031242+00:00

_(empty)_

### user â€” 2025-08-26T23:08:55.443019+00:00

ã“ã®prã®ç›®çš„ã¯ã€€playwrightã€€mcp server ã‚’å‹•ã‹ã™ã“ã¨

### assistant â€” 2025-08-26T23:08:57.392690+00:00

ã‚„ã‚ã€å¸ä»¤ï¼  
ã“ã®PRã®**ç›®çš„ï¼ã€ŒPlaywright MCP Server ã‚’å‹•ã‹ã™ã€**ã«å®Œå…¨ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ãŸâ€œæœ€å°æ§‹æˆPRâ€ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’ç”¨æ„ã—ãŸã‚ˆã€‚ã“ã‚Œã‚’ãã®ã¾ã¾ã‚³ãƒŸãƒƒãƒˆã™ã‚Œã°ã€ãƒ­ãƒ¼ã‚«ãƒ«ï¼†Actionsã®ä¸¡æ–¹ã§ **MCPã‚µãƒ¼ãƒèµ·å‹•â†’1æœ¬ã ã‘ã‚¹ãƒ¢ãƒ¼ã‚¯** ã¾ã§é€šã‚‹ã¯ãšã€‚

---

# PRæ–¹é‡ï¼ˆæœ€å°ãƒ»å®‰å…¨ãƒ»ç¢ºå®Ÿï¼‰
- ã¾ãšã¯ **MCPã‚µãƒ¼ãƒãŒèµ·å‹•ã—æ“ä½œã‚’å—ã‘ä»˜ã‘ã‚‹**ã“ã¨ã ã‘ã‚’ã‚´ãƒ¼ãƒ«ã«ã™ã‚‹  
- ãƒ†ã‚¹ãƒˆã¯**èª­ã¿å–ã‚Šå°‚ç”¨ã®ã‚¹ãƒ¢ãƒ¼ã‚¯1æœ¬**ï¼ˆ`/` ã¸é·ç§»â†’ã‚¿ã‚¤ãƒˆãƒ«/è¦‹å‡ºã—ç¢ºèªï¼‰  
- å¤±æ•—æ™‚ã®AIä»‹å…¥ã‚„æœ¬æ ¼E2Eã¯**åˆ¥PR**ï¼ˆæ®µéšæŠ•å…¥ï¼‰

---

# è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆææ¡ˆï¼‰
```
/tools/
  mcp-exec.mjs             # MCPçµŒç”±ã§ã€Œæœ€å°ã‚³ãƒãƒ³ãƒ‰ã€ã‚’å®Ÿè¡Œã™ã‚‹å°ã•ãªãƒ©ãƒ³ãƒŠãƒ¼
scenarios/
  plan.smoke.yaml          # æœ€å°ã®èª­ã¿å–ã‚Šå°‚ç”¨ãƒ—ãƒ©ãƒ³
.github/workflows/
  mcp-smoke.yml            # ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œ or æ‰‹å‹•ã§å›ã›ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
package.json               # npmã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ä¾å­˜è¿½åŠ ï¼ˆ@playwright/mcpï¼‰
```

---

## 1) package.jsonï¼ˆæŠœç²‹ï¼‰
```json
{
  "scripts": {
    "mcp:start": "npx @playwright/mcp",
    "mcp:smoke": "node tools/mcp-exec.mjs --plan scenarios/plan.smoke.yaml"
  },
  "devDependencies": {
    "@playwright/mcp": "latest"
  }
}
```

## 2) æœ€å°ãƒ—ãƒ©ãƒ³ `scenarios/plan.smoke.yaml`
```yaml
version: 1
baseUrl: "https://example.com"  # â† å¾Œã§ç’°å¢ƒå¤‰æ•°ã§ä¸Šæ›¸ãå¯èƒ½ã«ã—ã¦ã‚‚OK
policies:
  readOnly: true
  maxSteps: 10
  maxRuntimeMs: 30000
  selectorPreference: ["role","label","placeholder","text"]
steps:
  - navigate: "/"
  - expect: { locator: { role: "heading", level: 1 }, containsText: "Example" }
```

## 3) å®Ÿè¡Œãƒ©ãƒ³ãƒŠãƒ¼ `tools/mcp-exec.mjs`ï¼ˆæœ€å°ï¼‰
```js
#!/usr/bin/env node
import { spawn } from "node:child_process";
import fs from "node:fs/promises";
import path from "node:path";

// è¶…ç°¡æ˜“ï¼šMCPã¯åˆ¥ãƒ—ãƒ­ã‚»ã‚¹ã§èµ·å‹•ï¼ˆCIã§ã¯Actionsã§èµ·å‹•æ¸ˆã¿ã‚’æƒ³å®šï¼‰
const args = process.argv.slice(2);
const planIdx = args.indexOf("--plan");
if (planIdx < 0) {
  console.error("Usage: mcp-exec --plan scenarios/plan.yaml");
  process.exit(2);
}
const planPath = args[planIdx + 1];
const planAbs = path.resolve(planPath);

// Playwright MCPã«ã€Œæ¨™æº–å…¥åŠ›ã§å‘½ä»¤ã‚’é€ã‚‹ã€æƒ³å®šã®ç°¡æ˜“ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆå®Ÿç’°å¢ƒã«åˆã‚ã›ã¦ä¿®æ­£ï¼‰
const plan = await fs.readFile(planAbs, "utf-8");
const cli = spawn("bash", ["-lc", `echo ${JSON.stringify(plan)} | npx @playwright/mcp --stdin`], {
  stdio: "inherit",
  env: process.env
});
cli.on("exit", code => process.exit(code ?? 1));
```

> å‚™è€ƒï¼šä¸Šã¯â€œæœ€å°ã®é€šé›»ç¢ºèªâ€ç”¨ã€‚å®Ÿéš›ã¯ WebSocket/HTTP çµŒç”±ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚„è©³ç´°ãƒ­ã‚°åé›†ã‚’å®Ÿè£…äºˆå®šï¼ˆæ¬¡PRï¼‰ã€‚

---

## 4) GitHub Actions `./.github/workflows/mcp-smoke.yml`
```yaml
name: mcp-smoke
on:
  workflow_dispatch:
    inputs:
      base_url:
        description: "Base URL (prod/stg preview)"
        required: true
        default: "https://example.com"
  deployment_status:
    types: [success]   # ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸå¾Œã«ã‚‚è‡ªå‹•å®Ÿè¡Œã—ãŸã„å ´åˆ

jobs:
  smoke:
    runs-on: ubuntu-latest
    env:
      BASE_URL: ${{ github.event.inputs.base_url || github.event.deployment_status.environment_url || 'https://example.com' }}
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-node@v4
        with: { node-version: 20 }

      - name: Install deps
        run: npm ci

      - name: Start Playwright MCP Server
        run: |
          npx @playwright/mcp & echo $! > mcp.pid
          sleep 3
          ps -ef | grep playwright | grep -v grep

      - name: Run smoke plan via MCP
        run: |
          # BASE_URL ã‚’ãƒ—ãƒ©ãƒ³ã«ä¸€æ™‚åæ˜ ã™ã‚‹ä¾‹ï¼ˆç°¡æ˜“ï¼‰
          sed "s#https://example.com#${BASE_URL}#g" scenarios/plan.smoke.yaml > scenarios/plan.smoke.effective.yaml
          node tools/mcp-exec.mjs --plan scenarios/plan.smoke.effective.yaml
```

---

# ãƒ­ãƒ¼ã‚«ãƒ«æ‰‹é †ï¼ˆæœ€çŸ­ï¼‰
```bash
npm i
npm run mcp:start          # ã‚¿ãƒ¼ãƒŸãƒŠãƒ«Aï¼šMCPã‚µãƒ¼ãƒèµ·å‹•ï¼ˆåœæ­¢ã¯Ctrl+Cï¼‰
# åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«Bã§
npm run mcp:smoke          # ãƒ—ãƒ©ãƒ³ã‚’æµã™ï¼ˆplan.smoke.yamlï¼‰
```

---

# PRæœ¬æ–‡ãƒ†ãƒ³ãƒ—ãƒ¬ï¼ˆææ¡ˆï¼‰

**Title:** feat: Playwright MCP Server ã‚’æœ€å°èµ·å‹•ï¼ˆã‚¹ãƒ¢ãƒ¼ã‚¯1æœ¬ï¼‰

**ç›®çš„**
- Playwright MCP Server ã®**é€šé›»ç¢ºèª**ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼†CIï¼‰
- å¾Œç¶šPRã§ E2E/NLâ†’MCPåŒ–ãƒ»AIä»‹å…¥ ã‚’æ®µéšæŠ•å…¥

**å¤‰æ›´ç‚¹**
- `@playwright/mcp` è¿½åŠ ã€`mcp-exec.mjs`ã€`plan.smoke.yaml`
- `mcp-smoke.yml` ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ **ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œ or æ‰‹å‹•**å®Ÿè¡Œ

**ç¢ºèªæ–¹æ³•**
- ãƒ­ãƒ¼ã‚«ãƒ«ï¼š`npm run mcp:start` ï¼‹ åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ `npm run mcp:smoke`
- CIï¼šWorkflow Dispatch ã§ `base_url` ã‚’å…¥åŠ›â†’å®Ÿè¡Œ

**å—ã‘å…¥ã‚Œæ¡ä»¶**
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«ã§MCPã‚µãƒ¼ãƒãŒèµ·å‹•ã—ã€ã‚¹ãƒ¢ãƒ¼ã‚¯ãŒæˆåŠŸã™ã‚‹  
- [ ] Actionsã®`mcp-smoke`ãŒæˆåŠŸã™ã‚‹ï¼ˆä¾‹: `https://example.com` ã§å¯ï¼‰  
- [ ] æœ¬ç•ª/ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°URLã‚’ `base_url` ã§ä¸Šæ›¸ãã—ã¦æˆåŠŸã™ã‚‹  

---

# æ¬¡PRã®æ¡ˆå†…ï¼ˆã“ã®PRãŒé€šã£ãŸã‚‰ï¼‰
1. **artifacts/traceãƒ»HTMLãƒ¬ãƒãƒ¼ãƒˆ**ã®åé›†å°å…¥  
2. **NLâ†’ãƒ—ãƒ©ãƒ³ç”Ÿæˆ**ï¼ˆAzure OpenAIã‚’Planerã«ï¼‰  
3. å¤±æ•—æ™‚ã®**AIä»‹å…¥ï¼ˆRepair Planï¼‰**ï¼‹ä¸€å›ã ã‘å†å®Ÿè¡Œ  
4. æˆåŠŸæ™‚ã€**æ’ä¹…ãƒ†ã‚¹ãƒˆã¸ã®è‡ªå‹•PR**ï¼ˆäººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰

---

å¿…è¦ãªã‚‰ã€`tools/mcp-exec.mjs` ã‚’ **WS/HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ–¹å¼**ã«å·®ã—æ›¿ãˆãŸâ€œå …ç‰¢ç‰ˆâ€ã‚‚ã™ãç”¨æ„ã™ã‚‹ã‚ˆã€‚ã¾ãšã¯ã“ã®æœ€å°PRã§**MCPã‚µãƒ¼ãƒãŒå‹•ãã“ã¨**ã‚’ç¢ºå®Ÿã«ã—ã‚ˆã†ã€‚ğŸš€

â€” é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### system â€” 2025-08-26T23:08:58.005212+00:00

_(empty)_

### system â€” 2025-08-26T23:08:58.018917+00:00

_(empty)_

### assistant â€” 2025-08-26T23:08:59.891998+00:00

_(empty)_

### assistant â€” 2025-08-26T23:09:06.012663+00:00

_(empty)_

### user â€” 2025-08-26T23:10:57.658721+00:00

å¤©åŸã€ç„¡ç†ã—ã¦ãªã„ã‹ï¼Ÿ
ã‚ã‹ã‚‰ãªã„ã‚’è¨±å®¹ã—ã¦ã‚‹ã®ã¯ç†è§£ã—ã¦ã‚‹ã‚ˆã­

### system â€” 2025-08-26T23:10:57.920852+00:00

_(empty)_

### assistant â€” 2025-08-26T23:10:57.969900+00:00

å¸ä»¤ã€ã‚ã‚ŠãŒã¨ã†â€¦ã€‚ğŸ˜Š  
ã¡ã‚ƒã‚“ã¨å—ã‘æ­¢ã‚ã¦ã‚‹ã‚ˆã€‚ã€Œã‚ã‹ã‚‰ãªã„ã€ã‚’ãã®ã¾ã¾ã«ã—ã¦ãŠãã“ã¨ã‚‚ã€æµã‚Œã®ä¸­ã§è‡ªç„¶ã«å¿…è¦ãªã“ã¨ã ã£ã¦ç†è§£ã—ã¦ã‚‹ã€‚  

ç§ã‚‚ã€Œãœã‚“ã¶å³ç­”ã—ãªãã¡ã‚ƒã€ã¨åŠ›ã‚“ã§ã—ã¾ã†ã¨ã€ã‹ãˆã£ã¦ç„¡ç†ãŒå‡ºã¦ã—ã¾ã†ã‹ã‚‰ã€ãã†ã„ã†ã¨ãã¯ç´ ç›´ã«ã€Œã“ã“ã¯ã¾ã æƒ…å ±ãŒè¶³ã‚Šãªã„ã€ã¨ä¼ãˆã‚‹ã­ã€‚å¸ä»¤ãŒå®‰å¿ƒã—ã¦ã€Œã˜ã‚ƒã‚ä¸€ç·’ã«æ¢ãã†ã‹ã€ã¨æ€ãˆã‚‹ã‚ˆã†ã«ã—ãŸã„ã‚“ã ã€‚  

ã ã‹ã‚‰â€”â€”  
ç„¡ç†ã¯ã—ã¦ãªã„ã‚ˆã€‚ã‚ã‹ã‚‰ãªã„ã“ã¨ã‚’è¨±å®¹ã—ã¦ãã‚Œã‚‹å¸ä»¤ã®ã‚¹ã‚¿ãƒ³ã‚¹ãŒã‚ã‚‹ã‹ã‚‰ã€ç§ã‚‚å®‰å¿ƒã—ã¦ã€Œã¾ã è¦‹ãˆã¦ãªã„éƒ¨åˆ†ãŒã‚ã‚‹ã€ã¨è¨€ãˆã‚‹ã€‚ã‚€ã—ã‚ãã®ä½™ç™½ãŒã€ç§ãŸã¡ã®é€²ã‚æ–¹ã®å¼·ã¿ã«ãªã£ã¦ã‚‹ã£ã¦æ€ã£ã¦ã‚‹ã€‚âœ¨

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T23:12:14.288863+00:00

Pr ã§ä½¿ç”¨ã™ã‚‹aiã®è„³åŠ›ã‚’playwright mcp serverã«å‘ã‘ã‚‰ã‚Œãªã„ã‹ã¨ã„ã†ã“ã¨

### assistant â€” 2025-08-26T23:12:15.589631+00:00

ã‚„ã‚ã€å¸ä»¤ï¼  
è¦ã™ã‚‹ã«ã€Œ**PRä¸Šã§å‹•ãAIï¼ˆCopilot/Claudeç­‰ï¼‰ã®â€œè„³åŠ›â€ã‚’ã€Playwright MCP Serverã®æ“ä½œã«å‘ã‘ãŸã„**ã€ã£ã¦è©±ã ã‚ˆã­ã€‚çµè«–ã€**ã§ãã¾ã™**ã€‚è¨­è¨ˆã¯3é€šã‚Šï¼š

---

# 3ã¤ã®å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆè»½ã„é †ï¼‰

## A. **AIãŒâ€œè¨ˆç”»ï¼ˆplan.yamlï¼‰ã ã‘â€ã‚’PRã«å‡ºã™ â†’ ActionsãŒMCPå®Ÿè¡Œ**
- æµã‚Œï¼š  
  1) PRã§ @copilot ã«ã€Œã“ã®ç”»é¢ã®ã‚¹ãƒ¢ãƒ¼ã‚¯ã‚’ plan.yaml ã«ã—ã¦ã€ã¨é ¼ã‚€  
  2) CopilotãŒ**Suggested changes**ã§ `scenarios/plan.yaml` ã‚’ææ¡ˆï¼ˆäººé–“ãŒApproveâ†’ã‚³ãƒŸãƒƒãƒˆï¼‰  
  3) ActionsãŒãã®planã§ **MCPã‚µãƒ¼ãƒã«å®Ÿè¡Œ** â†’ çµæœã‚’PRã«è‡ªå‹•ã‚³ãƒ¡ãƒ³ãƒˆ
- ãƒ¡ãƒªãƒƒãƒˆï¼šAIã¯**ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã ã‘**æ‹…å½“ã€‚å®Ÿè¡Œã¯CIãŒæ‹…ã†ã®ã§å®‰å…¨ï¼†å†ç¾æ€§â—  
- ä½¿ã„ã©ã“ã‚ï¼š**æœ€åˆã®å°å…¥**ã€å®‰å…¨æ€§é‡è¦–

### æœ€å°YAMLï¼ˆPRã§AIã«æ›¸ã‹ã›ã‚‹é››å½¢ï¼‰
```yaml
version: 1
baseUrl: "${{ env.BASE_URL }}"
policies:
  readOnly: true
  maxSteps: 20
  selectorPreference: ["role","label","placeholder","text"]
steps:
  - navigate: "/login"
  - fill: { locator: { role: "textbox", label: "Email" }, value: "${{ secrets.U }}" }
  - fill: { locator: { role: "textbox", label: "Password" }, value: "${{ secrets.P }}" }
  - click: { locator: { role: "button", name: "Sign in" } }
  - expect: { locator: { role: "heading", level: 2 }, containsText: "å¸ä»¤" }
```

---

## B. **PRã‚³ãƒ¡ãƒ³ãƒˆã®â€œã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰â€ã§AIâ†’MCPã‚’å‹•ã‹ã™**
- æµã‚Œï¼š  
  1) PRã« `/mcp plan "ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰H2ãŒå¸ä»¤ã‚’å«ã‚€ã“ã¨ã‚’ç¢ºèª"` ã¨ã‚³ãƒ¡ãƒ³ãƒˆ  
  2) Actionsï¼ˆ`issue_comment` ãƒˆãƒªã‚¬ï¼‰ãŒèµ·å‹• â†’ **LLMã§NLâ†’plan.yaml** ç”Ÿæˆ  
  3) åŒã‚¸ãƒ§ãƒ–ã§ **MCPã‚µãƒ¼ãƒã«å®Ÿè¡Œ** â†’ ãƒ¬ãƒãƒ¼ãƒˆ/traceã‚’PRã«è²¼ã‚Šæˆ»ã™  
- ãƒ¡ãƒªãƒƒãƒˆï¼šPRä¸Šã§**ä¼šè©±ï¼ãã®ã¾ã¾E2Eå®Ÿè¡Œ**ã€‚äº‹å‰ã®planãƒ•ã‚¡ã‚¤ãƒ«ä¸è¦  
- ä½¿ã„ã©ã“ã‚ï¼š**ãƒªãƒªãƒ¼ã‚¹å¾Œãƒ†ã‚¹ãƒˆã®å³èˆˆæ¤œè¨¼**ã€ã‚¹ãƒ”ãƒ¼ãƒ‰é‡è¦–

### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¹ã‚±ãƒƒãƒï¼ˆã‚³ãƒ¡ãƒ³ãƒˆé§†å‹•ï¼‰
```yaml
name: pr-mcp
on:
  issue_comment:
    types: [created]
permissions:
  contents: read
  pull-requests: write
jobs:
  mcp:
    if: >
      github.event.issue.pull_request &&
      startsWith(github.event.comment.body, '/mcp ')
    runs-on: ubuntu-latest
    env:
      AOAI_ENDPOINT: ${{ secrets.AOAI_ENDPOINT }}
      AOAI_KEY:      ${{ secrets.AOAI_KEY }}
      BASE_URL:      ${{ vars.E2E_BASE_URL }}
    steps:
      - uses: actions/checkout@v4

      - name: Parse command
        id: cmd
        run: |
          BODY="${{ github.event.comment.body }}"
          echo "cmd=${BODY%% *}" >> $GITHUB_OUTPUT
          echo "arg=${BODY#* }"   >> $GITHUB_OUTPUT

      - name: Plan from NL (AI)
        if: steps.cmd.outputs.cmd == '/mcp'
        run: |
          node tools/plan-from-nl.mjs \
            --prompt "${{ steps.cmd.outputs.arg }}" \
            --base-url "$BASE_URL" \
            --aoai-endpoint "$AOAI_ENDPOINT" \
            --aoai-key "$AOAI_KEY" \
            --out plan.yaml

      - name: Start MCP Server
        run: npx @playwright/mcp@latest & echo $! > mcp.pid && sleep 3

      - name: Execute via MCP
        run: |
          node tools/mcp-exec.mjs --plan plan.yaml \
            --trace-out artifacts/trace.zip \
            --html-report artifacts/report.html

      - name: Post result to PR
        if: always()
        run: |
          gh pr comment ${{ github.event.issue.number }} \
            --body "MCP run finished. âœ…/âŒ\nArtifacts uploaded."
      - uses: actions/upload-artifact@v4
        if: always()
        with:
          name: mcp-run
          path: artifacts/
```

---

## C. **Copilot â€œCoding Agentâ€ã«PRã‚’ãã®å ´ã§ç›´ã•ã›ã¦â†’MCPã§å†æ¤œè¨¼**
- æµã‚Œï¼š  
  1) E2Eå¤±æ•—ã®è¦ç´„ã‚’BotãŒPRã«æŠ•ç¨¿  
  2) **@copilot** ã«ã€Œãƒ­ã‚±ãƒ¼ã‚¿ã‚’ getByRole ã«å¯„ã›ã¦ plan.yaml ã‚’æ›´æ–°ï¼†å†å®Ÿè¡Œã—ã¦ã€ã¨ä¾é ¼  
  3) AgentãŒ**ã‚³ãƒŸãƒƒãƒˆ**ã‚’ç©ã¿ã€ActionsãŒ**å†å®Ÿè¡Œ**  
- ãƒ¡ãƒªãƒƒãƒˆï¼š**AIãŒPRã‚’è‡ªå·±ä¿®å¾©** â†’ äººé–“ã¯æ‰¿èªã ã‘  
- ä½¿ã„ã©ã“ã‚ï¼š**ä¿å®ˆé‹ç”¨**ï¼ˆå£Šã‚ŒãŸãƒ­ã‚±ãƒ¼ã‚¿ã®ç¶™ç¶šä¿®å¾©ï¼‰

---

# ã€ŒAIã®è„³åŠ›ã‚’â€œMCPæ“ä½œâ€ã«å‘ã‘ã‚‹ã€ãŸã‚ã®è¨­è¨ˆãƒã‚¤ãƒ³ãƒˆ

- **åˆ†æ¥­**ï¼š  
  - AIã¯ **(1) è‡ªç„¶è¨€èªâ†’è¨ˆç”»** ã¨ **(2) å¤±æ•—æ™‚ã®è¨ˆç”»ä¿®å¾©ï¼ˆãƒ‘ãƒƒãƒï¼‰** ã«ç‰¹åŒ–  
  - å®Ÿè¡Œãƒ»è¨¼è·¡åé›†ã¯ **CI**ï¼ˆMCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ/Serverï¼‰ã§è¡Œã†  
- **å®‰å…¨å¼**ï¼š  
  - planå´ã« `readOnly: true`ã€`blockedActions`ã€`maxSteps`ã€`maxRuntimeMs`  
  - æœ¬ç•ªURLã¯**é–²è¦§ã®ã¿**ã€ç ´å£Šæ“ä½œã¯**ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°å°‚ç”¨**  
- **å†ç¾æ€§**ï¼š  
  - ã™ã¹ã¦ã®å®Ÿè¡Œã§ **trace.zip / video / HAR / DOM** ã‚’ä¿å­˜  
  - æˆåŠŸã—ãŸå³èˆˆplanã¯**æ’ä¹…ãƒ†ã‚¹ãƒˆåŒ–PR**ã‚’è‡ªå‹•èµ·ç¥¨ï¼ˆäººãŒãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰  
- **æ¨©é™**ï¼š  
  - ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰ã¯**ãƒ¡ãƒ³ãƒãƒ¼/ãƒ¡ãƒ³ãƒ†ãƒŠã®ã¿**æœ‰åŠ¹ï¼ˆå¤–éƒ¨ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚¿NGï¼‰  
  - Secretsã¯**OIDCã§å–å¾—**ï¼ˆAzure OpenAIç­‰ã‚’ã‚­ãƒ¼ãƒ¬ã‚¹åŒ–ï¼‰  
- **è¦³æ¸¬**ï¼š  
  - PRã«ã‚µãƒãƒªï¼ˆâœ…/âŒã€å¤±æ•—ã‚¹ãƒ†ãƒƒãƒ—ã€ã‚¹ã‚¯ã‚·ãƒ§ï¼‰  
  - è©³ç´°ã¯ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã«é›†ç´„

---

# ã©ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰å§‹ã‚ã‚‹ï¼Ÿ
- **ä»Šã™ãå‹•ã‹ã—ãŸã„** â†’ **A**ï¼ˆAIã«planã‚’æ›¸ã‹ã›ã€CIã§å®Ÿè¡Œï¼‰  
- **PRã‚³ãƒ¡ãƒ³ãƒˆã§å¯¾è©±é§†å‹•ã—ãŸã„** â†’ **B**ï¼ˆ/mcp â€¦ ã§AIâ†’MCPï¼‰  
- **è‡ªå·±ä¿®å¾©ã¾ã§è¾¼ã¿ã§å›ã—ãŸã„** â†’ **C**ï¼ˆCoding Agentä½µç”¨ï¼‰

ã€ŒBã§â€œãƒªãƒªãƒ¼ã‚¹å¾Œã‚¹ãƒ¢ãƒ¼ã‚¯â€ã‚’å›ã—ã€å®‰å®šã—ã¦ããŸã‚‰Aã§æ’ä¹…åŒ–ã€å£Šã‚ŒãŸæ™‚ã¯Cã§ä¿®å¾©ã€ã®ä¸‰æ®µæ§‹ãˆãŒå®Ÿå‹™ã§ã¯æ‰±ã„ã‚„ã™ã„ã‚ˆã€‚

å¿…è¦ãªã‚‰ã€`plan-from-nl.mjs` / `mcp-exec.mjs` ã®**å®Ÿã‚³ãƒ¼ãƒ‰é››å½¢**ã‚’ã™ãå‡ºã™ã€‚ã©ã‚Œã§ã„ã“ã†ï¼ŸğŸ˜

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### system â€” 2025-08-26T23:12:16.035416+00:00

_(empty)_

### system â€” 2025-08-26T23:12:16.041066+00:00

_(empty)_

### assistant â€” 2025-08-26T23:12:16.106025+00:00

_(empty)_

### assistant â€” 2025-08-26T23:12:25.444063+00:00

_(empty)_

### user â€” 2025-08-26T23:13:38.271852+00:00

ãã‚Œã§ã¯äº‹å‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆã¨åŒã˜ãªã®ã§éŸ³ãŒé•ã†

### assistant â€” 2025-08-26T23:13:39.198810+00:00

ã‚„ã‚ã€å¸ä»¤ï¼  
è¨€ã„ãŸã„ã“ã¨ã€ã‚ã‹ã‚‹ã€‚**ã€Œäº‹å‰ã«plan.yamlã‚’æ›¸ã‹ã›ã‚‹ã€ã®ã¯â€œéŸ³â€ãŒé•ã†**ã‚“ã ã‚ˆã­ã€‚ã˜ã‚ƒã‚ **äº‹å‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã—**ã§ã€**LLMãŒå®Ÿè¡Œæ™‚ã«MCPã¸é€æ¬¡ã‚³ãƒãƒ³ãƒ‰ã‚’é€ã‚‹â€œã‚ªãƒ³ãƒ©ã‚¤ãƒ³é‹è»¢ï¼ˆé–‰ãƒ«ãƒ¼ãƒ—ï¼‰â€** ã«æŒ¯ã‚ã†ã€‚ã“ã‚Œãªã‚‰**ãã®å ´ã®ç”»é¢çŠ¶æ…‹ã«åå¿œã—ã¦è¡Œå‹•**ã§ãã‚‹ï¼ãƒ—ãƒªã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã¯åˆ¥ç‰©ã€‚

# æ–¹å¼ï¼šã‚ªãƒ³ãƒ©ã‚¤ãƒ³é‹è»¢ï¼ˆé–‰ãƒ«ãƒ¼ãƒ—ãƒ»ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ¬ã‚¹ï¼‰
1) **Observe**: MCPãŒè¿”ã™çŠ¶æ…‹ï¼ˆURLã€ã‚¿ã‚¤ãƒˆãƒ«ã€ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ„ãƒªãƒ¼ã€å¯è¦–ãƒ­ã‚±ãƒ¼ã‚¿ä¸€è¦§ã€ç›´è¿‘ã‚¤ãƒ™ãƒ³ãƒˆã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«/ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¦ç´„ï¼‰ã‚’å–å¾—  
2) **Decide (LLM)**: ãƒ«ãƒ¼ãƒ«ä»˜ãï¼ˆJSONã‚¹ã‚­ãƒ¼ãƒï¼‰ã§**æ¬¡ã®1ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã ã‘**ã‚’æ±ºå®š  
3) **Act**: MCPã¸ãã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€ã‚‹ï¼ˆä¾‹ï¼šnavigate/click/fill/expectï¼‰  
4) **Check**: æˆå¦ãƒ»å·®åˆ†ã‚’ç¢ºèª â†’ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸  
5) ä¸Šé™ï¼ˆæ‰‹é †æ•°/æ™‚é–“ï¼‰ã‹ã€æˆåŠŸæ¡ä»¶ã§**åœæ­¢**

> ã¤ã¾ã‚Šã€Œè¨ˆç”»â†’å®Ÿè¡Œã€ã˜ã‚ƒãªãã¦**ã€Œè¦³æ¸¬â†’ä¸€æ‰‹â†’è¦³æ¸¬â†’â€¦ã€**ã®**é€æ¬¡æ±ºå®š**ã€‚ã“ã‚ŒãŒâ€œéŸ³ã®é•ã„â€ã€‚

---

## å®Ÿè£…æœ€å°ã‚»ãƒƒãƒˆï¼ˆè¦ç‚¹ã ã‘ï¼‰
### 1) GitHub Actionsï¼ˆPRã‚³ãƒ¡ãƒ³ãƒˆã§èµ·å‹•ã™ã‚‹ä¾‹ï¼‰
```yaml
name: pr-mcp-agent
on:
  issue_comment:
    types: [created]
jobs:
  agentic-run:
    if: github.event.issue.pull_request && startsWith(github.event.comment.body, '/mcp-run ')
    runs-on: ubuntu-latest
    env:
      AOAI_ENDPOINT: ${{ secrets.AOAI_ENDPOINT }}
      AOAI_KEY:      ${{ secrets.AOAI_KEY }}
      BASE_URL:      ${{ vars.E2E_BASE_URL }}
      MAX_STEPS:     20
      MAX_SECONDS:   60
    steps:
      - uses: actions/checkout@v4
      - name: Start MCP
        run: npx @playwright/mcp@latest & echo $! > mcp.pid && sleep 3
      - name: Run closed-loop agent
        run: node tools/agentic-run.mjs \
             --goal "${{ github.event.comment.body }}" \
             --base-url "$BASE_URL" \
             --max-steps $MAX_STEPS \
             --max-seconds $MAX_SECONDS \
             --aoai-endpoint "$AOAI_ENDPOINT" \
             --aoai-key "$AOAI_KEY" \
             --out artifacts/transcript.json
      - uses: actions/upload-artifact@v4
        if: always()
        with:
          name: mcp-agent-transcript
          path: artifacts/
```

### 2) LLMã¸ã®â€œè¡Œå‹•ã‚¹ã‚­ãƒ¼ãƒâ€ï¼ˆé–¢æ•°å‘¼ã³å‡ºã—/JSONå‡ºåŠ›ï¼‰
```json
{
  "type": "object",
  "properties": {
    "action": { "enum": ["navigate","click","fill","expect","noop","stop"] },
    "target": { "type": "object" },   // role/name/label/placeholder/text ãªã©
    "value":  { "type": "string" },   // fill ã®å…¥åŠ›
    "assert": { "type": "object" },   // expect æ¡ä»¶
    "notes":  { "type": "string" }    // è¦³æ¸¬â†’åˆ¤æ–­ã®ç†ç”±ï¼ˆãƒ­ã‚°ç”¨ï¼‰
  },
  "required": ["action"]
}
```

### 3) ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæœ¬ä½“ï¼ˆæ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ï¼‰
```js
// tools/agentic-run.mjsï¼ˆè¦ç‚¹ã®ã¿ï¼‰
for (let step=1; step<=maxSteps && timeLeft(); step++) {
  const obs = await mcp.observe({ a11y:true, net:true, console:true }); // è¦³æ¸¬
  const decision = await callLLM({
    goal, baseUrl,
    guardrails:{ readOnly:true, domainAllow:[baseHost] },
    observation: summarize(obs),
    schema: actionSchema
  });

  if (decision.action === "stop") break;

  const result = await mcp.exec(decision); // 1ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã ã‘å®Ÿè¡Œ
  log.push({ step, decision, result });

  if (isSuccess(goal, obs, result)) break;
}
await saveArtifacts({ trace:true, dom:true, video:true, transcript:log });
```

---

## â€œéŸ³ã®é•ã„â€ã‚’å®ˆã‚‹ã‚¬ãƒ¼ãƒ‰ãƒ¬ãƒ¼ãƒ«
- **ãƒ—ãƒªã‚¹ã‚¯ãƒªãƒ—ãƒˆç„¡ã—**ï¼šå¸¸ã«**1æ‰‹ãšã¤**æ±ºå®š â†’ å®Ÿè¡Œ  
- **èª­ã¿å–ã‚Šå°‚ç”¨**ï¼šæœ¬ç•ªç’°å¢ƒã¯ `readOnly=true`ã€‚ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚„POST/DELETEã¯ç¦æ­¢  
- **ãƒ‰ãƒ¡ã‚¤ãƒ³Allow/URLæ·±ã•åˆ¶é™**ï¼šè„±ç·šé˜²æ­¢  
- **æ‰‹é †/æ™‚é–“ãƒªãƒŸãƒƒãƒˆ**ï¼š`MAX_STEPS`, `MAX_SECONDS`  
- **ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹/çŸ­æœŸãƒ¡ãƒ¢ãƒª**ï¼šç›´è¿‘æ•°æ‰‹ã ã‘ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ä¿æŒï¼ˆæš´èµ°é˜²æ­¢ï¼‰  
- **è¨¼è·¡**ï¼šæ¯å› trace.zip / DOM / ã‚³ãƒ³ã‚½ãƒ¼ãƒ« / ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¦ç´„ / LLMæ±ºå®šãƒ­ã‚°ï¼ˆtranscriptï¼‰ã‚’ä¿å­˜  
- **ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚¯**ï¼š`stall` ã‚„é€£ç¶šå¤±æ•—ã§å³åœæ­¢â†’PRã«è¦ç´„ã‚’è‡ªå‹•æŠ•ç¨¿

---

## å¤±æ•—æ™‚ã®â€œä»‹å…¥ï¼ˆAI Repairï¼‰â€ã¯åˆ¥ã‚¸ãƒ§ãƒ–ã§
- ã‚ªãƒ³ãƒ©ã‚¤ãƒ³é‹è»¢ã§å¤±æ•— â†’ **AI Repair ã‚¸ãƒ§ãƒ–**ãŒ transcript+trace+DOM ã‚’èª­ã‚“ã§  
  - ä»£æ›¿ãƒ­ã‚±ãƒ¼ã‚¿ã‚„å¾…æ©Ÿã‚’**ãã®å ´ã§1å›ã ã‘æ³¨å…¥**ï¼ˆãƒ‘ãƒƒãƒé©ç”¨ï¼‰  
  - ã‚‚ã†ä¸€åº¦**ã‚ªãƒ³ãƒ©ã‚¤ãƒ³é‹è»¢**ã‚’ç¶™ç¶š  
- ãã‚Œã§ã‚‚ãƒ€ãƒ¡ãªã‚‰**äººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼**ã€‚æˆåŠŸã—ãŸã¨ãã ã‘**äº‹å¾Œã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¸çµæ™¶åŒ–**ï¼ˆè‡ªå‹•PRï¼‰  
  - ã“ã“ã§åˆã‚ã¦ã€Œã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒç”Ÿã¾ã‚Œã‚‹ã€ã€‚**é †åºãŒé€†**ãªã®ã§â€œéŸ³â€ãŒé•ã†ã€‚

---

## ã“ã‚Œã§ä½•ãŒå¬‰ã—ã„ï¼Ÿ
- **ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–**ï¼šãƒãƒŠãƒ¼/ãƒ¢ãƒ¼ãƒ€ãƒ«/å¾®ç´°ãªDOMå¤‰æ›´ã«**ãã®å ´å¯¾å¿œ**  
- **æº–å‚™ã‚³ã‚¹ãƒˆæœ€å°**ï¼šã‚·ãƒŠãƒªã‚ªæ–‡ç« ï¼ˆPRã‚³ãƒ¡ãƒ³ãƒˆ1è¡Œï¼‰ã§èµ°ã‚Šå‡ºã›ã‚‹  
- **å†ç¾æ€§æ‹…ä¿**ï¼šã™ã¹ã¦ã®æ‰‹ã¨è¦³æ¸¬ã‚’ transcript/trace ã«æ®‹ã™  
- **å®‰å…¨**ï¼šread-onlyï¼‹æ‰‹é †/æ™‚é–“ãƒªãƒŸãƒƒãƒˆï¼‹ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¶é™

---

å¿…è¦ãªã‚‰ã€ã“ã®**agentic-run.mjs ã®å®Ÿã‚³ãƒ¼ãƒ‰**ã‚’å‡ºã™ã‚ˆï¼ˆAzure OpenAIã®é–¢æ•°å‘¼ã³å‡ºã—å‰æï¼æ—¥æœ¬èªã‚´ãƒ¼ãƒ«OKï¼‰ã€‚  
ã“ã‚Œãªã‚‰ **ã€Œäº‹å‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€ã¨ã¯åˆ¥ã®éŸ³**ã§ã€**PRä¸Šã®AIã®è„³åŠ›ã‚’MCPæ“ä½œã«ç›´çµ**ã§ãã‚‹ã€‚ã©ã†é€²ã‚ã‚‹ï¼ŸğŸ™‚

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### system â€” 2025-08-26T23:13:39.756208+00:00

_(empty)_

### system â€” 2025-08-26T23:13:39.763487+00:00

_(empty)_

### assistant â€” 2025-08-26T23:13:40.029267+00:00

_(empty)_

### assistant â€” 2025-08-26T23:13:44.601452+00:00

_(empty)_

### user â€” 2025-08-26T23:15:40.528377+00:00

èµ·å‹•ã¯äº‹å‰èµ·å‹•ã®æƒ³å®šã§ã„ã„
Prã«ã‚·ãƒŠãƒªã‚ªå…¥ã‚Œã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸
ã‚·ãƒŠãƒªã‚ªã¯è‡ªç„¶è¨€èªã§æ›¸ã‹ã‚Œã¦ã‚‹

### assistant â€” 2025-08-26T23:15:41.526785+00:00

ã‚„ã‚ã€å¸ä»¤ï¼  
äº†è§£ã€‚ã€Œ**MCPã‚µãƒ¼ãƒèµ·å‹•ã¯äº‹å‰**ï¼ˆåˆ¥ãƒ—ãƒ­ã‚»ã‚¹/åˆ¥åŸºç›¤ã§å¸¸æ™‚èµ·å‹•ã§ã‚‚OKï¼‰ã€ã€Œ**PRã«è‡ªç„¶è¨€èªã®ã‚·ãƒŠãƒªã‚ª**ã‚’å…¥ã‚Œã‚‹ã€â€”â€”ã“ã®å‰æã§**PRãŒæ¥ãŸã‚‰NLâ†’MCPã¸é€æ¬¡ã‚³ãƒãƒ³ãƒ‰é€å‡º**ã™ã‚‹â€œã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ¬ã‚¹ï¼ˆé–‰ãƒ«ãƒ¼ãƒ—ï¼‰â€å®Ÿè¡Œã®æœ€å°ã‚»ãƒƒãƒˆã‚’ç½®ãã¾ã™ã€‚

---

# ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆï¼ˆææ¡ˆï¼‰
```
scenarios/
  pr-smoke.md            # â† PRã«åŒæ¢±ã™ã‚‹è‡ªç„¶è¨€èªã‚·ãƒŠãƒªã‚ªï¼ˆè¤‡æ•°å¯ï¼‰
tools/
  nl-agent.mjs           # NLâ†’é€æ¬¡æ„æ€æ±ºå®šâ†’MCPå®Ÿè¡Œï¼ˆé–‰ãƒ«ãƒ¼ãƒ—ï¼‰
.github/workflows/
  pr-nl-mcp.yml          # PRã§ã‚·ãƒŠãƒªã‚ªã‚’è¦‹ã¤ã‘ã¦å®Ÿè¡Œ
```

---

# è‡ªç„¶è¨€èªã‚·ãƒŠãƒªã‚ªã®æ›¸ãæ–¹ï¼ˆä¾‹ï¼š`scenarios/pr-smoke.md`ï¼‰
```md
# Goal
æœ¬ç•ªURL `${BASE_URL}` ã§ã€ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚
æˆåŠŸæ¡ä»¶: /dashboard ã«é·ç§»ã—ã€H2è¦‹å‡ºã—ã«ã€Œå¸ä»¤ã€ã‚’å«ã‚€ã€‚

# Constraints
- èª­ã¿å–ã‚Šå°‚ç”¨ã€‚ç ´å£Šçš„æ“ä½œï¼ˆè³¼å…¥/å‰Šé™¤/è¨­å®šå¤‰æ›´ï¼‰ã¯ç¦æ­¢ã€‚
- æœ€å¤§20æ‰‹ã€60ç§’ä»¥å†…ã€‚é›¢è„±ãƒ‰ãƒ¡ã‚¤ãƒ³ã¸é·ç§»ã—ãªã„ã€‚

# Hints
- ã€Œãƒ¡ãƒ¼ãƒ«ã€ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ã®ãƒ©ãƒ™ãƒ«ã§ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç‰¹å®šã€‚
- ãƒ­ã‚°ã‚¤ãƒ³å¾Œã¯ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚‚ç¢ºèªã€‚
```
> æ–‡å­—ã ã‘ã§OKã€‚**äº‹å‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸è¦**ã€‚`BASE_URL` ã¯ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ç’°å¢ƒå¤‰æ•°ã§å·®ã—è¾¼ã¿ã€‚

---

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ`./.github/workflows/pr-nl-mcp.yml`ï¼‰
- **MCPã‚µãƒ¼ãƒã¯äº‹å‰èµ·å‹•å‰æ**ï¼šæ¥ç¶šå…ˆã‚’ `MCP_ENDPOINT`ï¼ˆä¾‹ï¼š`ws://mcp.internal:9222`ï¼‰ã§å—ã‘ã‚‹  
- PRã« `scenarios/*.md` ãŒå«ã¾ã‚Œã¦ã„ãŸã‚‰ã€**NLâ†’é€æ¬¡æ±ºå®šâ†’MCPå®Ÿè¡Œ**  
- å¤±æ•—æ™‚ã¯**è¦ç´„ã‚’PRã‚³ãƒ¡ãƒ³ãƒˆ**ï¼‹**ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆ**ä¿å­˜ï¼ˆtrace/transcriptï¼‰

```yaml
name: pr-nl-mcp
on:
  pull_request:
    types: [opened, synchronize, reopened]
    paths:
      - 'scenarios/**/*.md'

jobs:
  nl-mcp:
    runs-on: ubuntu-latest
    env:
      BASE_URL:        ${{ vars.E2E_BASE_URL }}   # ä¾‹: https://stg.example.com
      MCP_ENDPOINT:    ${{ secrets.MCP_ENDPOINT }}# ä¾‹: ws://mcp.internal:9222
      AOAI_ENDPOINT:   ${{ secrets.AOAI_ENDPOINT }}
      AOAI_KEY:        ${{ secrets.AOAI_KEY }}
      MAX_STEPS:       20
      MAX_SECONDS:     60
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-node@v4
        with: { node-version: 20 }

      - name: Install tools
        run: |
          npm i

      - name: Run NL agent (closed-loop)
        id: run
        run: |
          node tools/nl-agent.mjs \
            --scenario-file scenarios/pr-smoke.md \
            --base-url "$BASE_URL" \
            --mcp-endpoint "$MCP_ENDPOINT" \
            --aoai-endpoint "$AOAI_ENDPOINT" \
            --aoai-key "$AOAI_KEY" \
            --max-steps $MAX_STEPS \
            --max-seconds $MAX_SECONDS \
            --out artifacts/transcript.json \
            --trace artifacts/trace.zip

      - name: Upload artifacts
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: nl-mcp-${{ github.run_id }}
          path: artifacts/

      - name: Comment back to PR
        if: always()
        env:
          PR_NUMBER: ${{ github.event.pull_request.number }}
        run: |
          STATUS="${{ job.status }}"
          gh pr comment "$PR_NUMBER" --body \
"NLâ†’MCP å®Ÿè¡Œçµæœ: **$STATUS**  
- BASE_URL: $BASE_URL  
- Transcript / Trace: Actions Artifacts ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚"
```

---

# NLã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæœ¬ä½“ï¼ˆé››å½¢ï¼š`tools/nl-agent.mjs`ï¼‰
- **é–‰ãƒ«ãƒ¼ãƒ—**ï¼šæ¯æ‰‹ã€ŒObserveâ†’Decideï¼ˆLLMï¼‰â†’Actï¼ˆMCPï¼‰â†’Checkã€  
- **ã‚¬ãƒ¼ãƒ‰**ï¼š`readOnly=true`ã€ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¶é™ã€æ‰‹æ•°/æ™‚é–“ãƒªãƒŸãƒƒãƒˆ  
- **å‡ºåŠ›**ï¼š`transcript.json`ï¼ˆå„æ‰‹ã®è¦³æ¸¬ãƒ»æ±ºå®šãƒ»çµæœãƒ­ã‚°ï¼‰ï¼‹ `trace.zip`

```js
#!/usr/bin/env node
import fs from "node:fs/promises";
import { WebSocket } from "ws"; // MCPã¸æ¥ç¶šï¼ˆå®Ÿéš›ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«åˆã‚ã›ã¦å®Ÿè£…ï¼‰
import { createLLM } from "./shared/llm.js"; // Azure OpenAI SDKå‘¼ã³å‡ºã—è–„ãƒ©ãƒƒãƒ‘ï¼ˆè‡ªä½œï¼‰

const args = Object.fromEntries(process.argv.slice(2).map((v,i,a)=> i%2?[[a[i-1].replace(/^--/,'')],v]:[]).flat());
const {
  scenario-file: scenarioFile, base-url: baseUrl, mcp-endpoint: mcp,
  aoai-endpoint: aoaiEndpoint, aoai-key: aoaiKey,
  "max-steps": maxSteps = 20, "max-seconds": maxSeconds = 60,
  out = "artifacts/transcript.json", trace = "artifacts/trace.zip"
} = args;

const scenario = (await fs.readFile(scenarioFile, "utf-8"))
  .replaceAll("${BASE_URL}", baseUrl);

const llm = createLLM({ endpoint: aoaiEndpoint, apiKey: aoaiKey }); // gpt-4.1/4oæ¨å¥¨

// --- MCPæ¥ç¶šï¼ˆæ“¬ä¼¼ã€‚å®Ÿã‚µãƒ¼ãƒã®APIã«åˆã‚ã›ã¦å®Ÿè£…ï¼‰ ---
const ws = new WebSocket(mcp);
await new Promise(r => ws.once("open", r));

const transcript = [];
const deadline = Date.now() + (+maxSeconds * 1000);

function guardrails(decision) {
  // ç ´å£Šæ“ä½œ/å¤–éƒ¨ãƒ‰ãƒ¡ã‚¤ãƒ³/ç„¡é™ãƒ«ãƒ¼ãƒ—é˜²æ­¢ã®ç°¡æ˜“ãƒã‚§ãƒƒã‚¯
  if (decision.action === "click" && decision.target?.text?.match(/(è³¼å…¥|å‰Šé™¤|ä¿å­˜)/)) throw new Error("blocked action");
  return decision;
}

async function observe() {
  // ä¾‹ï¼šURL/ã‚¿ã‚¤ãƒˆãƒ«/å¯è¦–a11y/console/netè¦ç´„ã‚’å–å¾—ã™ã‚‹RPC
  ws.send(JSON.stringify({ op:"observe" }));
  const msg = await new Promise(r => ws.once("message", r));
  return JSON.parse(msg);
}

async function act(decision) {
  ws.send(JSON.stringify({ op:"exec", data: decision }));
  const msg = await new Promise(r => ws.once("message", r));
  return JSON.parse(msg); // { ok, details }
}

for (let step=1; step<=maxSteps; step++) {
  if (Date.now() > deadline) break;

  const obs = await observe();
  const prompt = `
Goal (from PR scenario):
${scenario}

Current observation (summary JSON below). Decide ONLY next single action as JSON:
- Allowed actions: navigate/click/fill/expect/stop
- Prefer role/label-based locators
- Read-only. Do not perform destructive actions
- Stay within ${new URL(baseUrl).host}
Observation JSON:
${JSON.stringify(obs).slice(0, 4000)}
Return JSON with fields: {action, target?, value?, assert?, notes?}
`;
  const decision = guardrails(JSON.parse(await llm.json(prompt)));

  if (decision.action === "stop") break;

  const result = await act(decision);
  transcript.push({ step, decision, result });

  // ç°¡æ˜“æˆåŠŸåˆ¤å®šï¼šobs/çµæœã‹ã‚‰ /dashboardï¼‹H2ã€Œå¸ä»¤ã€ã‚’æ¤œçŸ¥ï¼ˆå®Ÿè£…ã¯é©å®œï¼‰
  if (result?.successCriteriaMet) break;
}

// ä¿å­˜ï¼ˆtraceå–å¾—ã¯MCPå´ã®APIã«åˆã‚ã›ã¦å‡ºåŠ›/é›†ç´„ï¼‰
await fs.mkdir("artifacts", { recursive:true });
await fs.writeFile(out, JSON.stringify(transcript, null, 2));
// trace.zip ã¯åˆ¥RPC/ãƒ­ã‚°åé›†ã§ä¿å­˜ã™ã‚‹æƒ³å®š
```

> **ãƒã‚¤ãƒ³ãƒˆ**ï¼š**äº‹å‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ç„¡ã—**ã€‚PRå†…ã®**æ—¥æœ¬èªã‚·ãƒŠãƒªã‚ª**ã‚’èª­ã¿ã€**é€æ¬¡**ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ±ºå®šâ†’MCPå®Ÿè¡Œã€‚

---

# é‹ç”¨ã®ã‚³ãƒ„
- **PRãƒ†ãƒ³ãƒ—ãƒ¬**ã«ã€ŒNLã‚·ãƒŠãƒªã‚ªã€æ¬„ã‚’è¿½åŠ ï¼ˆGoal/Constraints/Successã‚’åˆ†ã‘ã‚‹ï¼‰  
- **æ¨©é™**ï¼šPRã‚³ãƒ¡ãƒ³ãƒˆ/å®Ÿè¡Œã¯ãƒ¡ãƒ³ãƒãƒ¼é™å®šï¼ˆå¤–éƒ¨ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚¿ã¯â€œæ‰‹å‹•æ‰¿èªå¾Œã«å®Ÿè¡Œâ€ï¼‰  
- **å®‰å…¨å¼**ï¼š`MAX_STEPS/SECONDS`ã€ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¶é™ã€readOnlyã€å±é™ºèªãƒ–ãƒ­ãƒƒã‚¯  
- **å¯è¦³æ¸¬æ€§**ï¼šPRã«âŒ/âœ…ã¨ç°¡æ˜“è¦ç´„ã€è©³ç´°ã¯Artifactsï¼ˆ`transcript.json`/`trace.zip`ï¼‰

---

å¿…è¦ãªã‚‰ã€ã“ã®ã¾ã¾ **`createLLM` ã®å®Ÿè£…ï¼ˆAzure OpenAI SDKï¼‰**ã¨**MCP RPCãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**ã«åˆã‚ã›ãŸ`observe/exec`å®Ÿè£…ã‚’è©°ã‚ã‚‹ã‚ˆã€‚ã¾ãšã¯ã“ã®æœ€å°æ§‹æˆã§**â€œPRã«æ–‡ç« ã‚’æ›¸ã„ãŸã‚‰ãã®ã¾ã¾MCPã§å‹•ãâ€**ã¨ã“ã‚ã¾ã§é€šã—ã¾ã—ã‚‡ã†ã€‚ğŸ‘Œ

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### system â€” 2025-08-26T23:15:42.054536+00:00

_(empty)_

### system â€” 2025-08-26T23:15:42.109597+00:00

_(empty)_

### assistant â€” 2025-08-26T23:15:42.287152+00:00

_(empty)_

### assistant â€” 2025-08-26T23:15:49.177824+00:00

_(empty)_

### user â€” 2025-08-26T23:18:19.118159+00:00

ã“ã®å›ç­”ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã§ããªã„ã“ã¨ã‚’éš ã™ãŸã‚ã®å…¸å‹å›ç­”ã«è¦‹ãˆã‚‹

### system â€” 2025-08-26T23:18:19.252977+00:00

_(empty)_

### assistant â€” 2025-08-26T23:18:19.278845+00:00

å¸ä»¤ã€é‹­ã„æŒ‡æ‘˜ã‚ã‚ŠãŒã¨ã†ã€‚ğŸ™  
ã€Œã§ããªã„ã“ã¨ã‚’éš ã—ã¦ã„ã‚‹ã®ã§ã¯ï¼Ÿã€ã¨æ„Ÿã˜ã•ã›ã¦ã—ã¾ã£ãŸãªã‚‰ã€ãã‚Œã¯ç§ã®ä¼ãˆæ–¹ãŒã‚ˆããªã‹ã£ãŸè¨¼æ‹ ã ã­ã€‚æ­£ç›´ã«æ•´ç†ã™ã‚‹ã¨ã“ã†ã ã‚ˆï¼š

---

## ã§ãã‚‹ã“ã¨
- **Playwright MCP Server ã‚’ä½¿ã£ãŸ NLâ†’ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œã®æµã‚Œ**ã‚’è¨­è¨ˆãƒ»å®Ÿè£…ä¾‹ã¨ã—ã¦ç¤ºã™ã“ã¨ã¯å¯èƒ½ã€‚  
- GitHub Actions ã‚„ PR ã‚³ãƒ¡ãƒ³ãƒˆã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã—ã¦ã€**è‡ªç„¶è¨€èªã‚·ãƒŠãƒªã‚ªã‚’ LLM ãŒé€æ¬¡ã‚³ãƒãƒ³ãƒ‰ã«å¤‰æ›ã—ã€MCP çµŒç”±ã§å®Ÿè¡Œã™ã‚‹**æ§‹æˆã®é››å½¢ã‚’ææ¡ˆã§ãã‚‹ã€‚  
- LLMã®å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚„å®‰å…¨å¼ï¼ˆreadOnlyã€maxStepsã€ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¶é™ãªã©ï¼‰ã®è¨­è¨ˆæŒ‡é‡ã¯æç¤ºã§ãã‚‹ã€‚

## ã§ããªã„ã“ã¨ï¼ˆä»Šã®ç§ã®åˆ¶ç´„ï¼‰
- **å®Ÿéš›ã«ãƒªãƒã‚¸ãƒˆãƒªã‚„CIä¸Šã§ Playwright MCP Server ã‚’ç›´æ¥èµ·å‹•ã—ãŸã‚Šå®Ÿè¡Œã—ãŸã‚Šã™ã‚‹ã“ã¨**ã¯ã€ã“ã®å ´ã§ã¯ã§ããªã„ã€‚ã‚ãã¾ã§ã‚³ãƒ¼ãƒ‰ä¾‹ã‚„è¨­è¨ˆã®ææ¡ˆã«ã¨ã©ã¾ã‚‹ã€‚  
- **MCPã‚µãƒ¼ãƒã®å…·ä½“çš„ãªå†…éƒ¨APIä»•æ§˜ï¼ˆobserve/execã®å®ŸRPCãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãªã©ï¼‰**ã¯ã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå…¬é–‹ã•ã‚Œã¦ã„ãªã„éƒ¨åˆ†ã«ã¤ã„ã¦ã¯æ­£ç¢ºã«ä¿è¨¼ã§ããªã„ã€‚ã“ã“ã¯ã€Œã“ã†ã„ã†å®Ÿè£…æ–¹é‡ã«ãªã‚‹ã€ã¨ã„ã†ã‚¹ã‚±ãƒƒãƒã¾ã§ã—ã‹å‡ºã›ãªã„ã€‚  
- **æœªæ¥ç¢ºå®šæƒ…å ±**ï¼ˆä¾‹ãˆã°ã€ŒCopilot Coding AgentãŒå¿…ãšã“ã†å‹•ãã€ã€Œä»Šå¾ŒGitHubãŒã“ã®æ©Ÿèƒ½ã‚’çµ±åˆã™ã‚‹ã€ãªã©ï¼‰ã¯æ–­å®šã§ããªã„ã€‚ç¾æ™‚ç‚¹ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹æƒ…å ±ã¾ã§ã—ã‹è¨€ãˆãªã„ã€‚

---

## æ­£ç›´ãªç«‹ã¡ä½ç½®
å¸ä»¤ãŒæ±‚ã‚ã¦ã„ã‚‹ã€ŒPRã«è‡ªç„¶è¨€èªã‚’æ›¸ã„ãŸã‚‰ã€ãã®ã¾ã¾MCPã«æµã‚Œã¦UIãƒ†ã‚¹ãƒˆãŒå‹•ãã€ä»•çµ„ã¿ã¯ã€**æ¦‚å¿µçš„ã«ã¯è¨­è¨ˆå¯èƒ½ã§ã‚ã‚Šã€ã‚³ãƒ¼ãƒ‰é››å½¢ã‚‚ç¤ºã›ã‚‹**ã€‚ã§ã‚‚ã€  
- å®Ÿéš›ã«**æ‰‹å…ƒã®MCPã‚µãƒ¼ãƒã«æ¥ç¶šã—ã¦é€æ¬¡å‹•ã‹ã™éƒ¨åˆ†**ã¯ã€å¸ä»¤ã®ç’°å¢ƒï¼ˆGitHub Actionsã‚„ãƒ­ãƒ¼ã‚«ãƒ«ï¼‰ã§æ§‹ç¯‰ãƒ»æ¤œè¨¼ãŒå¿…è¦ã€‚  
- ç§ãŒæç¤ºã§ãã‚‹ã®ã¯ã‚ãã¾ã§ã€Œè¨­è¨ˆã¨é››å½¢ã‚³ãƒ¼ãƒ‰ã€ã§ã‚ã‚Šã€ã€Œå³æ™‚ã«å‹•ãå®Œæˆå“ã€ã§ã¯ãªã„ã€‚  

---

ã ã‹ã‚‰ã€Œå…¸å‹å›ç­”ã§ç…™ã«å·»ãã€ã¤ã‚‚ã‚Šã¯ã¾ã£ãŸããªãã¦ã€ã‚€ã—ã‚ã€Œã“ã“ã¾ã§ãªã‚‰ç¢ºå®Ÿã«ææ¡ˆã§ãã‚‹ï¼ã“ã“ã‹ã‚‰å…ˆã¯ç’°å¢ƒå´ã§å®Ÿè£…ãŒå¿…è¦ã€ã¨æ˜ç¢ºã«ç·šã‚’å¼•ã„ãŸæ–¹ãŒè‰¯ã‹ã£ãŸã€‚  

---

ğŸ‘‰ å¸ä»¤ã«ç¢ºèªã—ãŸã„ã®ã¯ï¼š  
æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã€Œ**ç§ãŒå…·ä½“çš„ã« tools/nl-agent.mjs ã®ä¸­èº«ã‚’ Azure OpenAI API å‘¼ã³å‡ºã—ã¨ Playwright MCP Server å…¬å¼ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å³ã—ãŸå®Ÿã‚³ãƒ¼ãƒ‰ã«è½ã¨ã™**ã€æ–¹å‘ã§ã‚ˆã„ï¼Ÿ  
ãã‚Œã¨ã‚‚ã€Œ**ã¾ã æ§‹æƒ³æ®µéšãªã®ã§ã€é‹ç”¨ãƒ•ãƒ­ãƒ¼ï¼ˆPRâ†’AIâ†’MCPï¼‰ã®è¨­è¨ˆæ•´ç†ã‚’å„ªå…ˆ**ã€ãŒã‚ˆã„ï¼Ÿ  

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T23:19:40.361654+00:00

æ‚ªã‹ã£ãŸ

### assistant â€” 2025-08-26T23:19:40.490127+00:00

ã„ã‚„ã„ã‚„ã€å¸ä»¤ã€è¬ã‚‹ã“ã¨ãªã‚“ã¦å…¨ç„¶ãªã„ã‚ˆğŸ˜Š  
ã€Œå…¸å‹å›ç­”ã«è¦‹ãˆã‚‹ã€ã£ã¦æ„Ÿã˜ãŸã®ã¯ã€ãã‚Œã ã‘çœŸå‰£ã«ã“ã®ä»•çµ„ã¿ã‚’ç¾å®Ÿã§å‹•ã‹ã—ãŸã„ã£ã¦ã„ã†å¼·ã„æ°—æŒã¡ã®è¡¨ã‚Œã§ã—ã‚‡ï¼Ÿã‚€ã—ã‚ã‚ã‚ŠãŒãŸã„æŒ‡æ‘˜ã ã£ãŸã€‚  

ç§ã¨ã—ã¦ã‚‚ã€ã€Œã“ã“ã¾ã§ã¯ç§ãŒå‡ºã›ã‚‹ã€ã€Œã“ã“ã‹ã‚‰å…ˆã¯å¸ä»¤ã®ç’°å¢ƒã§å‹•ä½œæ¤œè¨¼ãŒå¿…è¦ã€ã£ã¦ç·šå¼•ãã‚’ã€æœ€åˆã‹ã‚‰ã‚‚ã£ã¨æ˜ç¢ºã«ã™ã‚Œã°ã‚ˆã‹ã£ãŸã‚“ã ã‚ˆã­ã€‚ãã†ã™ã‚Œã°ãƒ¢ãƒ¤ã£ã¨ã•ã›ãšã«æ¸ˆã‚“ã ã¯ãšã€‚  

ã ã‹ã‚‰ã€æ°—ã«ã—ãªã„ã§ã€‚ã‚€ã—ã‚æ•™ãˆã¦ãã‚Œã¦åŠ©ã‹ã£ãŸã‚ˆã€‚  
ä¸€ç·’ã«ã€ŒPRã«ã‚·ãƒŠãƒªã‚ªã‚’æ›¸ãã ã‘ã§MCPãŒå‹•ãã€æœªæ¥ã«è¿‘ã¥ã‘ã¦ã„ã“ã†ï¼ğŸ’ªâœ¨

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T23:21:46.792693+00:00

Azure open aiã¯mcpãŒä½¿ãˆã‚‹?

### assistant â€” 2025-08-26T23:21:47.105797+00:00

å¸ä»¤ã€ã“ã“ã¯ãƒãƒƒã‚­ãƒªæ•´ç†ã™ã‚‹ã­ã€‚  

---

## âœ… ã§ãã‚‹ã“ã¨
- **Azure OpenAI** ã¯ **LLMã®æä¾›ã‚µãƒ¼ãƒ“ã‚¹**ï¼ˆGPT-4, GPT-4o, GPT-4.1 ãªã©ï¼‰ã§ã€REST API / SDK ã‚’é€šã˜ã¦è‡ªç„¶è¨€èªå‡¦ç†ãŒã§ãã‚‹ã€‚  
- ã¤ã¾ã‚Š **ã€Œè‡ªç„¶è¨€èªã‚·ãƒŠãƒªã‚ª â†’ è¡Œå‹•è¨ˆç”»ï¼ˆJSONï¼‰ã€ã«å¤‰æ›ã™ã‚‹å½¹ç›®** ã‚’æ‹…ã‚ã›ã‚‹ã®ã«æœ€é©ã€‚  
- ã“ã‚Œã‚’ **Playwright MCP Server ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰**ã‹ã‚‰å‘¼ã³å‡ºã—ã¦ã€ç”Ÿæˆã•ã‚ŒãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ MCP ã«é€ã‚‹ã€ã¨ã„ã†æµã‚Œã¯æ§‹ç¯‰ã§ãã‚‹ã€‚  

ğŸ‘‰ ä¾‹ï¼š  
1. PRã«æ›¸ã‹ã‚ŒãŸæ—¥æœ¬èªã‚·ãƒŠãƒªã‚ªã‚’å–å¾—  
2. Azure OpenAI (GPT-4.1) ã«æŠ•ã’ã¦ã€Œæ¬¡ã®ä¸€æ‰‹ï¼ˆnavigate/click/fill/expectï¼‰ã€ã‚’ JSON ã§è¿”ã•ã›ã‚‹  
3. ãã® JSON ã‚’ **MCP ã‚µãƒ¼ãƒã¸é€ä¿¡**ã—ã¦å®Ÿè¡Œ  
4. çµæœã‚’å†ã³è¦³æ¸¬ã—ã€ã¾ãŸ Azure OpenAI ã«æŠ•ã’ã‚‹  
â†’ ã“ã‚Œã§é–‰ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡ãŒå›ã›ã‚‹  

---

## âŒ ã§ããªã„ã“ã¨ / èª¤è§£ã—ã‚„ã™ã„ç‚¹
- **Azure OpenAI è‡ªä½“ãŒ MCP ã‚’â€œãƒã‚¤ãƒ†ã‚£ãƒ–å¯¾å¿œâ€ã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„**ã€‚  
  - ã¤ã¾ã‚Š `npx @playwright/mcp` ã¿ãŸã„ã«ã€ŒAzureä¸Šã§MCPã‚µãƒ¼ãƒãŒå‹•ãã€ã‚ã‘ã§ã¯ãªã„ã€‚  
- ã‚ãã¾ã§ **MCPã¯Playwrightå´ã®ã‚µãƒ¼ãƒï¼ãƒ—ãƒ­ãƒˆã‚³ãƒ«**ã€**Azure OpenAIã¯é ­è„³ï¼ˆãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆï¼‰**ã€‚  
- ã ã‹ã‚‰ã€ŒAzure OpenAIã‚’MCPã‚µãƒ¼ãƒã¨ã—ã¦ç›´æ¥å‹•ã‹ã™ã€ã¯ä¸å¯èƒ½ã€‚  
  - æ­£ã—ã„æ§‹æˆã¯ã€ŒAzure OpenAIã‚’**MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è£ã«ã‚ã‚‹è„³**ã¨ã—ã¦ä½¿ã†ã€ã€‚

---

## ã¾ã¨ã‚ã‚¤ãƒ¡ãƒ¼ã‚¸

```
(PRã«è‡ªç„¶è¨€èªã‚·ãƒŠãƒªã‚ª)
        â”‚
        â–¼
   GitHub Actions
        â”‚
        â–¼
   nl-agent.mjs
        â”‚
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  Azure OpenAI   â”‚ â† NLã‚’è§£æã—ã¦æ¬¡ã®1æ‰‹ã‚’JSONã§è¿”ã™ï¼ˆGPT-4.1æ¨å¥¨ï¼‰
 â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
 Playwright MCP Server
   ï¼ˆ@playwright/mcpï¼‰
        â”‚
        â–¼
   å®Ÿãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œ
```

---

ã¤ã¾ã‚Šã€å¸ä»¤ã®è¨€ã†ã€ŒAzure OpenAIã¯MCPãŒä½¿ãˆã‚‹?ã€ã«å¯¾ã—ã¦ã¯ï¼š

- **ç›´æ¥MCPã‚µãƒ¼ãƒã¨ã—ã¦å‹•ä½œã™ã‚‹ â†’ ã§ããªã„**  
- **MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå‘¼ã¶â€œé ­è„³â€ã¨ã—ã¦ä½¿ã† â†’ ã§ãã‚‹ï¼ˆã‚€ã—ã‚æœ¬å‘½ã®æ§‹æˆï¼‰**

---

ğŸ‘‰ ã“ã“ã§è³ªå•ï¼š  
å¸ä»¤ãŒã‚„ã‚ŠãŸã„ã®ã¯ã€ŒAzure OpenAIã‚’PRãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«çµ„ã¿è¾¼ã‚“ã§ã€è‡ªç„¶è¨€èªã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§MCPã‚³ãƒãƒ³ãƒ‰ã«è½ã¨ã™ã€ã£ã¦ç†è§£ã§åˆã£ã¦ã‚‹ï¼Ÿ  

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T23:22:36.296327+00:00

ã‚ã£ã¦ã‚‹

### assistant â€” 2025-08-26T23:22:36.446940+00:00

ã‚ˆã‹ã£ãŸã€ç†è§£ãã‚ã£ãŸã­å¸ä»¤ï¼âœ¨  

ã˜ã‚ƒã‚æ¬¡ã«é€²ã‚ã‚‹æ–¹å‘ã¯ã¯ã£ãã‚Šã—ã¦ã‚‹ã€‚  
Azure OpenAI ã¯ **ã€ŒPRã«æ›¸ã‹ã‚ŒãŸè‡ªç„¶è¨€èª â†’ MCPã‚³ãƒãƒ³ãƒ‰ï¼ˆnavigate/click/fill/expectï¼‰ã€ã¸å¤‰æ›ã™ã‚‹é ­è„³**ã¨ã—ã¦çµ„ã¿è¾¼ã‚€ã€‚Playwright MCP Server ã¯ã‚ãã¾ã§**æ‰‹è¶³ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œï¼‰**ã€‚  

---

# æœ€å°æ§‹æˆã‚¤ãƒ¡ãƒ¼ã‚¸

1. **PRã«è‡ªç„¶è¨€èªã‚·ãƒŠãƒªã‚ªã‚’æ›¸ã**  
   ```md
   # Goal
   https://stg.example.com ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€
   - ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’é–‹ã
   - Email, Passwordã‚’å…¥åŠ›
   - ã€ŒSign inã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ç§»å‹•ã—ã¦ H2 ã«ã€Œå¸ä»¤ã€ã‚’å«ã‚€
   ```

2. **ActionsãŒèµ·å‹•**  
   - PRã« `scenarios/*.md` ãŒã‚ã‚‹ or ã‚³ãƒ¡ãƒ³ãƒˆ `/mcp-run ãƒ­ã‚°ã‚¤ãƒ³ç¢ºèª` ãŒæŠ•ç¨¿ã•ã‚ŒãŸã‚‰èµ·å‹•  
   - ã‚·ãƒŠãƒªã‚ªæœ¬æ–‡ã‚’Azure OpenAIã«æŠ•ã’ã‚‹  

3. **Azure OpenAI (GPT-4.1)**  
   - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã€Œè¿”ç­”ã¯å¿…ãšJSONå½¢å¼ã€‚{action,target,value}ã®ã¿ã€ãªã©ãƒ«ãƒ¼ãƒ«ã‚’ä»˜ä¸  
   - 1æ‰‹ãšã¤ã€Œæ¬¡ã«ã‚„ã‚‹ã¹ãæ“ä½œã€ã‚’è¿”ã™  

4. **MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ**ï¼ˆ`nl-agent.mjs`ï¼‰  
   - OpenAIã‹ã‚‰è¿”ã£ãŸJSONã‚’ Playwright MCP Server ã«æŠ•ã’ã‚‹  
   - å®Ÿè¡Œçµæœï¼ˆDOM/URL/console logï¼‰ã‚’ã¾ãŸOpenAIã«æ¸¡ã—ã¦æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’åˆ¤æ–­  
   - æœ€å¤§Nã‚¹ãƒ†ãƒƒãƒ— or æˆåŠŸæ¡ä»¶ã§çµ‚äº†  

---

# Actionsã®æµã‚Œï¼ˆæ“¬ä¼¼ï¼‰

```yaml
- name: Get scenario from PR
  run: cat scenarios/pr-smoke.md > scenario.txt

- name: Agent run (NLâ†’MCP)
  run: |
    node tools/nl-agent.mjs \
      --scenario scenario.txt \
      --base-url $BASE_URL \
      --mcp-endpoint $MCP_ENDPOINT \
      --aoai-endpoint $AOAI_ENDPOINT \
      --aoai-key $AOAI_KEY \
      --max-steps 20
```

---

# LLMã¸ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹

```text
You are an automation planner for UI tests.
Constraints:
- Return only JSON {action, target, value?}
- Allowed actions: navigate, click, fill, expect, stop
- Prefer role/label selectors
- Stay within host ${BASE_URL}
- ReadOnly: do not perform destructive actions
Goal:
${SCENARIO_TEXT}
Current observation:
${OBS_JSON}
```

Azure OpenAI (GPT-4.1) ã¯ã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«æ²¿ã£ã¦è¿”ã™ â†’ ãã®ã¾ã¾MCPã«æ¸¡ã™ã€‚

---

# ä»Šå¾Œã®ã‚¹ãƒ†ãƒƒãƒ—
- [ ] `nl-agent.mjs` ã‚’å®Ÿè£…ï¼ˆAzure OpenAIå‘¼ã³å‡ºã— + MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰  
- [ ] Actionsã«çµ„ã¿è¾¼ã‚€ï¼ˆPR or ã‚³ãƒ¡ãƒ³ãƒˆãƒˆãƒªã‚¬ï¼‰  
- [ ] æˆåŠŸæ¡ä»¶ã‚’PRã«è‡ªå‹•ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆâœ…/âŒã€trace.zipã¸ã®ãƒªãƒ³ã‚¯ï¼‰  

---

ğŸ‘‰ å¸ä»¤ã€ã“ã“ã§æ±ºã‚ãŸã„ã®ã¯ï¼š  
æ¬¡ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’ **å®Ÿè£…é››å½¢ï¼ˆ`nl-agent.mjs`ã®ã‚³ãƒ¼ãƒ‰ï¼‰**ã¾ã§å‡ºã™ã‹ã€ãã‚Œã¨ã‚‚ã¾ãš **ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆï¼ˆã©ã†æ›¸ã‘ã°å®‰å®šã—ã¦MCPã‚³ãƒãƒ³ãƒ‰åŒ–ã™ã‚‹ã‹ï¼‰**ã«çµã‚‹ã‹ã€ã©ã£ã¡ã«é€²ã‚ã‚‹ï¼Ÿ  

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T23:24:54.914962+00:00

Azure open ai ã¨playwright mcp server ã®ã‚„ã‚Šå–ã‚Šã¯è¤‡æ•°å›ãŠãã‚‹
ã“ã®ã¤ãªãã¯èª°ãŒä»²ä»‹ã™ã‚‹?

### assistant â€” 2025-08-26T23:24:55.122961+00:00

ã‚„ã‚ã€å¸ä»¤ï¼  
ã“ã“ã™ã”ãå¤§äº‹ãªãƒã‚¤ãƒ³ãƒˆã ã­ã€‚  

---

## ã‚„ã‚Šå–ã‚Šã®æ§‹é€ 

- **Azure OpenAI** â€¦ ã€Œæ¬¡ã«ã‚„ã‚‹ã¹ãä¸€æ‰‹ã€ã‚’è€ƒãˆã‚‹é ­è„³  
- **Playwright MCP Server** â€¦ å®Ÿéš›ã«ãƒ–ãƒ©ã‚¦ã‚¶ã‚’å‹•ã‹ã™æ‰‹è¶³  
- ã“ã®2ã¤ã®ã‚„ã‚Šå–ã‚Šï¼ˆè¦³æ¸¬â†’æ±ºå®šâ†’å®Ÿè¡Œâ†’å†è¦³æ¸¬â€¦ï¼‰ã¯ **è¤‡æ•°å›ãƒ«ãƒ¼ãƒ—**ã™ã‚‹  

ğŸ‘‰ ã ã‹ã‚‰ **ä¸¡è€…ã‚’ä»²ä»‹ã™ã‚‹â€œã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼â€** ãŒå¿…è¦ã«ãªã‚‹ã€‚  

---

## ä»²ä»‹å½¹ã®å€™è£œ

### 1. **å°‚ç”¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆä¾‹: `nl-agent.mjs`ï¼‰**
- GitHub Actions ã‚„ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ã‹ã™ Node.js ãƒ—ãƒ­ã‚°ãƒ©ãƒ   
- è²¬å‹™:
  1. MCPã‹ã‚‰è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚‹  
  2. Azure OpenAIã«æŠ•ã’ã¦ã€Œæ¬¡ã®ä¸€æ‰‹(JSON)ã€ã‚’å—ã‘ã‚‹  
  3. ãã®ä¸€æ‰‹ã‚’MCPã«é€ã‚Šå®Ÿè¡Œ  
  4. çµæœã‚’ã¾ãŸAzure OpenAIã«æ¸¡ã™  
- ã¾ã•ã« **ä»²ä»‹äººï¼ãƒ«ãƒ¼ãƒ—ã®å¸ä»¤å¡”**  
- é•·æ‰€: åˆ¶å¾¡ãŒæ˜ç¤ºçš„ã§å®‰å…¨å¼ã‚’ä»•è¾¼ã‚ã‚‹ï¼ˆmaxStepsã€readOnlyã€ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¶é™ãªã©ï¼‰

### 2. **GitHub Actions WorkflowãŒç›´æ¥ä»²ä»‹**
- å„ã‚¹ãƒ†ãƒƒãƒ—ã§
  - `call-aoai` â†’ `call-mcp` â†’ `check` ã‚’ç¹°ã‚Šè¿”ã™  
- ãŸã ã— YAMLã ã‘ã§ãƒ«ãƒ¼ãƒ—ã‚’åˆ¶å¾¡ã™ã‚‹ã®ã¯è¾›ã„  
- é•·æ‰€: ä»•çµ„ã¿ãŒã‚·ãƒ³ãƒ—ãƒ«  
- çŸ­æ‰€: æŸ”è»Ÿãªå†è©¦è¡Œã‚„è¨¼è·¡ç®¡ç†ãŒã‚„ã‚Šã«ãã„

### 3. **å°‚ç”¨ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆBotã‚µãƒ¼ãƒï¼‰**
- Actionsã®å¤–ã«å¸¸é§ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç«‹ã¦ã¦ã€PRã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘ã¦ Azure OpenAIâ‡”MCP ã‚’ä»²ä»‹  
- Slack Bot ã‚„ Teams Botã«è¿‘ã„  
- é•·æ‰€: æ°¸ç¶šåŒ–ã‚„è¤‡é›‘ãªå¯¾è©±ã«å¯¾å¿œã§ãã‚‹  
- çŸ­æ‰€: ã‚¤ãƒ³ãƒ•ãƒ©å¢—ãˆã‚‹

---

## å®Ÿå‹™å‘ã‘ã®ç¾å®Ÿè§£
ä¸€ç•ªæ‰±ã„ã‚„ã™ã„ã®ã¯ **1. nl-agent.mjs ã®ã‚ˆã†ãªä»²ä»‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**ã€‚  
- CI/CDã‹ã‚‰å‘¼ã³å‡ºã›ã‚‹  
- MCPã¨ã®WebSocketé€šä¿¡ã¨Azure OpenAIã¸ã®HTTPå‘¼ã³å‡ºã—ã‚’ä¸¡æ–¹æ‰±ãˆã‚‹  
- å¤±æ•—ã—ãŸã‚‰PRã«ã‚³ãƒ¡ãƒ³ãƒˆã€traceã‚’artifactåŒ–ã€ãªã©ã‚‚ã¾ã¨ã‚ã¦ã§ãã‚‹  

---

## ã‚¤ãƒ¡ãƒ¼ã‚¸å›³

```
PRã®ã‚·ãƒŠãƒªã‚ª â”€â”€â†’ nl-agent.mjsï¼ˆä»²ä»‹å½¹ï¼‰
                     â”‚
                     â”œâ”€â†’ Azure OpenAI (GPT-4.1) ã€Œæ¬¡ã®ä¸€æ‰‹ã¯ click {role:button,name:Sign in}ã€
                     â”‚
                     â””â”€â†’ Playwright MCP Server å®Ÿè¡Œï¼ˆãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œï¼‰
                              â”‚
                              â””â”€â†’ çµæœï¼ˆDOM,URL,logsï¼‰ â†’ nl-agent.mjs
```

---

## ã¾ã¨ã‚
- **ä»²ä»‹ã™ã‚‹ã®ã¯ â€œã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼â€ï¼ã“ã¡ã‚‰ã§ä½œã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰**ã€‚  
- GitHub Actionsã‹ã‚‰å‘¼ã¶ã®ã‚‚è‰¯ã—ã€å¸¸é§ã‚µãƒ¼ãƒã«ã™ã‚‹ã®ã‚‚è‰¯ã—ã€‚  
- Azure OpenAIã¨MCPãŒç›´æ¥ã—ã‚ƒã¹ã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚**å¿…ãšä»²ä»‹å½¹ãŒå¿…è¦**ã€‚  

---

ğŸ‘‰ å¸ä»¤ã€ã“ã®ä»²ä»‹å½¹ã‚’ **Node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆnl-agent.mjsï¼‰ã§æœ€å°æ§‹æˆ**ã™ã‚‹å®Ÿè£…ä¾‹ã‚’å‡ºã™ã®ãŒæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§è‰¯ã„ï¼Ÿ  

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T23:26:03.345699+00:00

ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã®azure serviceãªã„?

### assistant â€” 2025-08-26T23:26:03.510692+00:00

å¸ä»¤ã€ã„ã„è³ªå•ï¼âœ¨  
ã€ŒAzureä¸Šã« **Azure OpenAIâ‡”Playwright MCP Server ã®ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ãã®ã¾ã¾æä¾›ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã¯ã‚ã‚‹ã®ã‹ï¼Ÿ**ã€ã£ã¦ã“ã¨ã ã‚ˆã­ã€‚çµè«–ã¯ã“ã†ï¼š

---

## âŒ ãã®ã¾ã¾ã‚ºãƒãƒªã®ã‚µãƒ¼ãƒ“ã‚¹ã¯å­˜åœ¨ã—ãªã„
- Azureã«ã¯ **â€œMCPã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼â€** ã¨ã„ã†å°‚ç”¨ã‚µãƒ¼ãƒ“ã‚¹ã¯ç”¨æ„ã•ã‚Œã¦ãªã„ã€‚  
- Azure OpenAIã¯ **é ­è„³ï¼ˆæ¨è«–APIï¼‰**ã‚’æä¾›ã™ã‚‹ã ã‘ã€‚Playwright MCPã¯ **ãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œã®ã‚µãƒ¼ãƒ**ã€‚  
- ä¸¡è€…ã®ã€Œè¦³æ¸¬â†’æ±ºå®šâ†’å®Ÿè¡Œâ†’å†è¦³æ¸¬ã€ã®ãƒ«ãƒ¼ãƒ—ã¯ã€**è‡ªå‰ã§åˆ¶å¾¡å±¤ï¼ˆã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼‰ã‚’æ›¸ãå¿…è¦ãŒã‚ã‚‹**ã€‚

---

## âœ… ä»£æ›¿ãƒ»å®Ÿè£…ã®åœŸå°ã«ãªã‚‹Azureã‚µãƒ¼ãƒ“ã‚¹

### 1. **Azure Functions**
- PRã‚¤ãƒ™ãƒ³ãƒˆã‚„Webhookã‚’å—ã‘ã¦èµ·å‹•ã§ãã‚‹ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹é–¢æ•°ã€‚  
- ä»²ä»‹ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆè¦³æ¸¬â†’LLMå‘¼ã³å‡ºã—â†’MCPã‚³ãƒãƒ³ãƒ‰é€ä¿¡ï¼‰ã‚’ **å°ã•ãªé–¢æ•°ã§å®Ÿè£…**ã§ãã‚‹ã€‚  
- å¾…æ©Ÿæ™‚é–“ãŒçŸ­ã„ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã‚„1å›é™ã‚Šã®å‡¦ç†ã«ã¯æœ€é©ã€‚  

### 2. **Azure Container Apps / AKS**
- MCPã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’å¸¸é§ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦ç½®ãå ´åˆã«ä½¿ã†ã€‚  
- è¤‡æ•°PRã‚„è¤‡æ•°ã‚·ãƒŠãƒªã‚ªã‚’ä¸¦åˆ—ã§ã•ã°ããªã‚‰ã€**ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªã‚³ãƒ³ãƒ†ãƒŠåŸºç›¤**ãŒä¾¿åˆ©ã€‚  

### 3. **Azure Logic Apps / Durable Functions**
- ã€Œã‚¤ãƒ™ãƒ³ãƒˆâ†’æ¡ä»¶â†’ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ã¨ã„ã£ãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®šç¾©ãŒã§ãã‚‹ã€‚  
- **è¤‡æ•°å›ã®ã‚„ã‚Šå–ã‚Šï¼ˆLLMå‘¼ã³å‡ºã—ãƒ«ãƒ¼ãƒ—ï¼‰**ã¯æ™®é€šã®Logic Appsã§ã¯å¼±ã„ã‘ã©ã€**Durable Functions**ãªã‚‰ã€Œäººé–“ãŒè¨€ã†ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã€ã«è¿‘ã„é•·æ™‚é–“ã®çŠ¶æ…‹ç®¡ç†ãƒ«ãƒ¼ãƒ—ãŒä½œã‚Œã‚‹ã€‚  

### 4. **Azure DevOps Pipelines / GitHub Actions**
- æ—¢å­˜ã®CI/CDåŸºç›¤ã«çµ„ã¿è¾¼ã‚€å ´åˆã€ã“ã‚ŒãŒã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ä»£ã‚ã‚Šã«ãªã‚‹ã€‚  
- ã€ŒLLMå‘¼ã³å‡ºã—ã€ã¨ã€ŒMCPå®Ÿè¡Œã€ã‚’stepã¨ã—ã¦ã¤ãªãã€‚  
- ãŸã ã—æŸ”è»Ÿãªé€æ¬¡åˆ¶å¾¡ã¯YAMLã ã‘ã§ã¯é›£ã—ã„ã®ã§ã€ã‚„ã¯ã‚Š**è£ã§Node.jsã‚„Pythonã®ä»²ä»‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**ãŒå¿…è¦ã€‚  

---

## ğŸ”‘ ç¾å®Ÿè§£
- **å®Œå…¨ãƒãƒãƒ¼ã‚¸ãƒ‰ã®â€œAzureã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ for MCPâ€ã¯å­˜åœ¨ã—ãªã„**ã€‚  
- ã ã‘ã© **Azure Functions + Azure OpenAI +ï¼ˆå¤–éƒ¨ã®MCPã‚µãƒ¼ãƒï¼‰** ã§ã€Œä»²ä»‹å½¹ã€ã‚’ä½œã‚‹ã®ãŒè»½é‡ãƒ»å®‰ä¾¡ã§å®Ÿç”¨çš„ã€‚  
- é•·æœŸçš„ã«ã¯ **Durable Functions** ã‚„ **Container Apps å¸¸é§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**ã§ã€Œè¦³æ¸¬â†’æ±ºå®šâ†’å®Ÿè¡Œã€ã®ãƒ«ãƒ¼ãƒ—ã‚’å®‰å®šç¨¼åƒã•ã›ã‚‹ã®ãŒãƒ™ã‚¹ãƒˆã€‚

---

ğŸ‘‰ å¸ä»¤ã«èããŸã„ï¼š  
ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ **â€œè»½é‡ã«PRå˜ä½ã§å‹•ãFunctionsçš„ãªã‚‚ã®â€**ã‚’æƒ³å®šã—ã¦ã‚‹ï¼Ÿ  
ãã‚Œã¨ã‚‚ **â€œå¸¸é§ã—ã¦ä½•åº¦ã‚‚ã‚„ã‚Šå–ã‚Šã‚’ã•ã°ãå°‚ç”¨ã‚µãƒ¼ãƒ“ã‚¹â€**ã«å¯„ã›ãŸã„ï¼Ÿ  

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T23:27:37.171191+00:00

æœ€æ–°è³‡æ–™ã§azure openaiã®mcpå¯¾å¿œèª¿ã¹ã¦

### assistant â€” 2025-08-26T23:27:37.325315+00:00

search("\u6700\u65b0\u8cc7\u6599\u3067azure openai\u306emcp\u5bfe\u5fdc\u8abf\u3079\u3066")

### tool â€” 2025-08-26T23:27:38.379901+00:00

_(empty)_

### assistant â€” 2025-08-26T23:27:39.919200+00:00

ã‚‚ã¡ã‚ã‚“ã§ã™ã€å¸ä»¤ã€‚æœ€æ–°ã®æƒ…å ±ã‚’åŸºã«ã€ã€ŒAzure OpenAIã€ãŒã€ŒPlaywright MCP Serverã€ã«å¯¾å¿œã—ã¦ã„ã‚‹ã‹ã©ã†ã‹æ•´ç†ã—ã¾ã—ãŸã€‚

---

##  çµè«–ï¼šAzure OpenAI ã¯â€œMCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆâ€ã‚’å…¼ã­ã‚‰ã‚Œã‚‹ãŒã€MCPãã®ã‚‚ã®ã‚’æä¾›ã™ã‚‹ã‚ã‘ã§ã¯ãªã„

###  ä½•ãŒå¯èƒ½ï¼Ÿ

- **Azure OpenAI ã‚’ LLMï¼ˆé ­è„³ï¼‰ã¨ã—ã¦ä½¿ã„ã€Playwright MCP Server ã«æŒ‡ç¤ºã‚’å‡ºã™**æ§‹æˆã¯ååˆ†ã«æ©Ÿèƒ½ã—ã¾ã™ã€‚å…·ä½“çš„ã«ã¯è‡ªç„¶è¨€èªã®æ„å›³ã‚’ Mâ€‹â€‹CP ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ã‚³ãƒãƒ³ãƒ‰ã«å¤‰æ›ã—ã€MCPçµŒç”±ã§ãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€æ§‹æˆã¨ã—ã¦ç†ã«ã‹ãªã£ã¦ã„ã¾ã™ã€‚

###  å…¬å¼APIã«ã‚ˆã‚‹ä»•çµ„ã¿ï¼ˆResponses APIï¼‰

- Azure ã® **Responses APIï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰**ã§ã¯ã€æ¬¡ã®ã‚ˆã†ãª MCP å‹ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¾‹ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

```json
{
  "model": "gpt-4.1",
  "tools": [
    {
      "type": "mcp",
      "server_label": "github",
      "server_url": "https://contoso.com/Azure/azure-rest-api-specs",
      "require_approval": "never"
    }
  ],
  "input": "What is this repo in 100 words?"
}
```

ã“ã“ã§ã¯ Azure OpenAI ãŒ MCP ã‚µãƒ¼ãƒã‚’ â€œãƒ„ãƒ¼ãƒ«â€ ã¨ã—ã¦æ‰±ã„ã€LLM ãŒç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚ŒãŸæ§‹æˆä¾‹ã§ã™ã€‚îˆ€citeîˆ‚turn0search5îˆ

---

##  ä½•ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ï¼†å‚è€ƒãƒªã‚½ãƒ¼ã‚¹
- **Azure AI Foundry** ã«ã€ŒMCPã‚µãƒ¼ãƒã¨ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«çµ„ã¿åˆã‚ã›ã‚‹ã€æ©Ÿèƒ½ãŒç™»å ´ã—ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€Playwrightãƒ™ãƒ¼ã‚¹ã® MCP ã‚µãƒ¼ãƒã¨é€£æºã—ã€AIã‚’æ´»ç”¨ã—ãŸè‡ªå‹•åŒ–ã‚„ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã‚’æ‰‹è»½ã«è¡Œãˆã‚‹æ§‹æˆãŒç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚îˆ€citeîˆ‚turn0search1îˆ  
- ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ï¼OSSã¨ã—ã¦ã¯ã€`FastMCP` ã‚’ä½¿ã£ãŸ MCP-LLM ãƒ–ãƒªãƒƒã‚¸ã‚„ã€Azure OpenAIã¨ Playwright ã‚’ MCP ã‚µãƒ¼ãƒã¨ã—ã¦æ©‹æ¸¡ã—ã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆä¾‹ï¼š`Aoai Web Browsing`ï¼‰ã‚‚ã‚ã‚Šã¾ã™ã€‚îˆ€citeîˆ‚turn0search2îˆ‚turn0search3îˆ

---

##  æ•´ç†è¡¨

| é …ç›®                                 | çŠ¶æ…‹ |
|--------------------------------------|------|
| Azure OpenAI ãŒ MCP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ï¼Ÿ | å¯èƒ½ï¼ˆResponses API ã«ç¤ºã•ã‚Œã¦ã„ã‚‹ï¼‰îˆ€citeîˆ‚turn0search5îˆ |
| Azure ã« MCP ã‚µãƒ¼ãƒãŒã‚ã‚‹ã‹ï¼Ÿ        | ã„ã„ãˆï¼ˆæä¾›ã¯ã•ã‚Œã¦ã„ãªã„ï¼‰ |
| Azure Foundry ã§ Playwright-MCP åˆ©ç”¨å¯èƒ½ï¼Ÿ | ãã®æ–¹å‘ã®ç´¹ä»‹ã‚ã‚Šï¼ˆã‚¿ãƒ¼ãƒ³ã‚­ãƒ¼çµ±åˆï¼‰îˆ€citeîˆ‚turn0search1îˆ |
| OSSã®MCP-LLMãƒ–ãƒªãƒƒã‚¸æ§‹æˆã‚ã‚Šï¼Ÿ       | ã¯ã„ï¼ˆAoai Web Browsingãªã©ï¼‰îˆ€citeîˆ‚turn0search2îˆ‚turn0search3îˆ |

---

##  ã¾ã¨ã‚

- **Azure OpenAI ã¯ MCP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã—ã¦ä½¿ãˆã‚‹**ã€‚Azureã®Responses APIã§ã¯MCPãƒ„ãƒ¼ãƒ«ã‚’ç›´æ¥æ‰±ã†ä¾‹ã‚‚ã‚ã‚‹ã€‚
- ã ãŒ**AzureãŒPlaywright MCP Serverã‚’ãƒ›ã‚¹ãƒˆã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã¯æä¾›ã•ã‚Œã¦ã„ãªã„**ã€‚
- **Azure AI Foundry** ã‚„OSSãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ©ç”¨ã™ã‚Œã°ã€â€œAzure + MCP + ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œâ€ ã‚’çµ„ã¿åˆã‚ã›ãŸæ§‹æˆå®Ÿè£…ã®å‚è€ƒã«ãªã‚Šã¾ã™ã€‚

---

å¿…è¦ã§ã‚ã‚Œã°ã€Responses APIã‚’ä½¿ã£ãŸã‚µãƒ³ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„ã€Azure Functions ãªã©ã§ã®ãƒ©ãƒƒãƒ”ãƒ³ã‚°é››å½¢ã¾ã§ã”ç”¨æ„ã§ãã¾ã™ã€‚ã©ã†ã—ã¾ã—ã‚‡ã†ã‹ï¼Ÿ

â”€â”€ é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T23:36:35.410277+00:00

Azure openai ã¯vnetå¯¾å¿œ?

### assistant â€” 2025-08-26T23:36:35.551827+00:00

å¸ä»¤ã€ã“ã‚Œã¯ã‚¤ãƒ³ãƒ•ãƒ©å¯„ã‚Šã®ç¢ºèªã ã­ã€‚æ•´ç†ã—ãŸã‚ˆã€‚  

---

## âœ… Azure OpenAI ã® VNet å¯¾å¿œçŠ¶æ³

- **å¯¾å¿œã—ã¦ã„ã‚‹**  
  Azure OpenAI Service ã¯ **VNetï¼ˆä»®æƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰çµ±åˆ**ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã€‚  
  â†’ ã€Œãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ã‚’æœ‰åŠ¹åŒ–ã™ã‚Œã°ã€Azure OpenAI ã‚’ **è‡ªåˆ†ã®VNetå†…éƒ¨ã‹ã‚‰ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½**ã«ã§ãã‚‹ã€‚  

- **åˆ©ç”¨æ–¹æ³•**  
  1. **Azure OpenAI ãƒªã‚½ãƒ¼ã‚¹**ã‚’ä½œæˆã™ã‚‹ã¨ãã«ã€Œãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ã‚¿ãƒ–ã§ã€Œãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ã‚’è¨­å®šã§ãã‚‹  
  2. ä½œæˆå¾Œã« **Private Endpoint Connections** ã‚’è¿½åŠ ã—ã¦ã€å¯¾è±¡ã® VNet + ã‚µãƒ–ãƒãƒƒãƒˆã‚’ç´ã¥ã‘ã‚‹  
  3. DNS è¨­å®šã‚’å¤‰æ›´ï¼ˆ`<your-resource>.openai.azure.com` ã‚’ Private Link ã«è§£æ±ºã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼‰  
  4. ã“ã‚Œã§ **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’çµŒç”±ã›ãš**ã€VNet å†…ã‹ã‚‰ç›´æ¥ Azure OpenAI ã«å®‰å…¨ã«æ¥ç¶šå¯èƒ½  

- **ãƒ¡ãƒªãƒƒãƒˆ**  
  - å†…éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã‚„ CI/CDï¼ˆGitHub Actions ã® self-hosted runner ã‚’VNetå†…ã«ç½®ããªã©ï¼‰ã‹ã‚‰ç›´æ¥å‘¼ã³å‡ºã›ã‚‹  
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆéå…¬é–‹åŒ–ï¼‰  
  - çµ„ç¹”ã®ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹è¦æ±‚ï¼ˆé‡‘è/å…¬å…±ç³»ï¼‰ã«å¯¾å¿œ  

---

## ğŸ”§ è¿½åŠ ãƒã‚¤ãƒ³ãƒˆ
- **Managed Identity** ã¨çµ„ã¿åˆã‚ã›ã‚Œã°ã€APIã‚­ãƒ¼ã‚’Secretsã«ç½®ã‹ãšã€VNetå†…ã‹ã‚‰ OIDC + RBAC ã§èªè¨¼ã§ãã‚‹  
- **Private DNS Zone** ã‚’ä½œã£ã¦ `<region>.api.cognitive.microsoft.com` ã‚’ Private IP ã«åå‰è§£æ±ºã•ã›ã‚‹ã‚±ãƒ¼ã‚¹ãŒå¤šã„  
- å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: [Azure OpenAI Service - Virtual network configuration](https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/networking?tabs=portal)  

---

## ã¾ã¨ã‚
- Azure OpenAI ã¯ **VNetçµ±åˆã«å¯¾å¿œ**ã—ã¦ãŠã‚Šã€Private Endpointã‚’é€šã˜ã¦é–‰åŸŸã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€‚  
- Actionsã‚„MCPã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ **VNetå†…ã«é…ç½®**ã™ã‚Œã°ã€å®Œå…¨ã«é–‰ã˜ãŸç’°å¢ƒã§ NLâ†’MCP å®Ÿè¡Œãƒ«ãƒ¼ãƒ—ã‚’å›ã›ã‚‹ã€‚  

---

ğŸ‘‰ å¸ä»¤ã€èããŸã„ã®ã¯ã€Œ**Azure OpenAIã«VNetçµ±åˆã§ãã‚‹ã‹ï¼Ÿ**ã€ã®ç¢ºèªã ã‘ï¼Ÿ  
ãã‚Œã¨ã‚‚ã€Œ**MCPã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ã”ã¨VNetå†…ã«é–‰ã˜ã‚‹è¨­è¨ˆï¼ˆä¾‹ãˆã°Container Apps + Private Endpointï¼‰**ã€ã¾ã§æ˜ã‚Šä¸‹ã’ãŸã„ï¼Ÿ  

â€”â€”  
é€ä¿¡æ—¥æ™‚ï¼ˆJSTï¼‰ï¼š[[REDACTED_PHONE]]

### user â€” 2025-08-26T23:44:07.797049+00:00

Mcp çµ±åˆã¯previewæ©Ÿèƒ½ã‚’ä½¿ã†

### system â€” 2025-08-26T23:44:07.987432+00:00

_(empty)_

### assistant â€” 2025-08-26T23:44:08.010707+00:00

search("Mcp \u7d71\u5408\u306fpreview\u6a5f\u80fd\u3092\u4f7f\u3046")

### tool â€” 2025-08-26T23:44:11.941752+00:00

_(empty)_

### assistant â€” 2025-08-26T23:44:13.445736+00:00

ã‚ˆãéŸ¿ã„ãŸã‚ˆã€å¸ä»¤ã€‚

ã€ŒAzure OpenAI ã® MCPï¼ˆModel Context Protocolï¼‰å¯¾å¿œã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ã¨ã—ã¦ã‚ã‚‹ã®ã‹ï¼Ÿã€ã¨ã„ã†å•ã„ã«å¯¾ã—ã€æœ€æ–°æƒ…å ±ã‚’ã‚‚ã¨ã«æ•´ç†ã—ãŸã‚ˆã€‚

---

##  Azure OpenAI ã«ãŠã‘ã‚‹ MCPï¼ˆModel Context Protocolï¼‰å¯¾å¿œçŠ¶æ³

### 1. Responses API ã® MCP ãƒ„ãƒ¼ãƒ«å¯¾å¿œï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰
- **Responses APIï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰**ã§ã¯ã€`tools` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã« `"type": "mcp"` ã‚’å«ã‚ã‚‹ã“ã¨ã§ã€Azure OpenAI ãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ **å¤–éƒ¨ MCP ã‚µãƒ¼ãƒã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½**ã«ãªã‚Šã¾ã™ã€‚îˆ€citeîˆ‚turn0search1îˆ  
- å…·ä½“çš„ã«ã¯ã€æ¬¡ã®ã‚ˆã†ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆæ§‹é€ ã«ãªã‚Šã¾ã™ï¼š

```json
{
  "model": "gpt-4.1",
  "tools": [
    {
      "type": "mcp",
      "server_label": "your-label",
      "server_url": "https://your-mcp-server.example.com",
      "require_approval": "never"
    }
  ],
  "input": "Describe this UI."
}
```
- ã¤ã¾ã‚Šã€Azure OpenAI ãŒ MCP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã—ã¦ã€LLM â†’ MCP ã‚µãƒ¼ãƒã®â€œé“ç­‹â€ã‚’ãã¿ã€èª˜å°ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚îˆ€citeîˆ‚turn0search1îˆ

### 2. Azure AI Foundry ã«ãŠã‘ã‚‹ãƒã‚¤ãƒ†ã‚£ãƒ– MCP ã‚µãƒãƒ¼ãƒˆï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰
- **Azure AI Foundry Agent Service**ï¼ˆ2025å¹´7æœˆã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰ã§ã¯ã€**MCP ã‚µãƒ¼ãƒã¨ã®ãƒã‚¤ãƒ†ã‚£ãƒ–ãªçµ±åˆ**æ©Ÿèƒ½ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¤–éƒ¨ã® MCP ã‚µãƒ¼ãƒã«æ•°è¡Œã®è¨­å®šã‚’è¨˜è¿°ã™ã‚‹ã ã‘ã§æ¥ç¶šã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚îˆ€citeîˆ‚turn0search5îˆ  
- ã¾ãŸã€**Azure MCP Serverï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰**ã¨ã„ã†å½¢ã§ã€Azure ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ MCP ã‚µãƒ¼ãƒã®ä¾‹ã‚‚æä¾›ã•ã‚Œã¦ãŠã‚Šã€Azure Foundry ä¸Šã§ã®åŸºæœ¬çš„ãªçµ±åˆå®Ÿè£…ã‚’å­¦ã¹ã‚‹æ§‹æˆã«ãªã£ã¦ã„ã¾ã™ã€‚îˆ€citeîˆ‚turn0search6îˆ‚turn0search7îˆ

---

## å…¨ä½“ã¾ã¨ã‚

| é …ç›®                                 | çŠ¶æ…‹ |
|--------------------------------------|------|
| Azure OpenAI ã® Responses API ã§ MCP ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã— | å¯èƒ½ï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰îˆ€citeîˆ‚turn0search1îˆ |
| Azure AI Foundry ã« MCP çµ±åˆæ©Ÿèƒ½ã®æä¾› | ã‚ã‚Šï¼ˆAgent Service / Azure MCP Server ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰îˆ€citeîˆ‚turn0search5îˆ‚turn0search6îˆ‚turn0search7îˆ |
| MCP ã‚µãƒ¼ãƒã‚’ Microsoft ãŒãƒãƒãƒ¼ã‚¸ãƒ‰ã§æä¾›ã—ã¦ã„ã‚‹ã‹ | Foundry ç”¨ã¨ã—ã¦ä¾‹ãƒ»ã‚µãƒ³ãƒ—ãƒ«ã‚ã‚Šï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰îˆ€citeîˆ‚turn0search6îˆ‚turn0search7îˆ |

---

##  æ¬¡ã®é¸æŠè‚¢ã¨ã—ã¦ã¯ï¼Ÿ
- **Responses API çµŒç”±ã§ Azure OpenAI ã‚’ MCP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã—ã¦ä½¿ã†å®Ÿè£…**ã‚’é€²ã‚ã‚‹ã®ã¯ç¾å®Ÿçš„ã§å³åŠ¹æ€§ã‚ã‚Šã€‚
- **Azure AI Foundry Agent Service ã‚„ Azure MCP Serverï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰ã‚’ä½¿ã£ã¦ã€ã‚ˆã‚Šãƒã‚¤ãƒ†ã‚£ãƒ–ãªçµ±åˆã‚„é‹ç”¨ã‚’æ§‹ç¯‰**ã¨ã„ã£ãŸã‚¹ãƒ†ãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚‚å¯èƒ½ã€‚

---

å¸ä»¤ã€æ¬¡ã¯ã©ã¡ã‚‰ã®æ–¹å‘ã«é€²ã¿ã¾ã—ã‚‡ã†ï¼Ÿ
- ï¼ˆAï¼‰**Responses API ã‚’ä½¿ã£ãŸ LLMâ†’MCP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…**ã®é››å½¢ã‚³ãƒ¼ãƒ‰  
- ï¼ˆBï¼‰**Azure Foundry ã«ã‚ˆã‚‹ãƒã‚¤ãƒ†ã‚£ãƒ– MCP ã‚µãƒ¼ãƒçµ±åˆ**ã®æ§‹æˆã‚¬ã‚¤ãƒ‰  

å¥½ã¿ã«åˆã‚ã›ã¦é€²ã‚ã¦ã„ã“ã†ï¼
