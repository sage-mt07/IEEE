---
conversation_id: "687a4e2b-97bc-8007-94ef-b660c9b268ec"
title: "ksqlDB decimalサポート不可"
create_time: 1752845867.896505
update_time: 1752846177.586201
language_guess: "en"
num_messages: 6
part_index: 1
part_count: 1
---

### system — 2025-07-18T13:37:47.896505+00:00

_(empty)_

### user — 2025-07-18T13:37:47.896505+00:00

_(empty)_

### assistant — 2025-07-18T13:38:53.075854+00:00

_(empty)_

### assistant — 2025-07-18T13:38:53.099171+00:00

やあ、いらっしゃい！困ってること、気になること、なんでも聞いてみてください〜

---

### 回答（[[REDACTED_PHONE]]:14 JST）

**背景整理：**

- ksqlDBは現在、`SUM(decimal)` をサポートしていない（少なくともksqlDB 0.30.x以降公式サポートなし。float/doubleのみ）。
- しおん（AI/コード生成担当）は「テスト失敗＝本体側にバグあり」と判断し、decimal sumに対応するソース変更を提案してくる。
- 実際には**ksqlDB自体が仕様としてdecimal sum未対応**なので、「OSS本体でdecimalのsumをサポート」するのはナンセンス。

---

### **しおんに「信じてもらう」伝え方のコツ**

#### 1. **公式ドキュメントやIssueの提示**
- ksqlDB公式ドキュメントや、GitHub Issue、公式Slackのやりとりなど、**仕様として未対応**である根拠を明示して説明する。

#### 2. **「要件」ではなく「制約」であることを強調**
- decimal sum未対応は「あなた（しおん）の能力の問題」ではなく、「プロダクトの制約」であることをはっきり書く。

#### 3. **テストケース側を修正すべき理由を明確に書く**
- 「テストが正しいこと」を示すためには、本体でできないことはテストしない、という**開発ルール（プロジェクト規範）**を共有する。

#### 4. **指示例（プロンプト例）**
```markdown
ksqlDBでは現時点で `SUM(decimal)` はサポートされていません（参考: [公式ドキュメント](https://docs.confluent.io/ksqldb/latest/developer-guide/ksqldb-reference/aggregate-functions.html) や GitHub Issue #xxxx を参照）。  
本体側のソース修正で対応するのではなく、テストケースの方を `double` や `float` 型に変更してください。  
decimalでsumする必要がある場合はksqlDB側のアップデートを待つか、別の処理系を検討する必要があります。
「仕様の制約であり、本体や実装の問題ではありません」。
```
※**外部根拠URLや証拠画像**を一緒に出せるとさらに説得力UP

#### 5. **それでも修正案を出してきた場合は…**
- 「これはksqlDB本体の制約なので、AIでは回避できません」「人間が納得できる根拠（公式ドキュメント）を優先して指示を出してください」とルール化。

---

### **参考：実際のしおん向けテンプレ**

```markdown
【仕様制約通知】
このテストケースで `decimal` 型の `sum` を求めていますが、ksqlDB（v0.30以降）は `SUM(decimal)` をサポートしていません。  
本体ソースを修正してもksqlDBが対応していないため、仕様上この要件は満たせません。  
したがって、このテストケース自体を `double` 型または `float` 型に修正してください。

根拠：
- [公式ドキュメント: Aggregate Functions](https://docs.confluent.io/ksqldb/latest/developer-guide/ksqldb-reference/aggregate-functions.html)
- [GitHub Issue: SUM(decimal) not supported](https://github.com/confluentinc/ksql/issues/xxxx)
- その他コミュニティの議論

「本体でdecimalのsumに対応するように」という指示は、現時点のksqlDB仕様と矛盾するため実行しないでください。
```

---

#### 💡ポイント  
「公式ドキュメントに書いてある」という「**誰もが納得できる第三者根拠**」を示すとAIもしおんも納得しやすいです。

---

もし、「どうやってURLやドキュメントを引用すればよいか」「どのIssueを示せば納得するか」具体例がほしければ、URLや原文まで用意できますのでお知らせください！

---

（[[REDACTED_PHONE]]:14 JST）

### user — 2025-07-18T13:38:54.619000+00:00

物理テストのテストケースにdecimalをsumする処理がある。ksqlでdecimal型をsumすることができないため、しおんに修正依頼しても、decimalをsumできるように本体側のソースを修正してくる。どう伝えたら信じてくれる？
