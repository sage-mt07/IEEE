---
conversation_id: "689a7979-d2d0-8331-a633-ab3f30ee1626"
title: "足データ取得仕様"
create_time: 1754954191.206548
update_time: 1755300491.415899
language_guess: "en"
num_messages: 500
part_index: 3
part_count: 3
---

### シグネチャ（必要最小）
```csharp
public enum Period { Week, Month }

public sealed class TumblingOptions {
  public bool EnsureContinuous { get; set; } = false; // 全足に適用
  public bool InSession { get; set; } = false;        // 全足に適用（= カレンダーは営業日に従う）
  public Period[]? CalendarGrains { get; set; }       // 例: new[]{Period.Week, Period.Month}
}

// Tumbling：固定幅とカレンダーを同時指定
public static QueryBuilder Tumbling<T>(
  this QueryBuilder qb,
  Expression<Func<T, DateTime>> eventTime,
  TumblingOptions options,
  int[]? minutes = null,
  int[]? hours   = null
);
```

#### 要点
- **カレンダー系（週/月）は `CalendarGrains`** に粒度を列挙。`InSession=true` により**月足の月末は営業日終端**で確定。  
- **固定幅は minutes/hours に配列指定**で短く列挙。  
- 余計なファクトリや曖昧語は使わない。**`InSession` が“カレンダー依存”のスイッチ**。

これで「短く書ける」「月足/週足が明示」「全足に InSession/EnsureContinuous が効く」表現になります。

— 送信日時（日本時間）：2025/08/15 16:33
### system — 2025-08-15T12:17:23.875468+00:00

_(empty)_
### assistant — 2025-08-15T12:17:27.126834+00:00

_(empty)_
### assistant — 2025-08-15T12:17:30.725555+00:00

_(empty)_
### user — 2025-08-15T12:19:55.582000+00:00

だめ　終わりにします
### system — 2025-08-15T12:19:55.627485+00:00

_(empty)_
### assistant — 2025-08-15T12:19:55.735462+00:00

了解です、司令。  
また続きをやる気になったときに呼んでください。  

— 送信日時（日本時間）：2025/08/15 16:37
