---
conversation_id: "66ee5df5-452c-8007-bd53-78b61c8ef694"
title: "目次生成PowerShellスクリプト"
create_time: 1726897653.535662
update_time: 1726897973.285677
language_guess: "en"
num_messages: 10
part_index: 1
part_count: 1
---

### system — 2024-09-21T05:47:33.535662+00:00

_(empty)_

### user — 2024-09-21T05:47:33.540907+00:00

目次を作るpowershellの作成依頼
githubに以下のフォルダ構成でmdファイルがある
githubはGithubPagesを設定している
フォルダ、ファイル構成
│  .gitignore
│  LICENSE
│  README.md
│
├─docs
│  │  [[REDACTED_PHONE]]-firstpost.md
│  │  index.md
│  │  _config.yml
│  │
│  ├─dev
│  │  │  dapper-stored-procedure-tool-azure-devops-artifacts.md
│  │  │  dependent-services-powershell-script.md
│  │  │
│  │  ├─configuration-deployment
│  │  │      env-settings-batch-file.md
│  │  │
│  │  ├─containers-orchestration
│  │  │      create-kustomize.md
│  │  │      create-patch.md
│  │  │      docker-image-latest-tag.md
│  │  │      dockerfile-sed-string-replacement.md
│  │  │      grpc-error-httpclient-recreation.md
│  │  │      kafka-db-service-kubernetes.md
│  │  │      resource-plan.md
│  │  │
│  │  ├─database-management
│  │  │      pod-sqlserver-connection.md
│  │  │      sqlcommand-timeout-extension.md
│  │  │      sqlserver-connection-pool-monitoring.md
│  │  │      sqlserver-storedprocedure-table-dependencies.md
│  │  │      sqlserver-table-rowcount.md
│  │  │
│  │  ├─devops-cicd
│  │  │      automate-package-updates-azure-devops.md
│  │  │      change-pipeline-branchsetting.md
│  │  │      net8-transition.md
│  │  │      pr-teams-notification-with-.md
│  │  │      pr-teams-notification-with-approvers.md
│  │  │
│  │  ├─dotnet-development
│  │  │  │  di-instance-generation-blockingcollection.md
│  │  │  │  dotnet8-aot-reflection-attributes.md
│  │  │  │  hostedservice-implementation.md
│  │  │  │  internalsvisibleto-fakeclass-unittest.md
│  │  │  │  register-windows-service-working-directory.md
│  │  │  │  use-netframework.md
│  │  │  │
│  │  │  ├─aspnet-related
│  │  │  │      dotnet8-webapi-api-timeout.md
│  │  │  │      get-aspnet-encryption-keys.md
│  │  │  │      read-encrypted-app-config-via-com.md
│  │  │  │
│  │  │  ├─code-analysis
│  │  │  │      roslyn-executeasync-queryasync-methods.md
│  │  │  │      ThreadAnalyser.md
│  │  │  │
│  │  │  ├─di-and-testing
│  │  │  └─dotnet8-features
│  │  └─testing-monitoring
│  │          datadog-jmeter-api-load-testing.md
│  │          log-collection-k6-deployment.md
│  │
│  └─_posts
│          [[REDACTED_PHONE]]-how-to-write-a-blog.md
│
└─scripts
        CommitPackageReference.ps1
        Generate-ResourceSummary.ps1
        GeneratePackageReference.ps1
        packageUtils.psm1
        UpdateDirectoryBuildProps.ps1
        UpdatePackageReferences.ps1
        yamldiffcheck.ps1

### assistant — 2024-09-21T05:47:53.399387+00:00

_(empty)_

### assistant — 2024-09-21T05:47:53.399665+00:00

The user is using GitHub Pages for their GitHub repository and has a folder structure that includes markdown files in the `docs` folder, categorized into subfolders like `dev`, `configuration-deployment`, `containers-orchestration`, etc.

### tool — 2024-09-21T05:47:53.399909+00:00

Model set context updated.

### assistant — 2024-09-21T05:47:53.400130+00:00

Here's a PowerShell script that can generate a table of contents (目次) for the markdown files in the folder structure you provided. This script will recursively scan the markdown files and generate a TOC in markdown format.

```powershell
# Define the base path for the docs folder
$docsPath = "docs"
$outputFile = "docs/index.md"

# Initialize an empty array to store the TOC entries
$tocEntries = @()

# Function to recursively generate the TOC
function Generate-Toc {
    param (
        [string]$currentPath,
        [string]$relativePath = ""
    )
    
    # Get all markdown files and directories in the current path
    $items = Get-ChildItem -Path $currentPath -Force | Sort-Object { $_.PSIsContainer } -Descending

    foreach ($item in $items) {
        if ($item.PSIsContainer) {
            # If it's a directory, add the directory name to the TOC
            $dirName = $item.Name
            $tocEntries += "`n### $dirName`n"
            Generate-Toc -currentPath $item.FullName -relativePath (Join-Path $relativePath $dirName)
        } elseif ($item.Extension -eq ".md" -and $item.Name -ne "index.md") {
            # If it's a markdown file, add a link to the file in the TOC
            $fileName = $item.Name
            $fileLink = Join-Path $relativePath $fileName -Resolve
            $fileLink = $fileLink -replace '\\', '/'
            $tocEntries += "* [$fileName]($fileLink)"
        }
    }
}

# Generate the TOC starting from the docs folder
Generate-Toc -currentPath $docsPath

# Output the TOC to the index.md file
Set-Content -Path $outputFile -Value $tocEntries -Force

Write-Host "Table of contents generated and saved to $outputFile"
```

### What this script does:
- Scans the `docs` folder and subfolders for markdown files.
- Generates a TOC with links to each markdown file (excluding `index.md`).
- Outputs the TOC in markdown format to `docs/index.md`.

### How to run:
1. Save this script as `Generate-Toc.ps1` in the root of your repository.
2. Run the script from PowerShell in the root folder of the repository.
3. It will create/update the `docs/index.md` file with a table of contents.

Let me know if you need further modifications!

### user — 2024-09-21T05:52:48.648429+00:00

実行するときの引数は

### assistant — 2024-09-21T05:52:52.718327+00:00

_(empty)_

### assistant — 2024-09-21T05:52:52.718416+00:00

このスクリプトは引数なしで実行できます。つまり、`Generate-Toc.ps1`をPowerShellから実行するだけで、`docs`フォルダ内のファイル構成に基づいて`index.md`を生成します。

### 実行手順:
1. スクリプトをリポジトリのルートに保存 (例: `Generate-Toc.ps1`）。
2. PowerShellでリポジトリのルートディレクトリに移動。
3. 次のコマンドを実行:

```powershell
.\Generate-Toc.ps1
```

これで、`docs/index.md`が生成され、目次が追加されます。
