---
conversation_id: "b366db1d-70fa-417c-be4d-6592a75f9ce0"
title: "K8s StatefulSet デプロイ管理"
create_time: 1716715114.783136
update_time: 1716715132.178813
language_guess: "en"
num_messages: 5
part_index: 1
part_count: 1
---

### system — 2024-05-26T09:18:34.783136+00:00

_(empty)_

### user — 2024-05-26T09:18:34.785053+00:00

k8sのstatefulsetとは

### assistant — 2024-05-26T09:18:51.369681+00:00

_(empty)_

### assistant — 2024-05-26T09:18:51.369869+00:00

Kubernetes（k8s）のStatefulSetは、ステートフルなアプリケーションのデプロイとスケーリングをサポートするためのリソースです。StatefulSetは、各ポッドに対して一意の永続的なアイデンティティを持つことを保証し、順序を持ってポッドを作成、削除、スケールします。これにより、データベースや分散システムなど、ステートフルなワークロードの管理が容易になります。

### StatefulSetの特徴

1. **ポッドの順序性**:
   - ポッドは番号付きで作成され、順序に従って停止されます。
   - 例えば、Pod-0、Pod-1、Pod-2のように作成され、この順序を維持します。

2. **一意のネットワークID**:
   - 各ポッドには、ステートフルなアプリケーションが他のポッドと通信できるように、ステーブルなネットワークIDが割り当てられます。

3. **永続ボリュームの管理**:
   - 各ポッドには、一意のPersistentVolume（永続ボリューム）が割り当てられ、ポッドのライフサイクル全体を通じてデータを保持します。
   - ポッドが削除され再作成されても、データは保持されます。

### StatefulSetのユースケース

StatefulSetは、以下のようなステートフルなアプリケーションに適しています。

- **データベース**:
  - MySQLやPostgreSQLなどのリレーショナルデータベース
- **分散ファイルシステム**:
  - Hadoop HDFS、GlusterFSなど
- **分散データベース**:
  - Cassandra、Etcdなど

### StatefulSetの基本的な構成例

```yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: example-statefulset
spec:
  serviceName: "example-service"
  replicas: 3
  selector:
    matchLabels:
      app: example
  template:
    metadata:
      labels:
        app: example
    spec:
      containers:
      - name: example
        image: example-image
        ports:
        - containerPort: 80
  volumeClaimTemplates:
  - metadata:
      name: example-pvc
    spec:
      accessModes: ["ReadWriteOnce"]
      resources:
        requests:
          storage: 1Gi
```

この例では、StatefulSetが3つのポッドを持ち、それぞれが独自の永続ボリュームを持つように設定されています。

StatefulSetは、ステートフルなアプリケーションの一貫性と可用性を維持するための強力なツールです。正しい使用方法を理解することで、Kubernetes上でのステートフルなワークロードの管理が容易になります。
