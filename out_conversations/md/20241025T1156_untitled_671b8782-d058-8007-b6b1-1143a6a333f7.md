---
conversation_id: "671b8782-d058-8007-b6b1-1143a6a333f7"
title: "アプリケーションデプロイとテスト"
create_time: 1729857411.041742
update_time: 1729858041.634102
language_guess: "en"
num_messages: 11
part_index: 1
part_count: 1
---

### system — 2024-10-25T11:56:51.041742+00:00

_(empty)_

### user — 2024-10-25T11:56:51.055146+00:00

今週のやり取りを事件列にリスト化して

### assistant — 2024-10-25T11:57:24.344852+00:00

_(empty)_

### assistant — 2024-10-25T11:57:24.344985+00:00

以下は、今週のやり取りを時系列でリスト化したものです。

1. **[[REDACTED_PHONE]]**
   - ユーザーはBlazor WebAssemblyを自己ホスト型アプリケーションとしてコンテナ環境で利用しています。
   - 同一ホスト名で複数のアプリケーションルートを使用し、リクエストを各コンテナにリダイレクトする構造を検討中です。
   - Web APIとBlazor WebAssemblyを同じコンテナ内でホストし、アプリケーションごとにホストしています。
   - `HTTP 429`エラーが発生しないことを述べました。
   - Entra IDの同時実行制限について質問し、Entra IDがHTTP/2を使用しているかどうか確認しました。

2. **[[REDACTED_PHONE]]**
   - Azure Load TestingのシナリオでEntra IDとAzure App Serviceにリクエストを送信しています。
   - JMeterのテストプランにおいて、2つのスレッドグループが順次実行され、1つはEntra IDの処理を行っています。
   - Graph APIのリクエスト制限について説明しました。
   - 2つ目のスレッドグループでバーストリクエストを実行することを希望しています。
   - AKS（Azure Kubernetes Service）を柔軟なIngress設定のために検討しています。

3. **[[REDACTED_PHONE]]**
   - コンテナアプリの逆プロキシを使用したアプリ構造の実装を検討しています。
   - 開発環境とはデスクトップPCを指していると説明しました。
   - デスクトップPCでNGINXを逆プロキシとして使用しています。
   - アプリのデプロイについて、サブディレクトリ配下での実行が不要であることを理解してもらうよう希望しています。
   - Visual Studioを使用した開発環境での事前デプロイチェックを期待しています。
   - Entra IDの登録情報の正確性もVisual Studioを使用して検証しています。
   - Windows Defender FirewallをNGINXおよびVisual Studioセットアップと組み合わせてリクエスト処理を行うことを検討しています。

4. **[[REDACTED_PHONE]]**
   - NGINXのリバースプロキシ設定で`<script src>`のロードに問題があることを発見しました。
   - `<base href="/" />`を変更せずにNGINX設定で対応する方法を模索しています。
   - CSSファイルが`wwwroot/css`ディレクトリに配置されています。
   - JavaScriptが`https://localhost:30000/WeatherForecast`というURLでWebAPIを呼び出しています。
   - コンテナアプリにおいて環境変数を使用してアプリ名を管理し、Azure Container Appsへのデプロイ時にパラメータとして渡すことを計画しています。
   - 共通のドメイン名を使用して、複数のアプリケーションを異なるURL（例: `https://www.example.com/app1`, `https://www.example.com/app2`）でホストする予定です。
   - Azure Load Testingを利用し、250スレッドでの実行時にログのタイムスタンプがミリ秒単位で一致しない問題に直面しました。
   - 250スレッド制限の原因がインスタンスに割り当てられたCPU制約にあると考えています。
   - ハードウェアのEOLに伴い、来年3月までにデータベースサーバーを新しいハードウェアに移行する必要があります。
   - データベースサーバーを使用しているアプリケーションもEOLに達するサーバー上で稼働しています。
   - 新しいサーバーの仕様を決定し、注文する必要があります。
   - 現在のデータベースサーバーがEOLに達するため、データベースサーバーのバージョンが変更される可能性についても検討しています。また、アプリケーションから更新後のデータベースサーバーへの接続要件も変更される可能性があります。
   - JMeterのスレッドグループを準備段階とメイン作業段階に分け、メイン作業段階でバーストリクエストを発生させる構成を取りました。

以上が、今週のやり取りを時系列にまとめたものです。

### user — 2024-10-25T12:05:31.451361+00:00

今週の反省会をおこないます

### assistant — 2024-10-25T12:05:37.896676+00:00

今週の反省会を始めましょう。以下の質問に答えていただければ、振り返りを深めるためのお手伝いができます。

1. **今週の達成点**: 今週うまくいったことや成果として感じていることは何ですか？
2. **今週の課題**: 今週直面した問題や、うまくいかなかったことはありましたか？
3. **改善のアイデア**: 来週に向けて改善したい点や試してみたい方法は何ですか？
4. **サポートが必要なこと**: 何かサポートが必要なことや、相談したいテーマがありますか？

これらのポイントに沿って話を進めると、振り返りがより具体的になります。

### user — 2024-10-25T12:07:07.637439+00:00

NGINXの件で   sub_filter '<base href="/"' '<base href="/app1/"';が必要なことが最後に判明した
この件を早期に解決するためにはどのような情報を付与すべきだったか

### assistant — 2024-10-25T12:07:20.759489+00:00

The user realized that using `sub_filter '<base href="/"' '<base href="/app1/"';` is necessary for their NGINX configuration.

### tool — 2024-10-25T12:07:20.759620+00:00

Model set context updated.

### assistant — 2024-10-25T12:07:20.759699+00:00

この件を早期に解決するために付与すべき情報として、以下の点が考えられます：

1. **アプリケーションのディレクトリ構造とNGINXの役割の明確化**:  
   - アプリケーションが`/app1/`のようなサブディレクトリ配下でホストされるのか、それともルートでホストされるのかの具体的な情報を最初に共有することで、`<base>`タグの調整が必要であることが推測しやすくなります。

2. **`<base>`タグの使用状況とその影響範囲の明確化**:  
   - アプリケーション内での`<base>`タグの役割と、NGINXを使ってどのようにURLをリダイレクトしようとしているか、具体的に説明することで、サブフィルタの使用の必要性を早期に検討できた可能性があります。

3. **NGINX設定の詳細情報**:  
   - 初期の段階でNGINXの設定ファイル内容を具体的に共有し、どのようにリバースプロキシを設定しようとしているかを示すことで、`sub_filter`によるURLの置換が考慮される可能性が高くなります。

これらの情報を早期に提供できていれば、NGINXの設定の問題に対して適切なフィードバックが得られ、解決が早まったかもしれません。次回似たような問題に直面した際は、これらのポイントを参考にするとよいでしょう。
