---
conversation_id: "653055cc-656c-4066-90d8-07e88c1b3ab1"
title: "Blazor & Web API Integration"
create_time: 1717080702.528498
update_time: 1717080789.558876
language_guess: "en"
num_messages: 7
part_index: 1
part_count: 1
---

### system — 2024-05-30T14:51:42.528498+00:00

_(empty)_

### user — 2024-05-30T14:51:42.530244+00:00

Blazor webassemblyとweb apiを同時にこうちくするプロジェクトテンプレートをvisual studio 2022で使用するには

### assistant — 2024-05-30T14:52:01.976451+00:00

_(empty)_

### assistant — 2024-05-30T14:52:01.976658+00:00

Visual Studio 2022でBlazor WebAssemblyとWeb APIを同時に構築するプロジェクトテンプレートを使用する方法は以下の通りです。

1. **Visual Studio 2022の起動**:
   - Visual Studio 2022を起動します。

2. **新しいプロジェクトの作成**:
   - 「新しいプロジェクトの作成」ボタンをクリックします。

3. **プロジェクトテンプレートの選択**:
   - プロジェクトテンプレートの一覧から「Blazor WebAssembly App」を検索します。検索バーに「Blazor」と入力すると見つけやすいです。

4. **テンプレートの構成**:
   - 「Blazor WebAssembly App」を選択し、「次へ」をクリックします。
   - プロジェクト名、場所、ソリューション名を入力し、「次へ」をクリックします。

5. **追加オプションの選択**:
   - 「Blazor WebAssembly Appの構成」画面で、「ASP.NET Core hosted」をチェックします。このオプションを選択すると、Blazor WebAssemblyプロジェクトとASP.NET Core Web APIプロジェクトが一緒に作成されます。
   - 認証タイプなど他のオプションも必要に応じて設定します。

6. **プロジェクトの作成**:
   - 「作成」ボタンをクリックしてプロジェクトを作成します。

これで、Blazor WebAssemblyとWeb APIが同時に構築されたプロジェクトが作成されます。作成されたソリューションには以下のプロジェクトが含まれています：

- **Client**: Blazor WebAssemblyのフロントエンドプロジェクト。
- **Server**: ASP.NET Core Web APIのバックエンドプロジェクト。
- **Shared**: クライアントとサーバーで共有するコードやモデルが含まれるプロジェクト。

これにより、Blazor WebAssemblyアプリケーションからWeb APIを呼び出すことができます。プロジェクトを実行するには、デフォルトの`Server`プロジェクトをスタートアッププロジェクトに設定し、実行します。ブラウザが開かれ、Blazor WebAssemblyアプリケーションが表示され、APIも動作していることが確認できます。

### user — 2024-05-30T14:52:30.809223+00:00

Visual studio 2022ではそのプロジェクトテンプレートは提供されていない

### assistant — 2024-05-30T14:53:08.241900+00:00

Visual Studio 2022でBlazor WebAssemblyとWeb APIを同時に構築するプロジェクトテンプレートが提供されていない場合、手動でプロジェクトを構築する方法をご紹介します。

### 手動でBlazor WebAssemblyとWeb APIを構築する手順

1. **新しいBlazor WebAssemblyプロジェクトの作成**:
   - Visual Studio 2022を起動し、「新しいプロジェクトの作成」ボタンをクリックします。
   - プロジェクトテンプレートの一覧から「Blazor WebAssembly App」を検索し、「次へ」をクリックします。
   - プロジェクト名、場所、ソリューション名を入力し、「次へ」をクリックします。
   - 認証などのオプションを設定し、「作成」ボタンをクリックします。

2. **ASP.NET Core Web APIプロジェクトの追加**:
   - ソリューションエクスプローラーでソリューションを右クリックし、「追加」→「新しいプロジェクト」を選択します。
   - 「ASP.NET Core Web API」を選択し、「次へ」をクリックします。
   - プロジェクト名を入力し、「作成」ボタンをクリックします。

3. **プロジェクト間の依存関係の設定**:
   - Blazor WebAssemblyプロジェクト（通常は「Client」という名前）を右クリックし、「プロジェクトの依存関係」を選択します。
   - 「プロジェクトの依存関係」ダイアログボックスで、Web APIプロジェクト（通常は「Server」という名前）に依存するように設定します。

4. **CORS設定の追加**:
   - Web APIプロジェクトの`Startup.cs`または`Program.cs`ファイルにCORS（Cross-Origin Resource Sharing）設定を追加します。
   - 以下のコードを追加して、Blazorアプリからのリクエストを許可します。

     ```csharp
     public void ConfigureServices(IServiceCollection services)
     {
         services.AddCors(options =>
         {
             options.AddDefaultPolicy(builder =>
             {
                 builder.WithOrigins("https://localhost:5001") // Blazor WebAssemblyのURL
                        .AllowAnyHeader()
                        .AllowAnyMethod();
             });
         });

         services.AddControllers();
         // 他のサービスの追加
     }

     public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
     {
         if (env.IsDevelopment())
         {
             app.UseDeveloperExceptionPage();
         }

         app.UseHttpsRedirection();
         app.UseRouting();
         app.UseCors();
         app.UseAuthorization();

         app.UseEndpoints(endpoints =>
         {
             endpoints.MapControllers();
         });
     }
     ```

5. **Blazor WebAssemblyプロジェクトでWeb APIを呼び出す**:
   - `HttpClient`を使用してWeb APIを呼び出すために、Blazor WebAssemblyプロジェクトの`Program.cs`ファイルを編集します。

     ```csharp
     builder.Services.AddScoped(sp => new HttpClient { BaseAddress = new Uri("https://localhost:5001/") });
     ```

6. **Web APIエンドポイントの作成**:
   - Web APIプロジェクトで、コントローラーを作成し、エンドポイントを定義します。

     ```csharp
     [ApiController]
     [Route("[controller]")]
     public class WeatherForecastController : ControllerBase
     {
         private static readonly string[] Summaries = new[]
         {
             "Freezing", "Bracing", "Chilly", "Cool", "Mild", "Warm", "Balmy", "Hot", "Sweltering", "Scorching"
         };

         private readonly ILogger<WeatherForecastController> _logger;

         public WeatherForecastController(ILogger<WeatherForecastController> logger)
         {
             _logger = logger;
         }

         [HttpGet]
         public IEnumerable<WeatherForecast> Get()
         {
             var rng = new Random();
             return Enumerable.Range(1, 5).Select(index => new WeatherForecast
             {
                 Date = DateTime.Now.AddDays(index),
                 TemperatureC = rng.Next(-20, 55),
                 Summary = Summaries[rng.Next(Summaries.Length)]
             })
             .ToArray();
         }
     }
     ```

7. **プロジェクトの実行**:
   - ソリューションエクスプローラーでソリューションを右クリックし、「複数のスタートアッププロジェクトの設定」を選択します。
   - Blazor WebAssemblyプロジェクトとWeb APIプロジェクトの両方をスタートアッププロジェクトとして設定します。
   - プロジェクトを実行すると、ブラウザが開き、Blazor WebAssemblyアプリケーションが表示され、APIも動作していることが確認できます。

以上の手順で、Blazor WebAssemblyとASP.NET Core Web APIを同時に構築するプロジェクトをVisual Studio 2022で作成できます。
