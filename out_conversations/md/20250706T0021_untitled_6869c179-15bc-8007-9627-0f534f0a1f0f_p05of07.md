---
conversation_id: "6869c179-15bc-8007-9627-0f534f0a1f0f"
title: "物理テストサポート"
create_time: 1751761273.214843
update_time: 1751888286.142466
language_guess: "en"
num_messages: 468
part_index: 5
part_count: 7
---

### tool — 2025-07-06T08:31:38.673391+00:00

[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v2.4.5+1caef2f33e (64-bit .NET 8.0.17)
[xUnit.net 00:00:00.41]   Discovering: Kafka.Ksql.Linq.Tests.Integration
[KSQL-LINQ INFO] ORDER BY in KSQL is limited to Pull Queries and specific scenarios. Push Queries (streaming) do not guarantee order due to distributed processing.
[KSQL-LINQ WARNING] JOIN performance optimization: Ensure topics 'orders' and 'customers' have same partition count and key distribution.
[KSQL-LINQ INFO] ORDER BY in KSQL is limited to Pull Queries and specific scenarios. Push Queries (streaming) do not guarantee order due to distributed processing.
[KSQL-LINQ INFO] ORDER BY in KSQL is limited to Pull Queries and specific scenarios. Push Queries (streaming) do not guarantee order due to distributed processing.
[KSQL-LINQ INFO] ORDER BY in KSQL is limited to Pull Queries and specific scenarios. Push Queries (streaming) do not guarantee order due to distributed processing.
[xUnit.net 00:00:01.05]   Discovered:  Kafka.Ksql.Linq.Tests.Integration
[xUnit.net 00:00:01.05]   Starting:    Kafka.Ksql.Linq.Tests.Integration
[xUnit.net 00:00:01.11]     Kafka.Ksql.Linq.Tests.Integration.DummyFlagMessageTests.SendAsync_AddsDummyFlagHeader [FAIL]
[xUnit.net 00:00:01.11]       Assert.Equal() Failure
[xUnit.net 00:00:01.11]                 ↓ (pos 0)
[xUnit.net 00:00:01.11]       Expected: true
[xUnit.net 00:00:01.11]       Actual:   True
[xUnit.net 00:00:01.11]                 ↑ (pos 0)
[xUnit.net 00:00:01.11]       Stack Trace:
[xUnit.net 00:00:01.11]         C:\Users\seiji_yfc8940\final\final\physicalTests\DummyFlagMessageTests.cs(110,0): at Kafka.Ksql.Linq.Tests.Integration.DummyFlagMessageTests.SendAsync_AddsDummyFlagHeader()
[xUnit.net 00:00:01.11]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.12]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, Region, SUM(Amount) AS TotalAmo"...) [FAIL]
[xUnit.net 00:00:01.12]       SELECT CustomerId, Region, SUM(Amount) AS TotalAmount, COUNT(*) AS OrderCount, AVG(Amount) AS AverageAmount FROM orders GROUP BY CustomerId, Region HAVING (((SUM(Amount) > 1000) AND (COUNT(*) > 10)) OR (AVG(Amount) > 150)) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 150: GROUP BY column 'REGION' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, Region, SUM(Amount) AS TotalAmount, COUNT(*) AS OrderCount, AVG(Amount) AS AverageAmount FROM orders GROUP BY CustomerId, Region HAVING (((SUM(Amount) > 1000) AND (COUNT(*) > 10)) OR (AVG(Amount) > 150)) EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.12]       Expected: True
[xUnit.net 00:00:01.12]       Actual:   False
[xUnit.net 00:00:01.12]       Stack Trace:
[xUnit.net 00:00:01.12]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.12]         --- End of stack trace from previous location ---
CREATE STREAM result: True, msg: [{"@type":"warning_entity","statementText":"CREATE STREAM IF NOT EXISTS source (id INT) WITH (KAFKA_TOPIC='source', VALUE_FORMAT='AVRO', PARTITIONS=1);","message":"Cannot add stream `SOURCE`: A stream with the same name already exists.","warnings":[]}]
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS ORDERS (CUSTOMERID INTEGER, ID INTEGER, REGION STRING, AMOUNT DECIMAL(38, 9), ISHIGHPRIORITY BOOLEAN, COUNT INTEGER) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS CUSTOMERS (ID INTEGER, NAME STRING) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='customers', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS EVENTS (LEVEL INTEGER, MESSAGE STRING) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='events', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS ORDERS_NULLABLE (CUSTOMERID INTEGER, REGION STRING, AMOUNT DECIMAL(38, 9)) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders_nullable', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
[xUnit.net 00:00:01.23]     Kafka.Ksql.Linq.Tests.Integration.SchemaNameCaseSensitivityTests.MismatchedFieldCase_ShouldThrowException [FAIL]
[xUnit.net 00:00:01.23]       System.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka connectivity.
[xUnit.net 00:00:01.23]       ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for OrderCorrectCase
[xUnit.net 00:00:01.23]       -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier schema for subject "orders-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (path '/name')', additionalInfo:'expected: OrderValue'}, {oldSchemaVersion: 1}, {oldSchema: '{"type":"record","name":"OrderValue","fields":[{"name":"CustomerId","type":"int"},{"name":"dummy","type":"string"}]}'}, {compatibility: 'BACKWARD'}]; error code: 409
[xUnit.net 00:00:01.23]       Stack Trace:
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:01.23]            at Kafka.Ksql.Linq.Tests.Integration.SchemaNameCaseSensitivityTests.OrderContext..ctor()
[xUnit.net 00:00:01.23]            at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
[xUnit.net 00:00:01.23]            at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
[xUnit.net 00:00:01.23]         ----- Inner Stack Trace -----
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(203,0): at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations)
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(151,0): at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration()
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(59,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:01.23]         ----- Inner Stack Trace -----
[xUnit.net 00:00:01.23]            at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
[xUnit.net 00:00:01.23]            at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
[xUnit.net 00:00:01.23]            at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:01.23]            at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(100,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, String avroSchema)
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(69,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entityType, AvroEntityConfiguration config)
[xUnit.net 00:00:01.23]     Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.Consumer_SkipsDummyMessages [FAIL]
[xUnit.net 00:00:01.23]       System.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka connectivity.
[xUnit.net 00:00:01.23]       ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for Order
[xUnit.net 00:00:01.23]       -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier schema for subject "orders-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (path '/name')', additionalInfo:'expected: OrderValue'}, {oldSchemaVersion: 1}, {oldSchema: '{"type":"record","name":"OrderValue","fields":[{"name":"CustomerId","type":"int"},{"name":"dummy","type":"string"}]}'}, {compatibility: 'BACKWARD'}]; error code: 409
[xUnit.net 00:00:01.23]       Stack Trace:
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:01.23]            at Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyContext..ctor()
[xUnit.net 00:00:01.23]            at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
[xUnit.net 00:00:01.23]            at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
[xUnit.net 00:00:01.23]         ----- Inner Stack Trace -----
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(203,0): at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations)
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(151,0): at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration()
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(59,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:01.23]         ----- Inner Stack Trace -----
[xUnit.net 00:00:01.23]            at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
[xUnit.net 00:00:01.23]            at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
[xUnit.net 00:00:01.23]            at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:01.23]            at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(100,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, String avroSchema)
[xUnit.net 00:00:01.23]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(69,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entityType, AvroEntityConfiguration config)
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS ORDERS_NULLABLE_KEY (CUSTOMERID INTEGER, AMOUNT DECIMAL(38, 9)) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders_nullable_key', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
CREATE STREAM result: True, msg: [{"@type":"warning_entity","statementText":"CREATE STREAM IF NOT EXISTS source (id INT) WITH (KAFKA_TOPIC='source', VALUE_FORMAT='AVRO', PARTITIONS=1);","message":"Cannot add stream `SOURCE`: A stream with the same name already exists.","warnings":[]}]
[xUnit.net 00:00:01.45]     Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyMessages_EnableQueries [FAIL]
[xUnit.net 00:00:01.45]       System.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka connectivity.
[xUnit.net 00:00:01.45]       ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for Order
[xUnit.net 00:00:01.45]       -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier schema for subject "orders-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (path '/name')', additionalInfo:'expected: OrderValue'}, {oldSchemaVersion: 1}, {oldSchema: '{"type":"record","name":"OrderValue","fields":[{"name":"CustomerId","type":"int"},{"name":"dummy","type":"string"}]}'}, {compatibility: 'BACKWARD'}]; error code: 409
[xUnit.net 00:00:01.45]       Stack Trace:
[xUnit.net 00:00:01.45]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:01.45]            at Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyContext..ctor()
[xUnit.net 00:00:01.45]            at InvokeStub_DummyContext..ctor(Object, Object, IntPtr*)
[xUnit.net 00:00:01.45]            at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
[xUnit.net 00:00:01.45]         ----- Inner Stack Trace -----
[xUnit.net 00:00:01.45]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(203,0): at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations)
[xUnit.net 00:00:01.45]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(151,0): at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration()
[xUnit.net 00:00:01.45]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(59,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:01.45]         ----- Inner Stack Trace -----
[xUnit.net 00:00:01.45]            at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
[xUnit.net 00:00:01.45]            at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
[xUnit.net 00:00:01.45]            at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:01.45]            at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:01.45]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(100,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, String avroSchema)
[xUnit.net 00:00:01.45]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(69,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entityType, AvroEntityConfiguration config)
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS ORDERS (CUSTOMERID INTEGER, ID INTEGER, REGION STRING, AMOUNT DECIMAL(38, 9), ISHIGHPRIORITY BOOLEAN, COUNT INTEGER) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS CUSTOMERS (ID INTEGER, NAME STRING) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='customers', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS EVENTS (LEVEL INTEGER, MESSAGE STRING) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='events', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS ORDERS_NULLABLE (CUSTOMERID INTEGER, REGION STRING, AMOUNT DECIMAL(38, 9)) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders_nullable', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
DDL result: False, msg: {"@type":"statement_error","error_code":40001,"message":"Tables require a PRIMARY KEY. Please define the PRIMARY KEY.","statementText":"CREATE TABLE IF NOT EXISTS ORDERS_NULLABLE_KEY (CUSTOMERID INTEGER, AMOUNT DECIMAL(38, 9)) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders_nullable_key', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","entities":[]}
[xUnit.net 00:00:01.61]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, Region, SUM(Amount) AS Total FR"...) [FAIL]
[xUnit.net 00:00:01.61]       SELECT CustomerId, Region, SUM(Amount) AS Total FROM orders GROUP BY CustomerId, Region HAVING (SUM(Amount) > 500) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 90: GROUP BY column 'REGION' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, Region, SUM(Amount) AS Total FROM orders GROUP BY CustomerId, Region HAVING (SUM(Amount) > 500) EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.61]       Expected: True
[xUnit.net 00:00:01.61]       Actual:   False
[xUnit.net 00:00:01.61]       Stack Trace:
[xUnit.net 00:00:01.61]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.61]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.62]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, SUM(Amount) AS Total, COUNT(*) "...) [FAIL]
[xUnit.net 00:00:01.62]       SELECT CustomerId, SUM(Amount) AS Total, COUNT(*) AS Count, AVG(Amount) AS Avg FROM orders GROUP BY CustomerId HAVING (((SUM(Amount) > 1000) AND (COUNT(*) > 5)) OR (AVG(Amount) > 500)) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 134: HAVING column 'AMOUNT' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, SUM(Amount) AS Total, COUNT(*) AS Count, AVG(Amount) AS Avg FROM orders GROUP BY CustomerId HAVING (((SUM(Amount) > 1000) AND (COUNT(*) > 5)) OR (AVG(Amount) > 500)) EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.62]       Expected: True
[xUnit.net 00:00:01.62]       Actual:   False
[xUnit.net 00:00:01.62]       Stack Trace:
[xUnit.net 00:00:01.62]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.62]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.63]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*) FROM orders;") [FAIL]
[xUnit.net 00:00:01.63]       SELECT COUNT(*) FROM orders; failed: {"@type":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT COUNT(*) FROM orders;","entities":[]}
[xUnit.net 00:00:01.63]       Expected: True
[xUnit.net 00:00:01.63]       Actual:   False
[xUnit.net 00:00:01.63]       Stack Trace:
[xUnit.net 00:00:01.63]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.63]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.63]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, Region, Amount FROM orders WHER"...) [FAIL]
[xUnit.net 00:00:01.63]       SELECT CustomerId, Region, Amount FROM orders WHERE Region NOT IN ('CN', 'RU') EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 61: WHERE column 'REGION' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, Region, Amount FROM orders WHERE Region NOT IN ('CN', 'RU') EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.63]       Expected: True
[xUnit.net 00:00:01.63]       Actual:   False
[xUnit.net 00:00:01.63]       Stack Trace:
[xUnit.net 00:00:01.63]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.63]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.65]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, SUM(Amount) AS Total, CASE WHEN"...) [FAIL]
[xUnit.net 00:00:01.65]       SELECT CustomerId, SUM(Amount) AS Total, CASE WHEN (SUM(Amount) > 1000) THEN 'VIP' ELSE 'Regular' END AS Status FROM orders GROUP BY CustomerId EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 32: SELECT column 'AMOUNT' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, SUM(Amount) AS Total, CASE WHEN (SUM(Amount) > 1000) THEN 'VIP' ELSE 'Regular' END AS Status FROM orders GROUP BY CustomerId EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.65]       Expected: True
[xUnit.net 00:00:01.65]       Actual:   False
[xUnit.net 00:00:01.65]       Stack Trace:
[xUnit.net 00:00:01.65]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.65]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.66]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT LATEST_BY_OFFSET(Id) AS Last FROM orders;") [FAIL]
[xUnit.net 00:00:01.66]       SELECT LATEST_BY_OFFSET(Id) AS Last FROM orders; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 33: SELECT column 'ID' cannot be resolved.","statementText":"EXPLAIN SELECT LATEST_BY_OFFSET(Id) AS Last FROM orders;","entities":[]}
[xUnit.net 00:00:01.66]       Expected: True
[xUnit.net 00:00:01.66]       Actual:   False
[xUnit.net 00:00:01.66]       Stack Trace:
[xUnit.net 00:00:01.66]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.66]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.66]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, SUM(Amount) AS TotalAmount, SUM"...) [FAIL]
[xUnit.net 00:00:01.66]       SELECT CustomerId, SUM(Amount) AS TotalAmount, SUM(Count) AS TotalCount FROM orders GROUP BY CustomerId HAVING ((SUM(Amount) > 1000) OR (SUM(Count) > 5)) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 126: HAVING column 'AMOUNT' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, SUM(Amount) AS TotalAmount, SUM(Count) AS TotalCount FROM orders GROUP BY CustomerId HAVING ((SUM(Amount) > 1000) OR (SUM(Count) > 5)) EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.66]       Expected: True
[xUnit.net 00:00:01.66]       Actual:   False
[xUnit.net 00:00:01.66]       Stack Trace:
[xUnit.net 00:00:01.66]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.66]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.77]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT UPPER(Region), SUM(Amount) AS TotalAmount F"...) [FAIL]
[xUnit.net 00:00:01.77]       SELECT UPPER(Region), SUM(Amount) AS TotalAmount FROM orders GROUP BY UPPER(Region) HAVING (SUM(Amount) > 500) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 85: GROUP BY column 'REGION' cannot be resolved.","statementText":"EXPLAIN SELECT UPPER(Region), SUM(Amount) AS TotalAmount FROM orders GROUP BY UPPER(Region) HAVING (SUM(Amount) > 500) EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.77]       Expected: True
[xUnit.net 00:00:01.77]       Actual:   False
[xUnit.net 00:00:01.77]       Stack Trace:
[xUnit.net 00:00:01.77]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.77]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.87]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, Region, SUM(Amount) AS Total FR"...) [FAIL]
[xUnit.net 00:00:01.87]       SELECT CustomerId, Region, SUM(Amount) AS Total FROM orders GROUP BY CustomerId, Region ORDER BY Total DESC EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"line 1:97: Syntax Error\n","statementText":"EXPLAIN SELECT CustomerId, Region, SUM(Amount) AS Total FROM orders GROUP BY CustomerId, Region ORDER BY Total DESC EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.87]       Expected: True
[xUnit.net 00:00:01.87]       Actual:   False
[xUnit.net 00:00:01.87]       Stack Trace:
[xUnit.net 00:00:01.87]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.87]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.96]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, AVG(Amount) AS AverageAmount, M"...) [FAIL]
[xUnit.net 00:00:01.96]       SELECT CustomerId, AVG(Amount) AS AverageAmount, MIN(Amount) AS MinAmount, MAX(Amount) AS MaxAmount FROM orders GROUP BY CustomerId EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 32: SELECT column 'AMOUNT' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, AVG(Amount) AS AverageAmount, MIN(Amount) AS MinAmount, MAX(Amount) AS MaxAmount FROM orders GROUP BY CustomerId EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.96]       Expected: True
[xUnit.net 00:00:01.96]       Actual:   False
[xUnit.net 00:00:01.96]       Stack Trace:
[xUnit.net 00:00:01.96]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.96]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.97]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, SUM(Amount) AS Total FROM order"...) [FAIL]
[xUnit.net 00:00:01.97]       SELECT CustomerId, SUM(Amount) AS Total FROM orders GROUP BY CustomerId ORDER BY Total DESC EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"line 1:81: Syntax Error\n","statementText":"EXPLAIN SELECT CustomerId, SUM(Amount) AS Total FROM orders GROUP BY CustomerId ORDER BY Total DESC EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:01.97]       Expected: True
[xUnit.net 00:00:01.97]       Actual:   False
[xUnit.net 00:00:01.97]       Stack Trace:
[xUnit.net 00:00:01.97]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.97]         --- End of stack trace from previous location ---
[xUnit.net 00:00:01.97]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, SUM(Amount) AS Total FROM Order"...) [FAIL]
[xUnit.net 00:00:01.97]       Assert.Contains() Failure
[xUnit.net 00:00:01.97]       Not found: Order
[xUnit.net 00:00:01.97]       In value:  List<String> ["orders", "customers", "events", "orders_nullable", "orders_nullable_key"]
[xUnit.net 00:00:01.97]       Stack Trace:
[xUnit.net 00:00:01.97]         C:\Users\seiji_yfc8940\final\final\physicalTests\TestSchema.cs(63,0): at Kafka.Ksql.Linq.Tests.Integration.TestSchema.ValidateDmlQuery(String query)
[xUnit.net 00:00:01.97]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(282,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:01.97]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.07]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT SUM(Amount) AS Sum FROM orders;") [FAIL]
[xUnit.net 00:00:02.07]       SELECT SUM(Amount) AS Sum FROM orders; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 20: SELECT column 'AMOUNT' cannot be resolved.","statementText":"EXPLAIN SELECT SUM(Amount) AS Sum FROM orders;","entities":[]}
[xUnit.net 00:00:02.07]       Expected: True
[xUnit.net 00:00:02.07]       Actual:   False
[xUnit.net 00:00:02.07]       Stack Trace:
[xUnit.net 00:00:02.07]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:02.07]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.07]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*) FROM customers;") [FAIL]
[xUnit.net 00:00:02.07]       SELECT COUNT(*) FROM customers; failed: {"@type":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT COUNT(*) FROM customers;","entities":[]}
[xUnit.net 00:00:02.07]       Expected: True
[xUnit.net 00:00:02.07]       Actual:   False
[xUnit.net 00:00:02.07]       Stack Trace:
[xUnit.net 00:00:02.07]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:02.07]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.27]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*) FROM orders_nullable_key;") [FAIL]
[xUnit.net 00:00:02.27]       SELECT COUNT(*) FROM orders_nullable_key; failed: {"@type":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT COUNT(*) FROM orders_nullable_key;","entities":[]}
[xUnit.net 00:00:02.27]       Expected: True
[xUnit.net 00:00:02.27]       Actual:   False
[xUnit.net 00:00:02.27]       Stack Trace:
[xUnit.net 00:00:02.27]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:02.27]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.28]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT EARLIEST_BY_OFFSET(Id) AS First FROM orders"...) [FAIL]
[xUnit.net 00:00:02.28]       SELECT EARLIEST_BY_OFFSET(Id) AS First FROM orders; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 35: SELECT column 'ID' cannot be resolved.","statementText":"EXPLAIN SELECT EARLIEST_BY_OFFSET(Id) AS First FROM orders;","entities":[]}
[xUnit.net 00:00:02.28]       Expected: True
[xUnit.net 00:00:02.28]       Actual:   False
[xUnit.net 00:00:02.28]       Stack Trace:
[xUnit.net 00:00:02.28]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:02.28]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.38]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, SUM(Amount) AS Total, SUM(CASE "...) [FAIL]
[xUnit.net 00:00:02.38]       SELECT CustomerId, SUM(Amount) AS Total, SUM(CASE WHEN IsHighPriority THEN Amount ELSE 0 END) AS HighPriorityTotal FROM orders GROUP BY CustomerId EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 32: SELECT column 'AMOUNT' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, SUM(Amount) AS Total, SUM(CASE WHEN IsHighPriority THEN Amount ELSE 0 END) AS HighPriorityTotal FROM orders GROUP BY CustomerId EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:02.38]       Expected: True
[xUnit.net 00:00:02.38]       Actual:   False
[xUnit.net 00:00:02.38]       Stack Trace:
[xUnit.net 00:00:02.38]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:02.38]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.39]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*) FROM orders_nullable;") [FAIL]
[xUnit.net 00:00:02.39]       SELECT COUNT(*) FROM orders_nullable; failed: {"@type":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT COUNT(*) FROM orders_nullable;","entities":[]}
[xUnit.net 00:00:02.39]       Expected: True
[xUnit.net 00:00:02.39]       Actual:   False
[xUnit.net 00:00:02.39]       Stack Trace:
[xUnit.net 00:00:02.39]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:02.39]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.50]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CustomerId, COUNT(*) AS Count FROM orders W"...) [FAIL]
[xUnit.net 00:00:02.50]       SELECT CustomerId, COUNT(*) AS Count FROM orders WHERE (Amount > 100) WINDOW TUMBLING (SIZE 5 MINUTES) GROUP BY CustomerId HAVING (COUNT(*) > 1) ORDER BY Key ASC EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"line 1:79: Syntax Error\n","statementText":"EXPLAIN SELECT CustomerId, COUNT(*) AS Count FROM orders WHERE (Amount > 100) WINDOW TUMBLING (SIZE 5 MINUTES) GROUP BY CustomerId HAVING (COUNT(*) > 1) ORDER BY Key ASC EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:02.50]       Expected: True
[xUnit.net 00:00:02.50]       Actual:   False
[xUnit.net 00:00:02.50]       Stack Trace:
[xUnit.net 00:00:02.50]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:02.50]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.72]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.CreateAllObjectsByOnModelCreating [FAIL]
[xUnit.net 00:00:02.72]       DDL failed: {"@type":"statement_error","error_code":40001,"message":"Could not determine output schema for query due to error: Line: 1, Col: 89: WHERE column 'AMOUNT' cannot be resolved.","statementText":"CREATE TABLE ORDERS_BY_REGION WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='ORDERS_BY_REGION', PARTITIONS=1, REPLICAS=1, RETENTION_MS=[[REDACTED_PHONE]]) AS SELECT\n  REGION REGION,\n  SUM(AMOUNT) TOTAL\nFROM ORDERS ORDERS\nWHERE (AMOUNT > 100)\nGROUP BY REGION\nEMIT CHANGES;","entities":[]}
[xUnit.net 00:00:02.72]       Expected: True
[xUnit.net 00:00:02.72]       Actual:   False
[xUnit.net 00:00:02.72]       Stack Trace:
[xUnit.net 00:00:02.72]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(252,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.CreateAllObjectsByOnModelCreating()
[xUnit.net 00:00:02.72]         --- End of stack trace from previous location ---
[xUnit.net 00:00:02.72]   Finished:    Kafka.Ksql.Linq.Tests.Integration
  Kafka.Ksql.Linq.Tests.Integration テスト 25 件のエラーで失敗しました (3.4 秒)
    C:\Users\seiji_yfc8940\final\final\physicalTests\DummyFlagMessageTests.cs(110): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DummyFlagMessageTests.SendAsync_AddsDummyFlagHeader (10ms): エラー メッセージ: Assert.Equal()
       Failure
                ↓ (pos 0)
      Expected: true
      Actual:   True
                ↑ (pos 0)
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DummyFlagMessageTests.SendAsync_AddsDummyFlagHeader() in C:\Users\seiji_yfc8940
      \final\final\physicalTests\DummyFlagMessageTests.cs:line 110
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT Customer
      Id, Region, SUM(Amount) AS TotalAmo"...) (12ms): エラー メッセージ: SELECT CustomerId, Region, SUM(Amount) AS TotalAmount, COUN
      T(*) AS OrderCount, AVG(Amount) AS AverageAmount FROM orders GROUP BY CustomerId, Region HAVING (((SUM(Amount) > 1000)
      AND (COUNT(*) > 10)) OR (AVG(Amount) > 150)) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"messa
      ge":"Line: 1, Col: 150: GROUP BY column 'REGION' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, Regio
      n, SUM(Amount) AS TotalAmount, COUNT(*) AS OrderCount, AVG(Amount) AS AverageAmount FROM orders GROUP BY CustomerId, Re
      gion HAVING (((SUM(Amount) > 1000) AND (COUNT(*) > 10)) OR (AVG(Amount) > 150)) EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.SchemaNameCaseSensitivityTests.MismatchedFieldCase_ShouldThrowException (131ms): エラー
      メッセージ: System.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without
       Kafka connectivity.
      ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for Orde
      rCorrectCase
      -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier sch
      ema for subject "orders-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (
      path '/name')', additionalInfo:'expected: OrderValue'}, {oldSchemaVersion: 1}, {oldSchema: '{"type":"record","name":"Or
      derValue","fields":[{"name":"CustomerId","type":"int"},{"name":"dummy","type":"string"}]}'}, {compatibility: 'BACKWARD'
      }]; error code: 409
      スタック トレース:
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 84
         at Kafka.Ksql.Linq.Tests.Integration.SchemaNameCaseSensitivityTests.OrderContext..ctor()
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
      ----- Inner Stack Trace -----
         at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations) in C:\Users\sei
      ji_yfc8940\final\final\src\KsqlContext.cs:line 203
         at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration() in C:\Users\seiji_yfc8940\final\final\
      src\KsqlContext.cs:line 151
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 59
      ----- Inner Stack Trace -----
         at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
         at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
         at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
         at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean no
      rmalize)
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, S
      tring avroSchema) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService
      .cs:line 100
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entity
      Type, AvroEntityConfiguration config) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchem
      aRegistrationService.cs:line 69
    C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.Consumer_SkipsDummyMessages (136ms): エラー メッセージ: Syste
      m.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka conne
      ctivity.
      ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for Orde
      r
      -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier sch
      ema for subject "orders-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (
      path '/name')', additionalInfo:'expected: OrderValue'}, {oldSchemaVersion: 1}, {oldSchema: '{"type":"record","name":"Or
      derValue","fields":[{"name":"CustomerId","type":"int"},{"name":"dummy","type":"string"}]}'}, {compatibility: 'BACKWARD'
      }]; error code: 409
      スタック トレース:
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 84
         at Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyContext..ctor()
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
      ----- Inner Stack Trace -----
         at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations) in C:\Users\sei
      ji_yfc8940\final\final\src\KsqlContext.cs:line 203
         at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration() in C:\Users\seiji_yfc8940\final\final\
      src\KsqlContext.cs:line 151
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 59
      ----- Inner Stack Trace -----
         at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
         at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
         at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
         at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean no
      rmalize)
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, S
      tring avroSchema) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService
      .cs:line 100
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entity
      Type, AvroEntityConfiguration config) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchem
      aRegistrationService.cs:line 69
    C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyMessages_EnableQueries (224ms): エラー メッセージ: Syste
      m.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka conne
      ctivity.
      ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for Orde
      r
      -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier sch
      ema for subject "orders-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (
      path '/name')', additionalInfo:'expected: OrderValue'}, {oldSchemaVersion: 1}, {oldSchema: '{"type":"record","name":"Or
      derValue","fields":[{"name":"CustomerId","type":"int"},{"name":"dummy","type":"string"}]}'}, {compatibility: 'BACKWARD'
      }]; error code: 409
      スタック トレース:
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 84
         at Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyContext..ctor()
         at InvokeStub_DummyContext..ctor(Object, Object, IntPtr*)
         at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
      ----- Inner Stack Trace -----
         at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations) in C:\Users\sei
      ji_yfc8940\final\final\src\KsqlContext.cs:line 203
         at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration() in C:\Users\seiji_yfc8940\final\final\
      src\KsqlContext.cs:line 151
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 59
      ----- Inner Stack Trace -----
         at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
         at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
         at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
         at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean no
      rmalize)
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, S
      tring avroSchema) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService
      .cs:line 100
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entity
      Type, AvroEntityConfiguration config) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchem
      aRegistrationService.cs:line 69
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT Customer
      Id, Region, SUM(Amount) AS Total FR"...) (6ms): エラー メッセージ: SELECT CustomerId, Region, SUM(Amount) AS Total FROM orders
      GROUP BY CustomerId, Region HAVING (SUM(Amount) > 500) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40
      001,"message":"Line: 1, Col: 90: GROUP BY column 'REGION' cannot be resolved.","statementText":"EXPLAIN SELECT Customer
      Id, Region, SUM(Amount) AS Total FROM orders GROUP BY CustomerId, Region HAVING (SUM(Amount) > 500) EMIT CHANGES;","ent
      ities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT Customer
      Id, SUM(Amount) AS Total, COUNT(*) "...) (7ms): エラー メッセージ: SELECT CustomerId, SUM(Amount) AS Total, COUNT(*) AS Count,
      AVG(Amount) AS Avg FROM orders GROUP BY CustomerId HAVING (((SUM(Amount) > 1000) AND (COUNT(*) > 5)) OR (AVG(Amount) >
      500)) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 134: HAVING column '
      AMOUNT' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, SUM(Amount) AS Total, COUNT(*) AS Count, AVG(A
      mount) AS Avg FROM orders GROUP BY CustomerId HAVING (((SUM(Amount) > 1000) AND (COUNT(*) > 5)) OR (AVG(Amount) > 500))
       EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*)
       FROM orders;") (6ms): エラー メッセージ: SELECT COUNT(*) FROM orders; failed: {"@type":"statement_error","error_code":40001,"m
      essage":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if y
      ou intended to issue a push query.","statementText":"EXPLAIN SELECT COUNT(*) FROM orders;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT Customer
      Id, Region, Amount FROM orders WHER"...) (7ms): エラー メッセージ: SELECT CustomerId, Region, Amount FROM orders WHERE Region N
      OT IN ('CN', 'RU') EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Line: 1, Col: 61: WHE
      RE column 'REGION' cannot be resolved.","statementText":"EXPLAIN SELECT CustomerId, Region, Amount FROM orders WHERE Re
      gion NOT IN ('CN', 'RU') EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT Customer
      Id, SUM(Amount) AS Total, CASE WHEN"...) (7ms): エラー メッセージ: SELECT CustomerId, SUM(Amount) AS Total, CASE WHEN (SUM(Amou
      nt) > 1000) THEN 'VIP' ELSE 'Regular' END AS Status FROM orders GROUP BY CustomerId EMIT CHANGES; failed: {"@type":"sta
      tement_error","error_code":40001,"message":"Line: 1, Col: 32: SELECT column 'AMOUNT' cannot be resolved.","statementTex
      t":"EXPLAIN SELECT CustomerId, SUM(Amount) AS Total, CASE WHEN (SUM(Amount) > 1000) THEN 'VIP' ELSE 'Regular' END AS St
      atus FROM orders GROUP BY CustomerId EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT LATEST_B
      Y_OFFSET(Id) AS Last FROM orders;") (10ms): エラー メッセージ: SELECT LATEST_BY_OFFSET(Id) AS Last FROM orders; failed: {"@type
      ":"statement_error","error_code":40001,"message":"Line: 1, Col: 33: SELECT column 'ID' cannot be resolved.","statementT
      ext":"EXPLAIN SELECT LATEST_BY_OFFSET(Id) AS Last FROM orders;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT Customer
      Id, SUM(Amount) AS TotalAmount, SUM"...) (6ms): エラー メッセージ: SELECT CustomerId, SUM(Amount) AS TotalAmount, SUM(Count) AS
       TotalCount FROM orders GROUP BY CustomerId HAVING ((SUM(Amount) > 1000) OR (SUM(Count) > 5)) EMIT CHANGES; failed: {"@
      type":"statement_error","error_code":40001,"message":"Line: 1, Col: 126: HAVING column 'AMOUNT' cannot be resolved.","s
      tatementText":"EXPLAIN SELECT CustomerId, SUM(Amount) AS TotalAmount, SUM(Count) AS TotalCount FROM orders GROUP BY Cus
      tomerId HAVING ((SUM(Amount) > 1000) OR (SUM(Count) > 5)) EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT UPPER(Re
      gion), SUM(Amount) AS TotalAmount F"...) (10ms): エラー メッセージ: SELECT UPPER(Region), SUM(Amount) AS TotalAmount FROM order
      s GROUP BY UPPER(Region) HAVING (SUM(Amount) > 500) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001
      ,"message":"Line: 1, Col: 85: GROUP BY column 'REGION' cannot be resolved.","statementText":"EXPLAIN SELECT UPPER(Regio
      n), SUM(Amount) AS TotalAmount FROM orders GROUP BY UPPER(Region) HAVING (SUM(Amount) > 500) EMIT CHANGES;","entities":
      []}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicK
The file is too long and its contents have been truncated.
### tool — 2025-07-06T08:31:38.673468+00:00

Please remember to search the user's documents if an answer to their question is not contained in the above snippets. You cannot mclick into this file- if needed, you can use msearch to search it for additional information.
### assistant — 2025-07-06T08:32:19.545417+00:00

司令さん、

詩音への指示文（テストコード・DDL・クエリ修正対応のため）を以下のように作成しました。参考にしてください。

---

# 詩音への指示文（例）

---

## 概要

現在、Kafka・ksqlDB連携の統合テストで以下の問題が発生しています。修正対応をお願いします。

1. Avroスキーマの名前不一致によるスキーマ登録失敗（`NAME_MISMATCH`エラー）
2. テーブル定義DDLに`PRIMARY KEY`が指定されていないため、作成失敗
3. クエリ中のカラム名やテーブル名の大文字小文字不一致によるカラム解決エラー
4. プルクエリで`GROUP BY`を使用していることによるエラー（`EMIT CHANGES`の不足）
5. `ORDER BY`句の誤用による構文エラー

---

## 修正内容
### 1. Avroスキーマ名の修正

- Avroスキーマの`name`属性は既存スキーマ`OrderValue`に合わせること。
- C#のエンティティクラス名も`OrderValue`など既存スキーマ名に合わせてください。
### 2. DDL文の`PRIMARY KEY`指定追加

- `CREATE TABLE`文に必ず`PRIMARY KEY`を付与してください。
- 例：

```sql
CREATE TABLE orders (
  CUSTOMERID INTEGER PRIMARY KEY,
  ID INTEGER,
  REGION STRING,
  AMOUNT DECIMAL(38,9),
  ISHIGHPRIORITY BOOLEAN,
  COUNT INTEGER
) WITH (...);
```
### 3. クエリの大文字小文字統一

- KSQLのテーブル・カラム名は大文字扱いのため、クエリ内のカラム名・テーブル名を大文字に修正してください。
- 例：`Region` → `REGION`
### 4. 集計クエリには必ず`EMIT CHANGES`を付与

- `GROUP BY`を含むクエリはすべて`EMIT CHANGES`を付けてプッシュクエリにしてください。
### 5. `ORDER BY`の使い方確認

- KSQLの制約を考慮し、`ORDER BY`句はPull Queryの範囲内で使用するか、構文エラーにならない形に修正してください。

---

## その他

- テスト実行前に対象のKafkaトピック、テーブル、スキーマ登録を削除して初期化処理を追加してください。
- Schema Registryの既存スキーマが残っていると衝突エラーになるため、テストセットアップ時にクリーンアップを必須としてください。

---

以上です。  
不明点あればすぐ確認してください。

[[REDACTED_PHONE]]:33 JST
### user — 2025-07-06T08:32:19.677000+00:00

詩音への指示文をおねがい
### assistant — 2025-07-06T08:51:07.048103+00:00

司令さん、

詩音さんへの指摘案を作成しました。ご確認ください。

---

## 指摘内容（詩音さん宛）

---

詩音さん、

最近のスキーマ登録処理の修正で、

```csharp
Name = $"{topicName}_value",
```

とされている箇所についてですが、これは問題があります。

理由は以下の通りです：

- Schema Registryのスキーマ名は**キー（key）と値（value）で別々に管理**されています。
- 通常、値スキーマの名前はKafkaトピックの「`{topicName}-value`」が正しい形式であり、  
  `Name`としては**トピック名に`_value`をつけるのは誤り**です。
- スキーマ互換性や既存登録スキーマとの整合性のため、`Name`は既存の`OrderValue`や`CustomerValue`など  
  **既に使われているスキーマ名に厳密に合わせる必要があります。**

そのため、`Name`の設定は

- トピック名に固定的に`_value`を付けるのではなく、
- 既存のスキーマ名や、Entityの定義に準拠する形で明示的に指定するか、
- 既存スキーマ名を取得・参照してそれを使う形にしてください。

この点を踏まえ、スキーマ登録処理の修正は見直しが必要です。  
現状のままだとスキーマ登録時に名前不一致でエラーとなり、テストが失敗する原因となっています。

---

必要に応じて、詩音さんからの設計意図や実装意図も確認しましょう。

よろしくお願いします。

---

[[REDACTED_PHONE]]:34 JST
### user — 2025-07-06T08:51:07.156000+00:00

詩音がschema登録処理を変更してる
Name = $"{topicName}_value",
この修正はまずい。
keyの部分があり、それに合わせてるはず
と指摘は下
### assistant — 2025-07-06T08:51:45.629248+00:00

司令さん、

詩音さんが戻したこのコードについても指摘文を用意しました。

---

## 追加指摘案

```csharp
var schema = new AvroSchema
{
    Type = "record",
    // Schema names align with the topic to avoid conflicts with key records
    Name = $"{topicName}_value",
    Namespace = $"{entityType.Namespace}.Avro",
    Fields = GenerateFieldsFromProperties(GetSchemaProperties(entityType))
};
```

この実装でスキーマ名を

```
Name = $"{topicName}_value"
```

としている点は、先の指摘の通り問題があります。

- Kafkaのスキーマ登録においては、スキーマ名は一般にトピック名の`-value`サフィックス（ハイフン）で命名されますが、  
  ここではアンダースコア`_value`を使っており、既存のスキーマ名と合わず名前不一致の原因になっています。

- さらに、スキーマ名は**既存スキーマ名（例: OrderValue, CustomerValue）に厳密に一致させる必要**があり、  
  トピック名をベースに動的に作る場合でも命名規則を守らなければなりません。

- もし`topicName`が`orders`の場合、スキーマ名は `"OrderValue"` のように PascalCase かつ既存に合わせるのが通例です。
### 対応案

- `Name`はハードコードもしくはEntity名に基づく命名規則に変更し、`topicName`を単純に置換するのをやめる。
- 例えば、`Order`エンティティなら `"OrderValue"`を使う。
- 既存スキーマの命名ルールを整理し、スキーマ登録処理に反映させる。

---

詩音さんの意図があればそちらも確認しつつ、上記の問題点は改めて共有いただくと良いかと思います。

[[REDACTED_PHONE]]:36 JST
### user — 2025-07-06T08:51:45.840000+00:00

var schema = new AvroSchema
        {
            Type = "record",
            // Schema names align with the topic to avoid conflicts with key records
            Name = $"{topicName}_value",
            Namespace = $"{entityType.Namespace}.Avro",
            Fields = GenerateFieldsFromProperties(GetSchemaProperties(entityType))
        };
戻った
### assistant — 2025-07-06T08:53:00.612236+00:00

司令さん、

承知しました！詩音さんへの指示文にコード修正とドキュメント追記の両方を含めた内容を用意しました。

---

# 詩音さんへの指示文（コード修正＋ドキュメント追記）

---

## 1. コード修正について

現在のスキーマ名生成部分

```csharp
var schema = new AvroSchema
{
    Type = "record",
    // Schema names align with the topic to avoid conflicts with key records
    Name = $"{topicName}_value",
    Namespace = $"{entityType.Namespace}.Avro",
    Fields = GenerateFieldsFromProperties(GetSchemaProperties(entityType))
};
```

この `Name = $"{topicName}_value"` は問題があります。

- Kafkaのスキーマ登録におけるスキーマ名は、トピック名をそのまま使うのではなく、  
  既存スキーマ（例: `OrderValue` や `CustomerValue`）に合わせた命名規則を守る必要があります。

- 現状、アンダースコア`_value`を付けていますが、スキーマ名と不一致になるため、登録時に名前の不一致（`NAME_MISMATCH`）エラーが発生しています。
### 修正案

- `Name`はエンティティ名に基づき、PascalCaseで `OrderValue` や `CustomerValue` のように正しく命名すること。  
- 具体的には、`topicName`からPascalCaseのエンティティ名を生成し、`Value`を付加するなどのルールに統一してください。

---

## 2. ドキュメント追記について

このスキーマ名命名規則の重要性を、ドキュメント（設計書や開発ガイド）に明確に記載してください。

記載例の骨子は以下の通りです。

- **スキーマ名命名規則**  
  Kafkaのスキーマ登録では、スキーマ名はKafkaトピック名を単純に使うのではなく、  
  エンティティ名に基づきPascalCaseで `EntityValue` の形式に統一する。  
  例：`orders`トピック → スキーマ名 `OrderValue`。

- **互換性維持のための注意点**  
  スキーマ名が不一致の場合、Schema Registryで`NAME_MISMATCH`エラーが発生し、登録できなくなるため注意が必要。  
  既存のスキーマ命名と厳密に合わせること。

- **変更時の影響**  
  スキーマ名の変更は互換性に重大な影響を及ぼすため、コード・スキーマ双方での厳格な管理を推奨。

---

この修正とドキュメント追記をセットで完了させ、テストの正常通過を目指してください。

---

ご質問や詳細確認があればお知らせください。

[[REDACTED_PHONE]]:36 JST
### user — 2025-07-06T08:53:00.665000+00:00

これはドキュメントにも書くべき事項ですね
詩音への指示内容に、コードの修正、ドキュメントの修正を合わせてください
### assistant — 2025-07-06T08:53:40.853336+00:00

司令さん、

おっしゃる通りです。このルールだと、異なるトピックであっても同じエンティティ名を使うとスキーマ名が重複し、Schema Registry上で衝突の可能性が出てきますね。

---
### 問題点
- **スキーマ名はSchema Registryの「名前空間」で識別されるため、名前が重複するとコンフリクトが発生する。**
- 複数のトピックで同じエンティティ名が使われている場合、例えば `OrderValue` が異なるスキーマとして存在できない。
- これにより、誤登録や不整合、破壊的な変更につながるリスクがある。

---
### 対応案

1. **名前空間（Namespace）を有効活用する**  
   - スキーマ名は同じでも、Namespaceで区別する設計にする。  
   - 例：`com.mycompany.orders.OrderValue` と `com.mycompany.billing.OrderValue` のようにNamespaceを分ける。  
   - ただし、Namespaceをきちんと管理・運用できる体制が必要。

2. **トピック名をスキーマ名に含める工夫**  
   - スキーマ名にトピック名の一部や接頭辞を加えてユニーク化する。  
   - 例：`OrdersOrderValue` や `BillingOrderValue` など。  
   - 多少命名が冗長になるが、衝突回避しやすい。

3. **プロジェクトやドメイン単位でスキーマ管理ルールを定義**  
   - 利用ドメインごとにプレフィックスや命名規則を設ける。  
   - ドメイン間で名前被りを防止。

---
### ドキュメントに書くべき内容例

- **スキーマ名の一意性担保についての注意喚起**  
- **名前空間活用の運用ルール**  
- **同一名前のスキーマを登録する場合の対処法と影響範囲**  

---

必要なら、具体的な命名規則サンプルやガイドライン策定もお手伝いしますのでご指示ください。

[[REDACTED_PHONE]]:36 JST
### user — 2025-07-06T08:53:40.911000+00:00

これのルールの場合、ユーザーが同じオブジェクト命名をする可能性がありうる
### assistant — 2025-07-06T08:54:09.208189+00:00

司令さん、

以下、詩音への指示文（コード修正＋ドキュメント修正）を全文でご提案します。

---

# 詩音への指示文（コード修正・ドキュメント修正）

## 1. コード修正について

現在のスキーマ登録処理において、

```csharp
var schema = new AvroSchema
{
    Type = "record",
    // Schema names align with the topic to avoid conflicts with key records
    Name = $"{topicName}_value",
    Namespace = $"{entityType.Namespace}.Avro",
    Fields = GenerateFieldsFromProperties(GetSchemaProperties(entityType))
};
```

のように、スキーマ名にトピック名を含めている修正はやめてください。

理由は以下の通りです。

- スキーマの `Name` はSchema Registry上でスキーマの名前空間の一部となり、スキーマの一意性を担保します。
- ここにトピック名を含めると、同じエンティティ名で複数トピックが存在する場合にスキーマの重複・競合を生みやすくなります。
- スキーマ名は **エンティティ名（クラス名）に対応させ、Namespaceで区別する** のが標準的な設計です。

したがって、

- `Name` はエンティティ名（例：`OrderValue`など）に戻してください。
- `Namespace` はエンティティの名前空間を基に適切に設定し、スキーマのユニーク性・区別性を保つ役割としてください。

---

## 2. ドキュメント修正について

この設計ルールに関する注意事項をドキュメントに追記してください。
### 追記例（ドキュメントの該当箇所）

```### Avroスキーマ命名規則とSchema Registry登録について

- スキーマ名（Name）はエンティティのクラス名に対応させること。  
- Namespaceはエンティティの名前空間を反映し、スキーマの一意性を担保するために重要。  
- スキーマ名にトピック名を含める設計は推奨しません。これにより同じエンティティ名で複数トピックが存在する場合、Schema Registryで名前衝突や互換性エラーが発生する可能性があります。  
- 名前空間の管理が不十分な場合、トピック名などの接頭辞を名前空間に含める運用も検討できますが、運用ルールを明確に定めてください。  
- ユーザーが同一クラス名を使う場合の衝突リスクを理解し、スキーマ管理体制を整備する必要があります。

以上の点を遵守することで、Schema Registryでのスキーマ登録エラーを防ぎ、安定したKafka・ksqlDB連携を実現します。
```

---

## 3. 今後の運用提案

- ユーザー向けに「スキーマ命名ルール・Namespace運用ルール」のガイドラインを別途作成し配布すること。  
- 必要に応じて、スキーマ名衝突を検知するCIチェックを追加すること。  

---

以上を踏まえた上で、コード修正とドキュメント修正をお願いします。

---

必要あれば具体的なコード例・ドキュメントMarkdownも作成しますのでお知らせください。

[[REDACTED_PHONE]]:36 JST
### user — 2025-07-06T08:54:09.348000+00:00

修正来の全文をおねがい
### assistant — 2025-07-06T08:59:15.663179+00:00

司令さん、

詩音が記載した以下の内容は非常に的確で、シンプルにポイントがまとめられていて良いと思います。

---
### 3.4 Avroスキーマ命名規則と Namespace 管理

- スキーマの `Name` は **エンティティのクラス名** に対応させます。  
- `Namespace` にはエンティティの名前空間を反映し、スキーマの一意性を担保します。  
- トピック名を `Name` に含める設計は推奨されません。同一クラス名を複数トピックで使用する場合、Schema Registry 上で名前衝突が発生する可能性が高まります。  
- 名前空間管理が不十分な場合は、トピック名などの接頭辞を `Namespace` 側に取り込む運用も検討してください。  
- ユーザーは同一クラス名を再利用する際の衝突リスクを理解し、スキーマ管理体制を整備する必要があります。

---
### 評価ポイント

- **簡潔かつ要点が明確**  
  必要な注意点を漏らさず簡潔にまとめています。  
- **設計上のベストプラクティスに沿っている**  
  スキーマ名はエンティティ名に合わせる、Namespaceで一意性を担保する、など標準的な設計思想を守っています。  
- **運用の注意点も含む**  
  名前空間管理が難しい場合の代替策や、ユーザー向けのリスク認識も示しているため実践的です。  
- **ユーザーに意識を促す文言がある**  
  同一クラス名の再利用による衝突リスクの理解と管理体制整備を促す文言は非常に重要です。

---
### 追加提案（あれば）

もし加えるなら、

- 「Schema Registryの互換性ルール（BACKWARDなど）との関連」や  
- 「スキーマ名変更が互換性に与える影響」  

にも軽く触れるとより親切かもしれません。  
ただし、現状の内容でも十分に的を射ていると思います。

---

まとめると、詩音のドキュメント記載は非常に適切であり、そのまま正式ドキュメントに組み込んで問題ない水準と評価します。

ご参考になれば幸いです。

[[REDACTED_PHONE]]:49 JST
### user — 2025-07-06T08:59:15.855000+00:00
### 3.4 Avroスキーマ命名規則と Namespace 管理

- スキーマの `Name` は **エンティティのクラス名** に対応させます。
- `Namespace` にはエンティティの名前空間を反映し、スキーマの一意性を担保します。
- トピック名を `Name` に含める設計は推奨されません。同一クラス名を複数トピックで使用する場合、Schema Registry 上で名前衝突が発生する可能性が高まります。
- 名前空間管理が不十分な場合は、トピック名などの接頭辞を `Namespace` 側に取り込む運用も検討してください。
- ユーザーは同一クラス名を再利用する際の衝突リスクを理解し、スキーマ管理体制を整備する必要があります。
と詩音が記載した　評価して
### user — 2025-07-06T09:05:16.809000+00:00

この修正の場合、keyとのバッティング防止はどうなっている？
コピーする
AvroSchemaBuilder では値用スキーマを生成する際、record 名をエンティティ型名に戻しました。該当箇所は GenerateValueSchema<T>() で確認できます。

public string GenerateValueSchema<T>() where T : class
{
    var entityType = typeof(T);

    var schema = new AvroSchema
    {
        Type = "record",
        // Name should correspond to the entity type for Schema Registry compatibility
        Name = entityType.Name,
        Namespace = $"{entityType.Namespace}.Avro",
        Fields = GenerateFieldsFromProperties(GetSchemaProperties(entityType))
    };

    return SerializeSchema(schema);
}

キー側は UnifiedSchemaGenerator.GenerateKeySchema() で生成され、複合キーの場合は "CompositeKey"、単一キーの場合は <KeyType>Name + "Key" という別名を使用します。

var schema = new AvroSchema
{
    Type = "record",
    Name = $"{keyType.Name}Key",
    Namespace = keyType.Namespace ?? "Kafka.Ksql.Linq.Generated",
    Fields = GenerateFields(keyType)
};

これらはそれぞれ topic-name-value と topic-name-key という別々のサブジェクト名で登録されるため、値スキーマ名をエンティティ型に戻してもキー用スキーマと衝突しません。また、Namespace にエンティティの名前空間を付与しているため、同名クラスが別の名前空間に存在しても区別できます。ドキュメントではこのルールを明記しています。
### 3.4 Avroスキーマ命名規則と Namespace 管理
- スキーマの `Name` は **エンティティのクラス名** に対応させます。
- `Namespace` にはエンティティの名前空間を反映し、スキーマの一意性を担保します。
- トピック名を `Name` に含める設計は推奨されません。同一クラス名を複数トピックで使用する場合、Schema Registry 上で名前衝突が発生する可能性が高まります。

したがって、値スキーマ名をエンティティ名へ戻した後も、キーとのバッティングは

生成されるキー用スキーマ名が異なること、

サブジェクト名が -key と -value で分かれていること、

Namespace で区別されること、
の3点により避けられています。
### assistant — 2025-07-06T09:05:17.148386+00:00

司令さん、

ご指摘の「値スキーマ名をエンティティ型名（クラス名）に戻した場合、key用とのバッティングはどう防ぐのか？」という点、整理した内容を下記にまとめます。

---
### 【結論】

**キー用スキーマと値用スキーマは「Avroレコード名」「Namespace」「サブジェクト名」の3層で分離されているため、バッティングは起きません。**

---
### 【詳細な理由・ポイント】

#### 1. **スキーマ名の付与規則**
- **値用（Value）スキーマ**  
  - `Name`: エンティティ型名（例：Order）
  - `Namespace`: エンティティのNamespace＋".Avro"
- **キー用（Key）スキーマ**  
  - 単一キー型: `<KeyType>Name + "Key"`（例：OrderKey）
  - 複合キー: 固定名 `"CompositeKey"`
  - `Namespace`: キー型のNamespace or デフォルト

#### 2. **Schema Registryサブジェクト名**
- サブジェクト名は  
  `topic-name-value`（値）  
  `topic-name-key`（キー）  
  という *異なるサブジェクト名* で管理される。
- つまり、同じAvroスキーマ名（Order）が複数サブジェクトで使われても、物理的には「Order-value」「Order-key」と完全分離されている。

#### 3. **Namespace管理**
- 仮に同名クラスが複数プロジェクトやモジュールに存在しても、`Namespace`が異なればAvroスキーマも区別される。
- *値スキーマ名=Order* としても  
  `Namespace="A.B.C.Avro"`、`Namespace="X.Y.Z.Avro"` のように区分される。

#### 4. **実装上の衝突防止**
- 値・キーのAvro record名が違う  
- サブジェクト名（`-key`/`-value` suffix）も違う  
- Namespaceも違う  
→ **三重の分離**で実質バッティングは発生しない。

---
### 【ドキュメント例文案】

> 値スキーマとキー用スキーマは、それぞれ以下のルールで分離されます。  
> - **値スキーマ**はエンティティ型名＋Namespace、**キー用スキーマ**は `Key` サフィックスや `CompositeKey` でRecord名を分けます。  
> - Schema Registryでは `topic-name-value`、`topic-name-key` というサブジェクト名で管理され、バッティングは起きません。  
> - 同名クラスが存在しても、Namespaceが異なれば衝突は発生しません。  
> 
> したがって、値スキーマのrecord名をエンティティ名に戻しても、keyスキーマとの衝突・バッティングは発生しません。

---

必要に応じて、今後のドキュメントにこの説明を含めると、さらに安心感を与えられると思います。

[[REDACTED_PHONE]]:15 JST
### system — 2025-07-06T09:05:28.772765+00:00

_(empty)_
### user — 2025-07-06T09:46:08.669000+00:00

この状態
### assistant — 2025-07-06T09:46:09.175121+00:00

【[[REDACTED_PHONE]]:42 JST】

現状のテスト実行ログ（[xUnit.net VST.txt]）を確認しました。  
スキーマの削除処理で「Failed to delete schema 〇〇: NotFound」が繰り返し出ていますが、**バッティングや衝突は発生していません**。  
ただし「events-value」スキーマ登録時に `NAME_MISMATCH` エラーが出ています。これは「新旧スキーマの `name` が違う」ことによるコンフリクトで、スキーマ名の命名規則見直しが効いている証拠です。

**key/valueのバッティング防止策について**
- valueスキーマ：`Name=エンティティ型名`, `Namespace=型のNamespace.Avro`
- keyスキーマ　：`Name=Key型名 + "Key"` または "CompositeKey", `Namespace=型のNamespace`
- サブジェクト名は `-key` / `-value` で明確に分離
- Namespaceで完全分離できる

**これにより：**
- valueの `ORDERS` スキーマと keyの `ORDERSKey` スキーマは登録名・サブジェクトともに衝突しません。
- ユーザーが同一クラス名を別の用途で再利用しても、Namespaceが異なればバッティングを避けられます。

**ログからの指摘事項：**
- 「ORDERS_NULLABLE」「CUSTOMERS」などのTable再作成時に既存テーブル検出でWarning（正常挙動）
- 「events-value」スキーマでのみ既存スキーマとのNAME_MISMATCHエラー（Schema Registry互換性違反）

**ドキュメント追記推奨ポイント：**
- valueスキーマ/ keyスキーマの命名・サブジェクト分離
- 過去スキーマ互換性に関する注意点（特に `name` フィールドの変更禁止）
- 既存スキーマ流用時のマイグレーション指針

**まとめ：**
- 現状の設計は「key/valueのバッティング防止」「Namespaceによる分離」が担保されています。
- ただし過去のスキーマ資産との互換性（特に `name` フィールド）は十分に注意してください。  
- ドキュメントには「Schema Registry上で `name` は変更不可」「互換性維持の責任はユーザーにある」と明記すべきです。

何か追加で確認したい観点があればご指示ください。
### tool — 2025-07-06T09:46:20.517160+00:00

_(empty)_
### tool — 2025-07-06T09:46:20.517337+00:00

Kafka.Ksql.Linq 成功しました (0.2 秒) → C:\Users\seiji_yfc8940\final\final\src\bin\Debug\net8.0\Kafka.Ksql.Linq.dll
  Kafka.Ksql.Linq.Tests.Integration 成功しました (0.1 秒) → bin\Debug\net8.0\Kafka.Ksql.Linq.Tests.Integration.dll
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v2.4.5+1caef2f33e (64-bit .NET 8.0.17)
[xUnit.net 00:00:00.26]   Discovering: Kafka.Ksql.Linq.Tests.Integration
[KSQL-LINQ WARNING] JOIN performance optimization: Ensure topics 'orders' and 'customers' have same partition count and key distribution.
[xUnit.net 00:00:00.88]   Discovered:  Kafka.Ksql.Linq.Tests.Integration
[xUnit.net 00:00:00.88]   Starting:    Kafka.Ksql.Linq.Tests.Integration
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:03.42]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*) FROM ORDERS_NULLABLE_KEY;") [FAIL]
[xUnit.net 00:00:03.42]       SELECT COUNT(*) FROM ORDERS_NULLABLE_KEY; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE_KEY does not exist.","statementText":"EXPLAIN SELECT COUNT(*) FROM ORDERS_NULLABLE_KEY;","entities":[]}
[xUnit.net 00:00:03.42]       Expected: True
[xUnit.net 00:00:03.42]       Actual:   False
[xUnit.net 00:00:03.42]       Stack Trace:
[xUnit.net 00:00:03.42]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:03.42]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:03.93]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMERID, AVG(AMOUNT) AS AVERAGEAMOUNT, M"...) [FAIL]
[xUnit.net 00:00:03.93]       SELECT CUSTOMERID, AVG(AMOUNT) AS AVERAGEAMOUNT, MIN(AMOUNT) AS MINAMOUNT, MAX(AMOUNT) AS MAXAMOUNT FROM ORDERS GROUP BY CUSTOMERID EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Function 'avg' does not accept parameters (DECIMAL(38, 9)).\nValid alternatives are:\navg(DOUBLE val1)\navg(INT val1)\navg(BIGINT val1)\nFor detailed information on a function run: DESCRIBE FUNCTION <Function-Name>;","statementText":"EXPLAIN SELECT CUSTOMERID, AVG(AMOUNT) AS AVERAGEAMOUNT, MIN(AMOUNT) AS MINAMOUNT, MAX(AMOUNT) AS MAXAMOUNT FROM ORDERS GROUP BY CUSTOMERID EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:03.93]       Expected: True
[xUnit.net 00:00:03.93]       Actual:   False
[xUnit.net 00:00:03.93]       Stack Trace:
[xUnit.net 00:00:03.93]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:03.93]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:04.29]     Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.Consumer_SkipsDummyMessages [FAIL]
[xUnit.net 00:00:04.29]       System.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka connectivity.
[xUnit.net 00:00:04.30]       ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for EventLog
[xUnit.net 00:00:04.30]       -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier schema for subject "events-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (path '/name')', additionalInfo:'expected: io.confluent.ksql.avro_schemas.KsqlDataSourceSchema'}, {oldSchemaVersion: 1}, {oldSchema: '{"type":"record","name":"KsqlDataSourceSchema","namespace":"io.confluent.ksql.avro_schemas","fields":[{"name":"LEVEL","type":["null","int"],"default":null},{"name":"MESSAGE","type":["null","string"],"default":null}],"connect.name":"io.confluent.ksql.avro_schemas.KsqlDataSourceSchema"}'}, {compatibility: 'BACKWARD'}]; error code: 409
[xUnit.net 00:00:04.30]       Stack Trace:
[xUnit.net 00:00:04.30]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:04.30]            at Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyContext..ctor()
[xUnit.net 00:00:04.30]            at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
[xUnit.net 00:00:04.30]            at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
[xUnit.net 00:00:04.30]         ----- Inner Stack Trace -----
[xUnit.net 00:00:04.30]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(203,0): at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations)
[xUnit.net 00:00:04.30]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(151,0): at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration()
[xUnit.net 00:00:04.30]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(59,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:04.30]         ----- Inner Stack Trace -----
[xUnit.net 00:00:04.30]            at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
[xUnit.net 00:00:04.30]            at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
[xUnit.net 00:00:04.30]            at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:04.30]            at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:04.30]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(100,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, String avroSchema)
[xUnit.net 00:00:04.30]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(69,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entityType, AvroEntityConfiguration config)
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
%3|[[REDACTED_PHONE]]|FAIL|ksql-dsl-client-admin#producer-1| [thrd:kafka:9092/1]: kafka:9092/1: Failed to resolve 'kafka:9092':    ̂悤 ȃz X g ͕s   ł  B  (after 2745ms in state CONNECT)
%3|[[REDACTED_PHONE]]|ERROR|ksql-dsl-client-admin#producer-1| [thrd:app]: ksql-dsl-client-admin#producer-1: kafka:9092/1: Failed to resolve 'kafka:9092':    ̂悤 ȃz X g ͕s   ł  B  (after 2745ms in state CONNECT)
[xUnit.net 00:00:05.42]     Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyMessages_EnableQueries [FAIL]
[xUnit.net 00:00:05.42]       System.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka connectivity.
[xUnit.net 00:00:05.42]       ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for EventLog
[xUnit.net 00:00:05.42]       -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier schema for subject "events-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (path '/name')', additionalInfo:'expected: io.confluent.ksql.avro_schemas.KsqlDataSourceSchema'}, {oldSchemaVersion: 1}, {oldSchema: '{"type":"record","name":"KsqlDataSourceSchema","namespace":"io.confluent.ksql.avro_schemas","fields":[{"name":"LEVEL","type":["null","int"],"default":null},{"name":"MESSAGE","type":["null","string"],"default":null}],"connect.name":"io.confluent.ksql.avro_schemas.KsqlDataSourceSchema"}'}, {compatibility: 'BACKWARD'}]; error code: 409
[xUnit.net 00:00:05.42]       Stack Trace:
[xUnit.net 00:00:05.42]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:05.42]            at Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyContext..ctor()
[xUnit.net 00:00:05.42]            at InvokeStub_DummyContext..ctor(Object, Object, IntPtr*)
[xUnit.net 00:00:05.42]            at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
[xUnit.net 00:00:05.42]         ----- Inner Stack Trace -----
[xUnit.net 00:00:05.42]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(203,0): at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations)
[xUnit.net 00:00:05.42]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(151,0): at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration()
[xUnit.net 00:00:05.42]         C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(59,0): at Kafka.Ksql.Linq.Application.KsqlContext..ctor()
[xUnit.net 00:00:05.42]         ----- Inner Stack Trace -----
[xUnit.net 00:00:05.42]            at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
[xUnit.net 00:00:05.42]            at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
[xUnit.net 00:00:05.42]            at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:05.42]            at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
[xUnit.net 00:00:05.42]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(100,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, String avroSchema)
[xUnit.net 00:00:05.42]         C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService.cs(69,0): at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entityType, AvroEntityConfiguration config)
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:05.75]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT EARLIEST_BY_OFFSET(ID) AS FIRST FROM ORDERS"...) [FAIL]
[xUnit.net 00:00:05.75]       SELECT EARLIEST_BY_OFFSET(ID) AS FIRST FROM ORDERS; failed: {"@type":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT EARLIEST_BY_OFFSET(ID) AS FIRST FROM ORDERS;","entities":[]}
[xUnit.net 00:00:05.75]       Expected: True
[xUnit.net 00:00:05.75]       Actual:   False
[xUnit.net 00:00:05.75]       Stack Trace:
[xUnit.net 00:00:05.75]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:05.75]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
CREATE STREAM result: True, msg: [{"@type":"currentStatus","statementText":"CREATE STREAM IF NOT EXISTS SOURCE (ID INTEGER) WITH (CLEANUP_POLICY='delete', KAFKA_TOPIC='source', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","commandId":"stream/`SOURCE`/create","commandStatus":{"status":"SUCCESS","message":"Stream created","queryId":null},"commandSequenceNumber":1188,"warnings":[]}]
DDL result: True, msg: [{"@type":"warning_entity","statementText":"CREATE TABLE IF NOT EXISTS ORDERS (CUSTOMERID INT PRIMARY KEY, ID INT, REGION VARCHAR, AMOUNT DECIMAL(38, 9), ISHIGHPRIORITY BOOLEAN, COUNT INT) WITH (KAFKA_TOPIC='orders', VALUE_FORMAT='AVRO', PARTITIONS=1);","message":"Cannot add table `ORDERS`: A table with the same name already exists.","warnings":[]}]
DDL result: True, msg: [{"@type":"currentStatus","statementText":"CREATE TABLE IF NOT EXISTS CUSTOMERS (ID INTEGER PRIMARY KEY, NAME STRING) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='customers', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","commandId":"table/`CUSTOMERS`/create","commandStatus":{"status":"SUCCESS","message":"Table created","queryId":null},"commandSequenceNumber":1192,"warnings":[]}]
DDL result: True, msg: [{"@type":"warning_entity","statementText":"CREATE TABLE IF NOT EXISTS EVENTS (LEVEL INT PRIMARY KEY, MESSAGE VARCHAR) WITH (KAFKA_TOPIC='events', VALUE_FORMAT='AVRO', PARTITIONS=1);","message":"Cannot add table `EVENTS`: A table with the same name already exists.","warnings":[]}]
DDL result: True, msg: [{"@type":"currentStatus","statementText":"CREATE TABLE IF NOT EXISTS ORDERS_NULLABLE (CUSTOMERID INTEGER PRIMARY KEY, REGION STRING, AMOUNT DECIMAL(38, 9)) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders_nullable', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","commandId":"table/`ORDERS_NULLABLE`/create","commandStatus":{"status":"SUCCESS","message":"Table created","queryId":null},"commandSequenceNumber":1198,"warnings":[]}]
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
DDL result: True, msg: [{"@type":"currentStatus","statementText":"CREATE TABLE IF NOT EXISTS ORDERS_NULLABLE_KEY (CUSTOMERID INTEGER PRIMARY KEY, AMOUNT DECIMAL(38, 9)) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders_nullable_key', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","commandId":"table/`ORDERS_NULLABLE_KEY`/create","commandStatus":{"status":"SUCCESS","message":"Table created","queryId":null},"commandSequenceNumber":1202,"warnings":[]}]
[xUnit.net 00:00:07.07]     Kafka.Ksql.Linq.Tests.Integration.KsqlSyntaxTests.GeneratedQuery_IsValidInKsqlDb(ksql: "CREATE STREAM test_stream AS SELECT * FROM source "...) [FAIL]
[xUnit.net 00:00:07.07]       CREATE STREAM test_stream AS SELECT * FROM source EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: SOURCE does not exist.","statementText":"EXPLAIN CREATE STREAM test_stream AS SELECT * FROM source EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:07.07]       Expected: True
[xUnit.net 00:00:07.07]       Actual:   False
[xUnit.net 00:00:07.07]       Stack Trace:
[xUnit.net 00:00:07.07]         C:\Users\seiji_yfc8940\final\final\physicalTests\KsqlSyntaxTests.cs(37,0): at Kafka.Ksql.Linq.Tests.Integration.KsqlSyntaxTests.GeneratedQuery_IsValidInKsqlDb(String ksql)
[xUnit.net 00:00:07.07]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
CREATE STREAM result: True, msg: [{"@type":"currentStatus","statementText":"CREATE STREAM IF NOT EXISTS SOURCE (ID INTEGER) WITH (CLEANUP_POLICY='delete', KAFKA_TOPIC='source', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","commandId":"stream/`SOURCE`/create","commandStatus":{"status":"SUCCESS","message":"Stream created","queryId":null},"commandSequenceNumber":1216,"warnings":[]}]
DDL result: True, msg: [{"@type":"warning_entity","statementText":"CREATE TABLE IF NOT EXISTS ORDERS (CUSTOMERID INT PRIMARY KEY, ID INT, REGION VARCHAR, AMOUNT DECIMAL(38, 9), ISHIGHPRIORITY BOOLEAN, COUNT INT) WITH (KAFKA_TOPIC='orders', VALUE_FORMAT='AVRO', PARTITIONS=1);","message":"Cannot add table `ORDERS`: A table with the same name already exists.","warnings":[]}]
DDL result: True, msg: [{"@type":"currentStatus","statementText":"CREATE TABLE IF NOT EXISTS CUSTOMERS (ID INTEGER PRIMARY KEY, NAME STRING) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='customers', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","commandId":"table/`CUSTOMERS`/create","commandStatus":{"status":"SUCCESS","message":"Table created","queryId":null},"commandSequenceNumber":1218,"warnings":[]}]
DDL result: True, msg: [{"@type":"warning_entity","statementText":"CREATE TABLE IF NOT EXISTS EVENTS (LEVEL INT PRIMARY KEY, MESSAGE VARCHAR) WITH (KAFKA_TOPIC='events', VALUE_FORMAT='AVRO', PARTITIONS=1);","message":"Cannot add table `EVENTS`: A table with the same name already exists.","warnings":[]}]
DDL result: True, msg: [{"@type":"currentStatus","statementText":"CREATE TABLE IF NOT EXISTS ORDERS_NULLABLE (CUSTOMERID INTEGER PRIMARY KEY, REGION STRING, AMOUNT DECIMAL(38, 9)) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders_nullable', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","commandId":"table/`ORDERS_NULLABLE`/create","commandStatus":{"status":"SUCCESS","message":"Table created","queryId":null},"commandSequenceNumber":1220,"warnings":[]}]
DDL result: True, msg: [{"@type":"currentStatus","statementText":"CREATE TABLE IF NOT EXISTS ORDERS_NULLABLE_KEY (CUSTOMERID INTEGER PRIMARY KEY, AMOUNT DECIMAL(38, 9)) WITH (CLEANUP_POLICY='compact', KAFKA_TOPIC='orders_nullable_key', KEY_FORMAT='KAFKA', PARTITIONS=1, VALUE_FORMAT='AVRO');","commandId":"table/`ORDERS_NULLABLE_KEY`/create","commandStatus":{"status":"SUCCESS","message":"Table created","queryId":null},"commandSequenceNumber":1222,"warnings":[]}]
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
%3|[[REDACTED_PHONE]]|FAIL|ksql-dsl-client-admin#producer-1| [thrd:kafka:9092/1]: kafka:9092/1: Failed to resolve 'kafka:9092':    ̂悤 ȃz X g ͕s   ł  B  (after 2694ms in state CONNECT, 1 identical error(s) suppressed)
%3|[[REDACTED_PHONE]]|ERROR|ksql-dsl-client-admin#producer-1| [thrd:app]: ksql-dsl-client-admin#producer-1: kafka:9092/1: Failed to resolve 'kafka:9092':    ̂悤 ȃz X g ͕s   ł  B  (after 2694ms in state CONNECT, 1 identical error(s) suppressed)
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:09.25]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL, SUM(CASE "...) [FAIL]
[xUnit.net 00:00:09.25]       SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL, SUM(CASE WHEN ISHIGHPRIORITY THEN AMOUNT ELSE 0 END) AS HIGHPRIORITYTOTAL FROM ORDERS GROUP BY CUSTOMERID EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Invalid Case expression. Type for the default clause should be the same as for 'THEN' clauses.\nTHEN type: DECIMAL(38, 9).\nDEFAULT type: INTEGER.","statementText":"EXPLAIN SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL, SUM(CASE WHEN ISHIGHPRIORITY THEN AMOUNT ELSE 0 END) AS HIGHPRIORITYTOTAL FROM ORDERS GROUP BY CUSTOMERID EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:09.25]       Expected: True
[xUnit.net 00:00:09.25]       Actual:   False
[xUnit.net 00:00:09.25]       Stack Trace:
[xUnit.net 00:00:09.25]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:09.25]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:09.74]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM ORDERS_NULLABLE_KEY EMIT CHANGES;") [FAIL]
[xUnit.net 00:00:09.74]       SELECT * FROM ORDERS_NULLABLE_KEY EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE_KEY does not exist.","statementText":"EXPLAIN SELECT * FROM ORDERS_NULLABLE_KEY EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:09.74]       Expected: True
[xUnit.net 00:00:09.74]       Actual:   False
[xUnit.net 00:00:09.74]       Stack Trace:
[xUnit.net 00:00:09.74]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:09.74]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:10.25]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT UPPER(REGION), SUM(AMOUNT) AS TOTALAMOUNT F"...) [FAIL]
[xUnit.net 00:00:10.25]       SELECT UPPER(REGION), SUM(AMOUNT) AS TOTALAMOUNT FROM ORDERS GROUP BY UPPER(REGION) HAVING (SUM(AMOUNT) > 500) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Can't find any functions with the name 'UPPER'","statementText":"EXPLAIN SELECT UPPER(REGION), SUM(AMOUNT) AS TOTALAMOUNT FROM ORDERS GROUP BY UPPER(REGION) HAVING (SUM(AMOUNT) > 500) EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:10.25]       Expected: True
[xUnit.net 00:00:10.25]       Actual:   False
[xUnit.net 00:00:10.25]       Stack Trace:
[xUnit.net 00:00:10.25]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:10.25]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:10.75]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*) FROM ORDERS;") [FAIL]
[xUnit.net 00:00:10.75]       SELECT COUNT(*) FROM ORDERS; failed: {"@type":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT COUNT(*) FROM ORDERS;","entities":[]}
[xUnit.net 00:00:10.75]       Expected: True
[xUnit.net 00:00:10.75]       Actual:   False
[xUnit.net 00:00:10.75]       Stack Trace:
[xUnit.net 00:00:10.75]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:10.75]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:11.24]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL FROM ORDER"...) [FAIL]
[xUnit.net 00:00:11.24]       Assert.Contains() Failure
[xUnit.net 00:00:11.24]       Not found: ORDERVALUE
[xUnit.net 00:00:11.24]       In value:  List<String> ["ORDERS", "CUSTOMERS", "EVENTS", "ORDERS_NULLABLE", "ORDERS_NULLABLE_KEY"]
[xUnit.net 00:00:11.24]       Stack Trace:
[xUnit.net 00:00:11.24]         C:\Users\seiji_yfc8940\final\final\physicalTests\TestSchema.cs(67,0): at Kafka.Ksql.Linq.Tests.Integration.TestSchema.ValidateDmlQuery(String query)
[xUnit.net 00:00:11.24]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(282,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:11.24]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:11.75]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM ORDERS_NULLABLE EMIT CHANGES;") [FAIL]
[xUnit.net 00:00:11.75]       SELECT * FROM ORDERS_NULLABLE EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE does not exist.","statementText":"EXPLAIN SELECT * FROM ORDERS_NULLABLE EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:11.75]       Expected: True
[xUnit.net 00:00:11.75]       Actual:   False
[xUnit.net 00:00:11.75]       Stack Trace:
[xUnit.net 00:00:11.75]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:11.75]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:12.25]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMERID, COUNT(*) AS COUNT FROM ORDERS W"...) [FAIL]
[xUnit.net 00:00:12.25]       SELECT CUSTOMERID, COUNT(*) AS COUNT FROM ORDERS WHERE (AMOUNT > 100) WINDOW TUMBLING (SIZE 5 MINUTES) GROUP BY CUSTOMERID HAVING (COUNT(*) > 1) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"line 1:79: Syntax Error\n","statementText":"EXPLAIN SELECT CUSTOMERID, COUNT(*) AS COUNT FROM ORDERS WHERE (AMOUNT > 100) WINDOW TUMBLING (SIZE 5 MINUTES) GROUP BY CUSTOMERID HAVING (COUNT(*) > 1) EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:12.25]       Expected: True
[xUnit.net 00:00:12.25]       Actual:   False
[xUnit.net 00:00:12.25]       Stack Trace:
[xUnit.net 00:00:12.25]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:12.25]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:12.76]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM ORDERS_NULLABLE WHERE (CUSTOMERID > "...) [FAIL]
[xUnit.net 00:00:12.76]       SELECT * FROM ORDERS_NULLABLE WHERE (CUSTOMERID > 0); failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE does not exist.","statementText":"EXPLAIN SELECT * FROM ORDERS_NULLABLE WHERE (CUSTOMERID > 0);","entities":[]}
[xUnit.net 00:00:12.76]       Expected: True
[xUnit.net 00:00:12.76]       Actual:   False
[xUnit.net 00:00:12.76]       Stack Trace:
[xUnit.net 00:00:12.76]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:12.76]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:13.90]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT LATEST_BY_OFFSET(ID) AS LAST FROM ORDERS;") [FAIL]
[xUnit.net 00:00:13.90]       SELECT LATEST_BY_OFFSET(ID) AS LAST FROM ORDERS; failed: {"@type":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT LATEST_BY_OFFSET(ID) AS LAST FROM ORDERS;","entities":[]}
[xUnit.net 00:00:13.90]       Expected: True
[xUnit.net 00:00:13.90]       Actual:   False
[xUnit.net 00:00:13.90]       Stack Trace:
[xUnit.net 00:00:13.90]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:13.90]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:14.40]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM CUSTOMERS EMIT CHANGES;") [FAIL]
[xUnit.net 00:00:14.40]       SELECT * FROM CUSTOMERS EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: CUSTOMERS does not exist.","statementText":"EXPLAIN SELECT * FROM CUSTOMERS EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:14.40]       Expected: True
[xUnit.net 00:00:14.40]       Actual:   False
[xUnit.net 00:00:14.40]       Stack Trace:
[xUnit.net 00:00:14.40]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:14.40]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:14.91]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*) FROM CUSTOMERS;") [FAIL]
[xUnit.net 00:00:14.91]       SELECT COUNT(*) FROM CUSTOMERS; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: CUSTOMERS does not exist.","statementText":"EXPLAIN SELECT COUNT(*) FROM CUSTOMERS;","entities":[]}
[xUnit.net 00:00:14.91]       Expected: True
[xUnit.net 00:00:14.91]       Actual:   False
[xUnit.net 00:00:14.91]       Stack Trace:
[xUnit.net 00:00:14.91]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:14.91]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:15.40]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE C"...) [FAIL]
[xUnit.net 00:00:15.40]       SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE CUSTOMERID IS NOT NULL EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE does not exist.","statementText":"EXPLAIN SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE CUSTOMERID IS NOT NULL EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:15.40]       Expected: True
[xUnit.net 00:00:15.40]       Actual:   False
[xUnit.net 00:00:15.40]       Stack Trace:
[xUnit.net 00:00:15.40]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:15.40]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:15.90]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE C"...) [FAIL]
[xUnit.net 00:00:15.90]       SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE CUSTOMERID IS NULL EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE does not exist.","statementText":"EXPLAIN SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE CUSTOMERID IS NULL EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:15.90]       Expected: True
[xUnit.net 00:00:15.90]       Actual:   False
[xUnit.net 00:00:15.90]       Stack Trace:
[xUnit.net 00:00:15.90]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:15.90]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:16.40]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL FROM ORDER"...) [FAIL]
[xUnit.net 00:00:16.40]       SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL FROM ORDERS_NULLABLE_KEY WHERE CUSTOMERID IS NOT NULL GROUP BY CUSTOMERID EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE_KEY does not exist.","statementText":"EXPLAIN SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL FROM ORDERS_NULLABLE_KEY WHERE CUSTOMERID IS NOT NULL GROUP BY CUSTOMERID EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:16.40]       Expected: True
[xUnit.net 00:00:16.40]       Actual:   False
[xUnit.net 00:00:16.40]       Stack Trace:
[xUnit.net 00:00:16.40]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:16.40]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:17.52]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT SUM(AMOUNT) AS SUM FROM ORDERS;") [FAIL]
[xUnit.net 00:00:17.52]       SELECT SUM(AMOUNT) AS SUM FROM ORDERS; failed: {"@type":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT SUM(AMOUNT) AS SUM FROM ORDERS;","entities":[]}
[xUnit.net 00:00:17.52]       Expected: True
[xUnit.net 00:00:17.52]       Actual:   False
[xUnit.net 00:00:17.52]       Stack Trace:
[xUnit.net 00:00:17.52]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:17.52]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:18.02]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM ORDERS_NULLABLE_KEY WHERE (CUSTOMERI"...) [FAIL]
[xUnit.net 00:00:18.02]       SELECT * FROM ORDERS_NULLABLE_KEY WHERE (CUSTOMERID > 0); failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE_KEY does not exist.","statementText":"EXPLAIN SELECT * FROM ORDERS_NULLABLE_KEY WHERE (CUSTOMERID > 0);","entities":[]}
[xUnit.net 00:00:18.02]       Expected: True
[xUnit.net 00:00:18.02]       Actual:   False
[xUnit.net 00:00:18.02]       Stack Trace:
[xUnit.net 00:00:18.02]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:18.02]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:18.53]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*) FROM ORDERS_NULLABLE;") [FAIL]
[xUnit.net 00:00:18.53]       SELECT COUNT(*) FROM ORDERS_NULLABLE; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE does not exist.","statementText":"EXPLAIN SELECT COUNT(*) FROM ORDERS_NULLABLE;","entities":[]}
[xUnit.net 00:00:18.53]       Expected: True
[xUnit.net 00:00:18.53]       Actual:   False
[xUnit.net 00:00:18.53]       Stack Trace:
[xUnit.net 00:00:18.53]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:18.53]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:19.67]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMERID, REGION, SUM(AMOUNT) AS TOTALAMO"...) [FAIL]
[xUnit.net 00:00:19.67]       SELECT CUSTOMERID, REGION, SUM(AMOUNT) AS TOTALAMOUNT, COUNT(*) AS ORDERCOUNT, AVG(AMOUNT) AS AVERAGEAMOUNT FROM ORDERS GROUP BY CUSTOMERID, REGION HAVING (((SUM(AMOUNT) > 1000) AND (COUNT(*) > 10)) OR (AVG(AMOUNT) > 150)) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Function 'avg' does not accept parameters (DECIMAL(38, 9)).\nValid alternatives are:\navg(DOUBLE val1)\navg(INT val1)\navg(BIGINT val1)\nFor detailed information on a function run: DESCRIBE FUNCTION <Function-Name>;","statementText":"EXPLAIN SELECT CUSTOMERID, REGION, SUM(AMOUNT) AS TOTALAMOUNT, COUNT(*) AS ORDERCOUNT, AVG(AMOUNT) AS AVERAGEAMOUNT FROM ORDERS GROUP BY CUSTOMERID, REGION HAVING (((SUM(AMOUNT) > 1000) AND (COUNT(*) > 10)) OR (AVG(AMOUNT) > 150)) EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:19.67]       Expected: True
[xUnit.net 00:00:19.67]       Actual:   False
[xUnit.net 00:00:19.67]       Stack Trace:
[xUnit.net 00:00:19.67]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:19.67]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:20.17]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL, COUNT(*) "...) [FAIL]
[xUnit.net 00:00:20.17]       SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL, COUNT(*) AS COUNT, AVG(AMOUNT) AS AVG FROM ORDERS GROUP BY CUSTOMERID HAVING (((SUM(AMOUNT) > 1000) AND (COUNT(*) > 5)) OR (AVG(AMOUNT) > 500)) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Function 'avg' does not accept parameters (DECIMAL(38, 9)).\nValid alternatives are:\navg(DOUBLE val1)\navg(INT val1)\navg(BIGINT val1)\nFor detailed information on a function run: DESCRIBE FUNCTION <Function-Name>;","statementText":"EXPLAIN SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL, COUNT(*) AS COUNT, AVG(AMOUNT) AS AVG FROM ORDERS GROUP BY CUSTOMERID HAVING (((SUM(AMOUNT) > 1000) AND (COUNT(*) > 5)) OR (AVG(AMOUNT) > 500)) EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:20.17]       Expected: True
[xUnit.net 00:00:20.17]       Actual:   False
[xUnit.net 00:00:20.17]       Stack Trace:
[xUnit.net 00:00:20.17]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:20.17]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:21.30]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM CUSTOMERS WHERE (ID > 0);") [FAIL]
[xUnit.net 00:00:21.30]       SELECT * FROM CUSTOMERS WHERE (ID > 0); failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: CUSTOMERS does not exist.","statementText":"EXPLAIN SELECT * FROM CUSTOMERS WHERE (ID > 0);","entities":[]}
[xUnit.net 00:00:21.30]       Expected: True
[xUnit.net 00:00:21.30]       Actual:   False
[xUnit.net 00:00:21.30]       Stack Trace:
[xUnit.net 00:00:21.30]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql)
[xUnit.net 00:00:21.30]         --- End of stack trace from previous location ---
Failed to delete schema ORDERS-value: NotFound
Failed to delete schema ORDERS-key: NotFound
Failed to delete schema CUSTOMERS-value: NotFound
Failed to delete schema CUSTOMERS-key: NotFound
Failed to delete schema EVENTS-value: NotFound
Failed to delete schema EVENTS-key: NotFound
Failed to delete schema ORDERS_NULLABLE-value: NotFound
Failed to delete schema ORDERS_NULLABLE-key: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-value: NotFound
Failed to delete schema ORDERS_NULLABLE_KEY-key: NotFound
[xUnit.net 00:00:22.39]     Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.CreateAllObjectsByOnModelCreating [FAIL]
[xUnit.net 00:00:22.39]       DDL failed: {"@type":"statement_error","error_code":40001,"message":"Failed to prepare statement: 'O' is not a valid stream/table name or alias.","statementText":"CREATE STREAM order_enriched AS SELECT o.CustomerId AS CustomerId, c.Name AS Name, o.Amount AS Amount FROM orders EMIT CHANGES;","entities":[]}
[xUnit.net 00:00:22.39]       Expected: True
[xUnit.net 00:00:22.39]       Actual:   False
[xUnit.net 00:00:22.39]       Stack Trace:
[xUnit.net 00:00:22.39]         C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(250,0): at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.CreateAllObjectsByOnModelCreating()
[xUnit.net 00:00:22.39]         --- End of stack trace from previous location ---
[xUnit.net 00:00:32.35]     Kafka.Ksql.Linq.Tests.Integration.SchemaNameCaseSensitivityTests.MismatchedFieldCase_ShouldThrowException [FAIL]
[xUnit.net 00:00:32.35]       System.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka connectivity.
[xUnit.net 00:00:32.35]       ---- System.InvalidOperationException : FATAL: Kafka readiness check failed. DLQ functionality may be unavailable.
[xUnit.net 00:00:32.35]       -------- System.InvalidOperationException : FATAL: Cannot ensure DLQ topic 'dead.letter.queue' exists. DLQ functionality will be unavailable.
[xUnit.net 00:00:32.35]       ------------ Confluent.Kafka.KafkaException : Failed while waiting for controller: Local: Timed out
[xUnit.net 00:00:32.35]       Stack Trace:
[xUnit.net 00:00:32.35]         C:\Users\seiji
The file is too long and its contents have been truncated.
### tool — 2025-07-06T09:46:20.517429+00:00

Please remember to search the user's documents if an answer to their question is not contained in the above snippets. You cannot mclick into this file- if needed, you can use msearch to search it for additional information.
### user — 2025-07-06T09:46:47.158000+00:00

テストエラーの回避方法を詩音に指示
### assistant — 2025-07-06T09:46:47.315663+00:00

【[[REDACTED_PHONE]]:48 JST】

詩音へのテストエラー回避指示例を作成します。

---
### 詩音への指示：スキーマ競合によるテストエラーの回避

1. **テスト開始前に、必要なテーブル・スキーマ・サブジェクト（-key, -value）を明示的にDROP（削除）するコードを必ず実行すること。**  
   - `DROP TABLE IF EXISTS ...;`  
   - Schema Registry APIで `DELETE /subjects/{subject}` を使用してサブジェクト（スキーマ）も削除する。
   - これにより前回テストの残骸による `NAME_MISMATCH` などのコンフリクトを防止できる。

2. **テスト用エンティティやトピック名は一意なPrefixやSuffixを付与することを推奨。**  
   - テストごとに `${TestName}_${Entity}` のような命名にすることで、他テストとバッティングを防止できる。

3. **スキーマ削除後も Schema Registry のキャッシュやプロパゲーションのタイムラグに注意。**  
   - テストコード内で削除後に少し待機（Thread.Sleep等）を入れる、もしくは削除後の存在確認を行い、完全削除を待つ。

4. **もし既存スキーマの `name` や `namespace` を変更したい場合、必ずSchema Registry上の古いスキーマ資産を消してから新しい定義を登録すること。**  
   - 既存スキーマの変更は基本NG。どうしても必要な場合はマイグレーション戦略を設計の上、慎重に行う。

#### 例：C# テストセットアップ内でのスキーマ削除サンプル
```csharp
// REST APIでサブジェクト削除（例: orders-value, orders-key）
await schemaRegistryClient.DeleteSubjectAsync("orders-value");
await schemaRegistryClient.DeleteSubjectAsync("orders-key");
// テーブルもDROP
await ksqlDbClient.ExecuteStatementAsync("DROP TABLE IF EXISTS ORDERS;");
```
#### 注意
- Schema Registryが「サブジェクトが存在しない」と返してもOK（NotFoundは無視）。
- スキーマ削除・テーブルDROPを漏れなく行うことで、テストエラーの大半は回避できます。

---

この指示を詩音に送ってください。必要に応じて具体例やテストコード例も添付するとよいでしょう。
### user — 2025-07-06T09:54:48.279000+00:00

徐々に進んでるようだが
[xUnit.net 00:00:34.06]   Finished:    Kafka.Ksql.Linq.Tests.Integration
  Kafka.Ksql.Linq.Tests.Integration テスト 28 件のエラーで失敗しました (34.7 秒)
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*)
       FROM ORDERS_NULLABLE_KEY;") (2s 537ms): エラー メッセージ: SELECT COUNT(*) FROM ORDERS_NULLABLE_KEY; failed: {"@type":"stateme
      nt_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE_KEY does not exist.","stat
      ementText":"EXPLAIN SELECT COUNT(*) FROM ORDERS_NULLABLE_KEY;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\KsqlSyntaxTests.cs(37): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.KsqlSyntaxTests.GeneratedQuery_IsValidInKsqlDb(ksql: "CREATE STREAM test_stream AS SE
      LECT * FROM source "...) (2s 969ms): エラー メッセージ: CREATE STREAM test_stream AS SELECT * FROM source EMIT CHANGES; failed:
       {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: SOURCE does not exist.",
      "statementText":"EXPLAIN CREATE STREAM test_stream AS SELECT * FROM source EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.KsqlSyntaxTests.GeneratedQuery_IsValidInKsqlDb(String ksql) in C:\Users\seiji_y
      fc8940\final\final\physicalTests\KsqlSyntaxTests.cs:line 37
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMER
      ID, AVG(AMOUNT) AS AVERAGEAMOUNT, M"...) (560ms): エラー メッセージ: SELECT CUSTOMERID, AVG(AMOUNT) AS AVERAGEAMOUNT, MIN(AMOUN
      T) AS MINAMOUNT, MAX(AMOUNT) AS MAXAMOUNT FROM ORDERS GROUP BY CUSTOMERID EMIT CHANGES; failed: {"@type":"statement_err
      or","error_code":40001,"message":"Function 'avg' does not accept parameters (DECIMAL(38, 9)).\nValid alternatives are:\
      navg(DOUBLE val1)\navg(INT val1)\navg(BIGINT val1)\nFor detailed information on a function run: DESCRIBE FUNCTION <Func
      tion-Name>;","statementText":"EXPLAIN SELECT CUSTOMERID, AVG(AMOUNT) AS AVERAGEAMOUNT, MIN(AMOUNT) AS MINAMOUNT, MAX(AM
      OUNT) AS MAXAMOUNT FROM ORDERS GROUP BY CUSTOMERID EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT EARLIEST
      _BY_OFFSET(ID) AS FIRST FROM ORDERS"...) (492ms): エラー メッセージ: SELECT EARLIEST_BY_OFFSET(ID) AS FIRST FROM ORDERS; failed
      : {"@type":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnf
      l.io/queries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT E
      ARLIEST_BY_OFFSET(ID) AS FIRST FROM ORDERS;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.Consumer_SkipsDummyMessages (7s 31ms): エラー メッセージ: Sys
      tem.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka con
      nectivity.
      ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for Cust
      omer
      -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier sch
      ema for subject "customers-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has change
      d (path '/name')', additionalInfo:'expected: io.confluent.ksql.avro_schemas.KsqlDataSourceSchema'}, {oldSchemaVersion:
      14}, {oldSchema: '{"type":"record","name":"KsqlDataSourceSchema","namespace":"io.confluent.ksql.avro_schemas","fields":
      [{"name":"NAME","type":["null","string"],"default":null}],"connect.name":"io.confluent.ksql.avro_schemas.KsqlDataSource
      Schema"}'}, {compatibility: 'BACKWARD'}]; error code: 409
      スタック トレース:
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 84
         at Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyContext..ctor()
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
      ----- Inner Stack Trace -----
         at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations) in C:\Users\sei
      ji_yfc8940\final\final\src\KsqlContext.cs:line 203
         at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration() in C:\Users\seiji_yfc8940\final\final\
      src\KsqlContext.cs:line 151
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 59
      ----- Inner Stack Trace -----
         at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
         at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
         at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
         at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean no
      rmalize)
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, S
      tring avroSchema) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService
      .cs:line 100
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entity
      Type, AvroEntityConfiguration config) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchem
      aRegistrationService.cs:line 69
    C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyMessages_EnableQueries (1s 236ms): エラー メッセージ: Sy
      stem.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue without Kafka co
      nnectivity.
      ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for Even
      tLog
      -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier sch
      ema for subject "events-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (
      path '/name')', additionalInfo:'expected: io.confluent.ksql.avro_schemas.KsqlDataSourceSchema'}, {oldSchemaVersion: 1},
       {oldSchema: '{"type":"record","name":"KsqlDataSourceSchema","namespace":"io.confluent.ksql.avro_schemas","fields":[{"n
      ame":"LEVEL","type":["null","int"],"default":null},{"name":"MESSAGE","type":["null","string"],"default":null}],"connect
      .name":"io.confluent.ksql.avro_schemas.KsqlDataSourceSchema"}'}, {compatibility: 'BACKWARD'}]; error code: 409
      スタック トレース:
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 84
         at Kafka.Ksql.Linq.Tests.Integration.DummyFlagSchemaRecognitionTests.DummyContext..ctor()
         at InvokeStub_DummyContext..ctor(Object, Object, IntPtr*)
         at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
      ----- Inner Stack Trace -----
         at Kafka.Ksql.Linq.Application.KsqlContext.RegisterSchemasSync(IReadOnlyDictionary`2 configurations) in C:\Users\sei
      ji_yfc8940\final\final\src\KsqlContext.cs:line 203
         at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration() in C:\Users\seiji_yfc8940\final\final\
      src\KsqlContext.cs:line 151
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 59
      ----- Inner Stack Trace -----
         at Confluent.SchemaRegistry.RestService.ExecuteOnOneInstanceAsync(Func`1 createRequest)
         at Confluent.SchemaRegistry.RestService.RequestAsync[T](String endPoint, HttpMethod method, Object[] jsonBody)
         at Confluent.SchemaRegistry.RestService.RegisterSchemaAsync(String subject, Schema schema, Boolean normalize)
         at Confluent.SchemaRegistry.CachedSchemaRegistryClient.RegisterSchemaAsync(String subject, Schema schema, Boolean no
      rmalize)
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterSchemaAsync(String subject, S
      tring avroSchema) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchemaRegistrationService
      .cs:line 100
         at Kafka.Ksql.Linq.Serialization.Avro.Management.AvroSchemaRegistrationService.RegisterEntitySchemaAsync(Type entity
      Type, AvroEntityConfiguration config) in C:\Users\seiji_yfc8940\final\final\src\Serialization\Avro\Management\AvroSchem
      aRegistrationService.cs:line 69
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMER
      ID, SUM(AMOUNT) AS TOTAL, SUM(CASE "...) (497ms): エラー メッセージ: SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL, SUM(CASE WHEN ISH
      IGHPRIORITY THEN AMOUNT ELSE 0 END) AS HIGHPRIORITYTOTAL FROM ORDERS GROUP BY CUSTOMERID EMIT CHANGES; failed: {"@type"
      :"statement_error","error_code":40001,"message":"Invalid Case expression. Type for the default clause should be the sam
      e as for 'THEN' clauses.\nTHEN type: DECIMAL(38, 9).\nDEFAULT type: INTEGER.","statementText":"EXPLAIN SELECT CUSTOMERI
      D, SUM(AMOUNT) AS TOTAL, SUM(CASE WHEN ISHIGHPRIORITY THEN AMOUNT ELSE 0 END) AS HIGHPRIORITYTOTAL FROM ORDERS GROUP BY
       CUSTOMERID EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM O
      RDERS_NULLABLE_KEY EMIT CHANGES;") (492ms): エラー メッセージ: SELECT * FROM ORDERS_NULLABLE_KEY EMIT CHANGES; failed: {"@type"
      :"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE_KEY does not exis
      t.","statementText":"EXPLAIN SELECT * FROM ORDERS_NULLABLE_KEY EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT UPPER(RE
      GION), SUM(AMOUNT) AS TOTALAMOUNT F"...) (506ms): エラー メッセージ: SELECT UPPER(REGION), SUM(AMOUNT) AS TOTALAMOUNT FROM ORDE
      RS GROUP BY UPPER(REGION) HAVING (SUM(AMOUNT) > 500) EMIT CHANGES; failed: {"@type":"statement_error","error_code":4000
      1,"message":"Can't find any functions with the name 'UPPER'","statementText":"EXPLAIN SELECT UPPER(REGION), SUM(AMOUNT)
       AS TOTALAMOUNT FROM ORDERS GROUP BY UPPER(REGION) HAVING (SUM(AMOUNT) > 500) EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*)
       FROM ORDERS;") (498ms): エラー メッセージ: SELECT COUNT(*) FROM ORDERS; failed: {"@type":"statement_error","error_code":40001,
      "message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\nAdd EMIT CHANGES if
       you intended to issue a push query.","statementText":"EXPLAIN SELECT COUNT(*) FROM ORDERS;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\TestSchema.cs(67): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMER
      ID, SUM(AMOUNT) AS TOTAL FROM ORDER"...) (490ms): エラー メッセージ: Assert.Contains() Failure
      Not found: ORDERVALUE
      In value:  List<String> ["ORDERS", "CUSTOMERS", "EVENTS", "ORDERS_NULLABLE", "ORDERS_NULLABLE_KEY"]
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.TestSchema.ValidateDmlQuery(String query) in C:\Users\seiji_yfc8940\final\final
      \physicalTests\TestSchema.cs:line 67
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 282
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM O
      RDERS_NULLABLE EMIT CHANGES;") (500ms): エラー メッセージ: SELECT * FROM ORDERS_NULLABLE EMIT CHANGES; failed: {"@type":"statem
      ent_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE does not exist.","stateme
      ntText":"EXPLAIN SELECT * FROM ORDERS_NULLABLE EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMER
      ID, COUNT(*) AS COUNT FROM ORDERS W"...) (494ms): エラー メッセージ: SELECT CUSTOMERID, COUNT(*) AS COUNT FROM ORDERS WHERE (AM
      OUNT > 100) WINDOW TUMBLING (SIZE 5 MINUTES) GROUP BY CUSTOMERID HAVING (COUNT(*) > 1) EMIT CHANGES; failed: {"@type":"
      statement_error","error_code":40001,"message":"line 1:79: Syntax Error\n","statementText":"EXPLAIN SELECT CUSTOMERID, C
      OUNT(*) AS COUNT FROM ORDERS WHERE (AMOUNT > 100) WINDOW TUMBLING (SIZE 5 MINUTES) GROUP BY CUSTOMERID HAVING (COUNT(*)
       > 1) EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM O
      RDERS_NULLABLE WHERE (CUSTOMERID > "...) (500ms): エラー メッセージ: SELECT * FROM ORDERS_NULLABLE WHERE (CUSTOMERID > 0); fail
      ed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE does
      not exist.","statementText":"EXPLAIN SELECT * FROM ORDERS_NULLABLE WHERE (CUSTOMERID > 0);","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT LATEST_B
      Y_OFFSET(ID) AS LAST FROM ORDERS;") (496ms): エラー メッセージ: SELECT LATEST_BY_OFFSET(ID) AS LAST FROM ORDERS; failed: {"@typ
      e":"statement_error","error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/que
      ries for more info.\nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT LATEST_BY
      _OFFSET(ID) AS LAST FROM ORDERS;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM C
      USTOMERS EMIT CHANGES;") (494ms): エラー メッセージ: SELECT * FROM CUSTOMERS EMIT CHANGES; failed: {"@type":"statement_error","
      error_code":40001,"message":"Exception while preparing statement: CUSTOMERS does not exist.","statementText":"EXPLAIN S
      ELECT * FROM CUSTOMERS EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*)
       FROM CUSTOMERS;") (494ms): エラー メッセージ: SELECT COUNT(*) FROM CUSTOMERS; failed: {"@type":"statement_error","error_code":
      40001,"message":"Exception while preparing statement: CUSTOMERS does not exist.","statementText":"EXPLAIN SELECT COUNT(
      *) FROM CUSTOMERS;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT REGION,
      AMOUNT FROM ORDERS_NULLABLE WHERE C"...) (489ms): エラー メッセージ: SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE CUSTOMERI
      D IS NOT NULL EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing
      statement: ORDERS_NULLABLE does not exist.","statementText":"EXPLAIN SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE C
      USTOMERID IS NOT NULL EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT REGION,
      AMOUNT FROM ORDERS_NULLABLE WHERE C"...) (490ms): エラー メッセージ: SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE CUSTOMERI
      D IS NULL EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing stat
      ement: ORDERS_NULLABLE does not exist.","statementText":"EXPLAIN SELECT REGION, AMOUNT FROM ORDERS_NULLABLE WHERE CUSTO
      MERID IS NULL EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMER
      ID, SUM(AMOUNT) AS TOTAL FROM ORDER"...) (496ms): エラー メッセージ: SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL FROM ORDERS_NULLAB
      LE_KEY WHERE CUSTOMERID IS NOT NULL GROUP BY CUSTOMERID EMIT CHANGES; failed: {"@type":"statement_error","error_code":4
      0001,"message":"Exception while preparing statement: ORDERS_NULLABLE_KEY does not exist.","statementText":"EXPLAIN SELE
      CT CUSTOMERID, SUM(AMOUNT) AS TOTAL FROM ORDERS_NULLABLE_KEY WHERE CUSTOMERID IS NOT NULL GROUP BY CUSTOMERID EMIT CHAN
      GES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT SUM(AMOU
      NT) AS SUM FROM ORDERS;") (484ms): エラー メッセージ: SELECT SUM(AMOUNT) AS SUM FROM ORDERS; failed: {"@type":"statement_error"
      ,"error_code":40001,"message":"Pull queries don't support GROUP BY clauses. See https://cnfl.io/queries for more info.\
      nAdd EMIT CHANGES if you intended to issue a push query.","statementText":"EXPLAIN SELECT SUM(AMOUNT) AS SUM FROM ORDER
      S;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM O
      RDERS_NULLABLE_KEY WHERE (CUSTOMERI"...) (483ms): エラー メッセージ: SELECT * FROM ORDERS_NULLABLE_KEY WHERE (CUSTOMERID > 0);
      failed: {"@type":"statement_error","error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE_K
      EY does not exist.","statementText":"EXPLAIN SELECT * FROM ORDERS_NULLABLE_KEY WHERE (CUSTOMERID > 0);","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT COUNT(*)
       FROM ORDERS_NULLABLE;") (484ms): エラー メッセージ: SELECT COUNT(*) FROM ORDERS_NULLABLE; failed: {"@type":"statement_error","
      error_code":40001,"message":"Exception while preparing statement: ORDERS_NULLABLE does not exist.","statementText":"EXP
      LAIN SELECT COUNT(*) FROM ORDERS_NULLABLE;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMER
      ID, REGION, SUM(AMOUNT) AS TOTALAMO"...) (496ms): エラー メッセージ: SELECT CUSTOMERID, REGION, SUM(AMOUNT) AS TOTALAMOUNT, COU
      NT(*) AS ORDERCOUNT, AVG(AMOUNT) AS AVERAGEAMOUNT FROM ORDERS GROUP BY CUSTOMERID, REGION HAVING (((SUM(AMOUNT) > 1000)
       AND (COUNT(*) > 10)) OR (AVG(AMOUNT) > 150)) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"mess
      age":"Function 'avg' does not accept parameters (DECIMAL(38, 9)).\nValid alternatives are:\navg(DOUBLE val1)\navg(INT v
      al1)\navg(BIGINT val1)\nFor detailed information on a function run: DESCRIBE FUNCTION <Function-Name>;","statementText"
      :"EXPLAIN SELECT CUSTOMERID, REGION, SUM(AMOUNT) AS TOTALAMOUNT, COUNT(*) AS ORDERCOUNT, AVG(AMOUNT) AS AVERAGEAMOUNT F
      ROM ORDERS GROUP BY CUSTOMERID, REGION HAVING (((SUM(AMOUNT) > 1000) AND (COUNT(*) > 10)) OR (AVG(AMOUNT) > 150)) EMIT
      CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT CUSTOMER
      ID, SUM(AMOUNT) AS TOTAL, COUNT(*) "...) (499ms): エラー メッセージ: SELECT CUSTOMERID, SUM(AMOUNT) AS TOTAL, COUNT(*) AS COUNT
      , AVG(AMOUNT) AS AVG FROM ORDERS GROUP BY CUSTOMERID HAVING (((SUM(AMOUNT) > 1000) AND (COUNT(*) > 5)) OR (AVG(AMOUNT)
      > 500)) EMIT CHANGES; failed: {"@type":"statement_error","error_code":40001,"message":"Function 'avg' does not accept p
      arameters (DECIMAL(38, 9)).\nValid alternatives are:\navg(DOUBLE val1)\navg(INT val1)\navg(BIGINT val1)\nFor detailed i
      nformation on a function run: DESCRIBE FUNCTION <Function-Name>;","statementText":"EXPLAIN SELECT CUSTOMERID, SUM(AMOUN
      T) AS TOTAL, COUNT(*) AS COUNT, AVG(AMOUNT) AS AVG FROM ORDERS GROUP BY CUSTOMERID HAVING (((SUM(AMOUNT) > 1000) AND (C
      OUNT(*) > 5)) OR (AVG(AMOUNT) > 500)) EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(284): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(ksql: "SELECT * FROM C
      USTOMERS WHERE (ID > 0);") (484ms): エラー メッセージ: SELECT * FROM CUSTOMERS WHERE (ID > 0); failed: {"@type":"statement_erro
      r","error_code":40001,"message":"Exception while preparing statement: CUSTOMERS does not exist.","statementText":"EXPLA
      IN SELECT * FROM CUSTOMERS WHERE (ID > 0);","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.AllDmlQueries_ShouldBeValidInKsqlDb(String ksql) in
      C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 284
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs(250): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.CreateAllObjectsByOnModelCreating (1s 128ms): エラー メッセージ: D
      DL failed: {"@type":"statement_error","error_code":40001,"message":"Failed to prepare statement: 'O' is not a valid str
      eam/table name or alias.","statementText":"CREATE STREAM order_enriched AS SELECT o.CustomerId AS CustomerId, c.Name AS
       Name, o.Amount AS Amount FROM orders EMIT CHANGES;","entities":[]}
      Expected: True
      Actual:   False
      スタック トレース:
         at Kafka.Ksql.Linq.Tests.Integration.DynamicKsqlGenerationTests.CreateAllObjectsByOnModelCreating() in C:\Users\seij
      i_yfc8940\final\final\physicalTests\DynamicKsqlGenerationTests.cs:line 250
      --- End of stack trace from previous location ---
    C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs(84): error TESTERROR:
      Kafka.Ksql.Linq.Tests.Integration.SchemaNameCaseSensitivityTests.MismatchedFieldCase_ShouldThrowException (33s 66ms): エ
      ラー メッセージ: System.InvalidOperationException : FATAL: KsqlContext initialization failed. Application cannot continue with
      out Kafka connectivity.
      ---- System.InvalidOperationException : FATAL: Kafka readiness check failed. DLQ functionality may be unavailable.
      -------- System.InvalidOperationException : FATAL: Cannot ensure DLQ topic 'dead.letter.queue' exists. DLQ functionalit
      y will be unavailable.
      ------------ Confluent.Kafka.KafkaException : Failed while waiting for controller: Local: Timed out
      スタック トレース:
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 84
         at Kafka.Ksql.Linq.Tests.Integration.SchemaNameCaseSensitivityTests.OrderContext..ctor()
         at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
         at System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(Object obj, BindingFlags invokeAttr)
      ----- Inner Stack Trace -----
         at Kafka.Ksql.Linq.Application.KsqlContext.EnsureKafkaReadyAsync() in C:\Users\seiji_yfc8940\final\final\src\KsqlCon
      text.cs:line 175
         at Kafka.Ksql.Linq.Application.KsqlContext.InitializeWithSchemaRegistration() in C:\Users\seiji_yfc8940\final\final\
      src\KsqlContext.cs:line 156
         at Kafka.Ksql.Linq.Application.KsqlContext..ctor() in C:\Users\seiji_yfc8940\final\final\src\KsqlContext.cs:line 59
      ----- Inner Stack Trace -----
         at Kafka.Ksql.Linq.Infrastructure.Admin.KafkaAdminService.EnsureDlqTopicExistsAsync(CancellationToken cancellationTo
      ken) in C:\Users\seiji_yfc8940\final\final\src\Infrastructure\Admin\KafkaAdminService.cs:line 58
         at Kafka.Ksql.Linq.Application.KsqlContext.EnsureKafkaReadyAsync() in C:\Users\seiji_yfc8940\final\final\src\KsqlCon
      text.cs:line 163
      ----- Inner Stack Trace -----
         at Kafka.Ksql.Linq.Infrastructure.Admin.KafkaAdminService.CreateDlqTopicAsync(String topicName, CancellationToken ca
      ncellationToken) in C:\Users\seiji_yfc8940\final\final\src\Infrastructure\Admin\KafkaAdminService.cs:line 214
         at Kafka.Ksql.Linq.Infrastructure.Admin.KafkaAdminService.EnsureDlqTopicExistsAsync(CancellationToken cancellationTo
      ken) in C:\Users\seiji_yfc8940\final\final\src\Infrastructure\Admin\KafkaAdminService.cs:line 52
### assistant — 2025-07-06T09:54:48.324104+00:00

【[[REDACTED_PHONE]]:09 JST】

現状28件エラーの原因分析＆詩音への修正指示例をまとめます。

---
### エラーの主な分類

1. **対象テーブル/ストリームが存在しない（`does not exist`）**
   - → テスト前にCREATE文でセットアップ漏れ or テスト用オブジェクトの削除しすぎ  
   - `ORDERS_NULLABLE_KEY` などはDROP後に再作成されていない  
   - 必要な場合はSETUP/TEARDOWNで明示的にCREATEすること

2. **スキーマ互換性（NAME_MISMATCH）**
   - → 以前の登録内容と異なるAvro schema nameを投入  
   - サブジェクト消し忘れ・Registry側リセット不足が原因

3. **DDL/SQL構文エラー**
   - GROUP BYでPullQuery使えない  
   - UPPER関数未サポート/型不一致  
   - KSQLの仕様に沿ってクエリ生成ロジックを修正

4. **Kafka/ksqlDB/SchemaRegistryの疎通・準備不足**
   - Kafka DLQ topicの作成失敗  
   - サービスのウォームアップ・リトライ追加

---
### 詩音への修正指示テンプレ

---

#### 1. SETUP/TEARDOWN強化

- テスト前に**必要なテーブル・ストリーム・トピック・スキーマが全て揃っていること**を明示的に確認・再作成すること。
  - 不足分は`CREATE TABLE/STREAM`で作成
  - テスト後は必ず`DROP`とSchema Registryサブジェクト削除

#### 2. スキーマ名の整合性

- Avroスキーマの`name`/`namespace`が既存スキーマと一致しない場合は、
  - テスト前に `DELETE /subjects/{subject}` で**サブジェクトをクリア**
  - 新旧混在しないよう注意

#### 3. クエリ仕様の明確化

- ksqlDBの仕様（Pull/Pull-Query, EMIT CHANGES必須, サポート関数/型）をリスト化し、
  - 非サポート構文を自動的に除外 or Skipするロジックを組み込む

#### 4. Kafka疎通・DLQ準備

- テスト前の初期化フェーズで
  - Kafka, ksqlDB, SchemaRegistry, DLQ topicが確実に存在・稼働しているかチェック
  - 存在しない場合は自動生成し、疎通エラーならテストをSkipすること

---

#### 5. 具体的なテスト修正例

```csharp
// テストクラス初期化で
await ksqlDbClient.ExecuteStatementAsync("DROP TABLE IF EXISTS ORDERS_NULLABLE_KEY;");
await schemaRegistryClient.DeleteSubjectAsync("orders_nullable_key-value");
await schemaRegistryClient.DeleteSubjectAsync("orders_nullable_key-key");
// 必要なものを再作成
await ksqlDbClient.ExecuteStatementAsync(@"
  CREATE TABLE ORDERS_NULLABLE_KEY (...省略...);
");
```

- 型不一致（例：CASE文の`THEN`と`ELSE`）もコード生成側で修正すること  
- サポートされていない関数（例：UPPER）は自動テストから除外

---

#### 6. その他

- ksqlDB/Kafkaサービス起動直後は数秒待つ or リトライを入れる
- 互換性エラーや疎通エラーはテスト失敗ではなく「保留」扱いにしてもよい

---

以上をベースに、**詩音にはSETUP/TEARDOWN/クエリ仕様/スキーマ整合性の見直しを指示**してください。

---

必要ならこの指示文をカスタマイズしてご利用ください！
### user — 2025-07-06T10:15:25.652000+00:00

[xUnit.net 00:00:11.31]       ---- Kafka.Ksql.Linq.Serialization.Avro.Exceptions.AvroSchemaRegistrationException : Failed to register schema for Customer
[xUnit.net 00:00:11.31]       -------- Confluent.SchemaRegistry.SchemaRegistryException : Schema being registered is incompatible with an earlier schema for subject "customers-value", details: [{errorType:'NAME_MISMATCH', description:'The name of the schema has changed (path '/name')', additionalInfo:'expected: io.confluent.ksql.avro_schemas.KsqlDataSourceSchema'}, {oldSchemaVersion: 19}, {oldSchema: '{"type":"record","name":"KsqlDataSourceSchema","namespace":"io.confluent.ksql.avro_schemas","fields":[{"name":"NAME","type":["null","string"],"default":null}],"connect.name":"io.confluent.ksql.avro_schemas.KsqlDataSourceSchema"}'}, {compatibility: 'BACKWARD'}]; error code: 409
### assistant — 2025-07-06T10:15:25.669348+00:00

【[[REDACTED_PHONE]]:11 JST】

このエラー（`NAME_MISMATCH`）は**Schema Registryのサブジェクト "customers-value" に、以前と異なる record name でスキーマを登録しようとした**場合に発生します。

---
### 原因（要約）

- 以前は、  
  ```json
  "name": "KsqlDataSourceSchema"
  ```
  で登録されていた。
- 今回は、
  ```json
  "name": "Customer"
  ```
  で登録しようとした。

**Avroスキーマの`name`が変わると、Schema Registryのcompatibilityポリシーにより登録が拒否される**（409 Conflict）。

---
### 回避方法（詩音への指示例）

---

#### 1. **テスト前に「customers-value」サブジェクトを Schema Registry から削除する**

たとえば
- REST API:  
  ```
  DELETE http://[schema-registry]/subjects/customers-value
  ```
- .NETなら
  ```csharp
  await schemaRegistryClient.DeleteSubjectAsync("customers-value");
  ```

#### 2. 既存サブジェクトの「name」と揃える（ただし、今回は設計をname=Customerへ移行したいはずなので1が王道）

---

#### 3. **ドキュメント明記事項**

- スキーマ互換性エラーが出る場合は、必ず**サブジェクトの削除 or 互換性の切り替え**（COMPATIBILITY=NONE）を行う。
- CI環境など「テストごとにスキーマの命名や定義が変わる場合」は、**毎回サブジェクト削除→再登録**の運用が必須。

---

#### 4. **詩音への指示（まとめ）**

> - integration test/セットアップ時に、対象サブジェクト（"customers-value" など）を毎回**明示的に削除**してからテストを実行してください。  
> - これにより `NAME_MISMATCH` エラーを確実に回避できます。
> - 手順例・コードサンプルは上記参照。

---

もし本番環境やデータ移行を考慮する場合は「互換性ポリシー」も再度検討してくださいが、テスト用途では**サブジェクト削除→再登録**が最も安全です。

ご参考まで！
### user — 2025-07-06T10:18:44.431000+00:00

同じクエリでのスキーマ登録は何度やっても問題ないよね
### assistant — 2025-07-06T10:18:44.604881+00:00

【[[REDACTED_PHONE]]:13 JST】

はい、**まったく同じスキーマ内容**（`type`, `name`, `namespace`, `fields` すべて同じ）であれば、**何度スキーマ登録してもエラーにはなりません**。

- Avro Schema Registry は「**スキーマの内容が完全一致していれば再登録時もバージョンは増えず、OK（No-Op）**」です。
- ただし**一部でも違う場合**（特に `name` や `namespace`）は、互換性チェックが走り、互換でなければエラーになります。

---

#### まとめ

- **完全一致**：何回登録しても問題なし（No-Op）。
- **一部でも違う**：互換性チェック→不一致ならエラー。

---

何度も同じクエリでスキーマ登録→**安全です**。  
（テスト時など、失敗時は「name」や「namespace」が本当に一致しているか再確認してください。）

ご安心ください！
