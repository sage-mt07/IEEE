---
conversation_id: "68b8e325-97d8-832f-93fb-74a120b8a0eb"
title: "Windows2025でasmx設定"
create_time: 1756947250.996432
update_time: 1756947560.745748
language_guess: "en"
num_messages: 22
part_index: 1
part_count: 1
---

### user — 2025-09-04T00:54:10.724000+00:00

Windows2025でasmxを動かすための設定を教えて

### system — 2025-09-04T00:54:10.996432+00:00

_(empty)_

### user — 2025-09-04T00:54:10.996432+00:00

_(empty)_

### system — 2025-09-04T00:54:10.996432+00:00

_(empty)_

### assistant — 2025-09-04T00:54:12.393522+00:00

{"search_query": [{"q": "Windows Server 2025 IIS ASP.NET enable ASP.NET 4.8 ASMX"}, {"q": "Run .asmx on IIS Windows Server 2025"}, {"q": "Install-WindowsFeature ASP.NET 4.8 IIS 10 Windows Server 2025 PowerShell"}, {"q": "ASMX IIS handler mappings setup *.asmx"}], "response_length": "short"}

### system — 2025-09-04T00:54:13.259960+00:00

_(empty)_

### system — 2025-09-04T00:54:13.352119+00:00

_(empty)_

### assistant — 2025-09-04T00:54:13.412854+00:00

_(empty)_

### assistant — 2025-09-04T00:54:13.625249+00:00

_(empty)_

### tool — 2025-09-04T00:54:24.323413+00:00

_(empty)_

### assistant — 2025-09-04T00:54:30.687468+00:00

_(empty)_

### assistant — 2025-09-04T00:54:31.621256+00:00

やあ司令、ASMX（古いASP.NET Webサービス）を **Windows Server 2025 / Windows 11(24H2以降)** の IIS で動かす最小セットアップを一気にまとめるね。  

## 1) 機能の有効化
### Windows Server 2025（PowerShell/管理者）
```powershell
# IIS 本体 + ASP.NET 4.x 実行に必要な機能
Install-WindowsFeature Web-Server, Web-Common-Http, Web-Default-Doc, Web-Static-Content, `
  Web-Http-Errors, Web-Http-Redirect, Web-Health, Web-Http-Logging, Web-Performance, `
  Web-Security, Web-Filtering, Web-App-Dev, Web-Net-Ext45, Web-Asp-Net45, Web-ISAPI-Ext, `
  Web-ISAPI-Filter, Web-Mgmt-Tools, Web-Mgmt-Console
```
（`Install-WindowsFeature` の正式解説はここ。citeturn0search15 / ASP.NET 機能の入れ方の例はここ。citeturn0search0）

### Windows 11（クライアント）
```cmd
DISM /Online /Enable-Feature /All /FeatureName:IIS-WebServerRole /FeatureName:IIS-ASPNET45
```
（IIS で ASP.NET 4.8 を有効化する手順の要点。citeturn0search13）

> もしアプリが **.NET 2.0/3.5** でビルドされているなら、**.NET Framework 3.5** 機能も別途有効化してね（Windows の「機能の有効化」から）。  

---

## 2) アプリプールとサイト設定（IIS マネージャー）
1. **アプリプール**：  
   - **.NET CLR バージョン** = **v4.0**  
   - **管理パイプライン** = **統合(Integrated)**
2. **対象サイト/仮想ディレクトリ**をアプリとして作成し、上のアプリプールを **割り当て**。
3. （32bit 依存がある場合のみ）アプリプールの **32 ビットアプリケーションの有効化** = `True`。

IIS 機能の場所や概念の整理はこちら。citeturn0search3

---

## 3) ハンドラマッピング（*.asmx）
- サイト（またはアプリ）の **[ハンドラマッピング]** に **`*.asmx` → WebServiceHandlerFactory-Integrated**（または Managed Handler）が登録されていることを確認。  
- もし `*.asmx` が **静的ハンドラに奪われて 403** になる場合は、`*.asmx` を **ASP.NET ハンドラ**に明示マップ。手順の概要は以下：  
  - IIS マネージャー → サイト → **[ハンドラマッピング]** → **[スクリプトマップの追加]** で `*.asmx` を ASP.NET ハンドラに関連付け。  
  詳細の考え方と手順は公式リファレンスにまとまってる。citeturn0search5turn0search9turn0search19

---

## 4) 配置と動作確認
- 配置構成：`/bin` 配下に DLL、ルートに `*.asmx`、`web.config`。  
- ブラウザで `https://<host>/xxx.asmx` を開き、ASMX の **メソッド一覧ページ**が出ればOK。  
- `HTTP Error 403.14`（ディレクトリ一覧禁止）の場合は **既定のドキュメント**やルートに `Default.aspx` が無い等が原因なので、直接 `*.asmx` を叩く or 既定ドキュメントを調整。citeturn0search11

---

## 5) つまずき対策・チェックリスト
- **ターゲット .NET**：ビルド対象が 4.x なら **ASP.NET 4.8 機能**が必須。2.0/3.5 アプリは **.NET 3.5 機能**も必要。citeturn0search13  
- **再登録は原則不要**：IIS7+ 以降は `aspnet_regiis -i` は通常不要（機能を有効化すればハンドラが入る）。ハンドラに問題があるときのみ手動マップを検討。citeturn0search6turn0search5  
- **URL の末尾が /MethodName** で 500/形式エラー → 多くは **SOAP/POST** 要求でない・拡張子マップ不備。`?op=Method` の UI から **Invoke** して送ってみる。citeturn0search7  

---

## 6) 最小 web.config（例／.NET 4.8）
```xml
<?xml version="1.0"?>
<configuration>
  <system.web>
    <compilation targetFramework="4.8" debug="false" />
    <httpRuntime targetFramework="4.8" />
  </system.web>
</configuration>
```
※ フレームワークはアプリの実際のターゲットに合わせてね。

---

必要なら、**PowerShell一発で役割＋サイト＋アプリプール作成**のスクリプトも書くよ。エラー症状（ステータスコードやイベントログ）を教えてくれたら、原因切り分けチャートで詰めよう。

送信日時（日本時間）: [[REDACTED_PHONE]]:54 JST

### assistant — 2025-09-04T00:54:33.183069+00:00

_(empty)_

### system — 2025-09-04T00:57:57.134655+00:00

_(empty)_

### assistant — 2025-09-04T00:57:57.222232+00:00

司令、対象プログラムが **32bit 向けか 64bit 向けか**を見分ける方法を整理したよ。Windows 2025 でも基本は同じ。  

---

## 1. 実行ファイル (.exe / .dll) の確認方法
### PowerShellで調べる
```powershell
# exe/dll がどのアーキテクチャか確認
Get-Item .\YourApp.exe | Get-PEHeader | Select-Object Machine
```
※ `Get-PEHeader` は標準には無いので、[PEヘッダ確認用のスクリプトやモジュール](https://www.powershellgallery.com/packages/Get-PEHeader)を入れると便利。  

### 標準でできる方法（sigcheck）
Sysinternals の **sigcheck.exe** を使うと簡単：
```cmd
sigcheck -q -a YourApp.exe
```
→ `32-bit` や `64-bit` が表示される。

---

## 2. Visual Studio / dumpbin を使う
Visual Studio を入れているなら：
```cmd
dumpbin /headers YourApp.exe | findstr machine
```
- `14C` = x86（32bit）  
- `8664` = x64（64bit）  

---

## 3. 実行中プロセスで調べる
- **タスクマネージャー** → 詳細タブ → 列の追加で「プラットフォーム」を表示。  
- `32 ビット` と表示されていれば WOW64 上で走っている（=32bit）。  
- `64 ビット` ならネイティブ 64bit。

---

## 4. .NET アセンブリの場合
`corflags` ツール（Visual Studio 開発者コマンドプロンプトから利用）で確認：
```cmd
corflags YourApp.exe
```
出力の `PE` 列が
- `PE32` → 32bit  
- `PE32+` → 64bit  

`32BIT` フラグが `1` なら強制 32bit 実行。`AnyCPU` アセンブリなら環境に応じて 32/64 両対応。  

---

## 5. IIS アプリの見分け方
ASMX アプリを IIS にデプロイする場合は：
- アプリプールの「32 ビットアプリケーションの有効化」が **True** なら 32bit CLR で実行。  
- ここを False にしても動くなら 64bit CLR 対応。  

---

👉 まとめると：
- 単体ファイルなら **dumpbin/sigcheck/corflags**。  
- 実行中なら **タスクマネージャー**。  
- IIS 上なら **アプリプールの設定**で実質的に判断。  

---

司令、今の対象プログラムは **自作の .NET アプリ**？ それとも **既存の外部ライブラリ（サードパーティDLL）**かどっちを調べたい？  

送信日時（日本時間）: [[REDACTED_PHONE]]:10 JST

### system — 2025-09-04T00:57:57.339648+00:00

_(empty)_

### user — 2025-09-04T00:57:57.368000+00:00

対象プログラムが32/64のいずれに対応しているかを判断する方法

### assistant — 2025-09-04T00:59:10.694149+00:00

search("webdeploy\u3092\u4f7f\u7528\u3057\u3066windows2025\u306eiis\u3082\u5bfe\u5fdc\u53ef\u80fd\uff1f")

### user — 2025-09-04T00:59:10.788000+00:00

webdeployを使用してwindows2025のiisも対応可能？

### tool — 2025-09-04T00:59:12.088437+00:00

_(empty)_

### assistant — 2025-09-04T00:59:13.410169+00:00

はい司令、Web Deploy（別名 msdeploy）は **Windows Server 2025** の IIS に対しても対応可能です。以下に詳しくまとめました。

---

##  対応状況と前提条件

### 1. Web Deploy 4.0 は Windows Server 2025 を正式サポート
- Microsoft のダウンロード情報によると、**Web Deploy 4.0** は次の OS をサポート対象に含んでいます：

  > **Windows 10, Windows 11, Windows Server 2016, 2019, 2022, 2025**  
  > （すべて 64-bit プラットフォーム）  
  citeturn0search0

  つまり、**Windows Server 2025（IIS 10）でも Web Deploy を使用可能**であることが公式に認められています。

### 2. IIS のバージョンに関して
- Windows Server 2025 に搭載されている IIS は **IIS 10** であり、以前のバージョンとの互換性があります citeturn0search12turn0search19。
- Web Deploy は IIS 7〜10 に対応しており、2025 の IIS 10 も含まれます citeturn0search1turn0search11。

---

##  インストールと基本構成の流れ

以下は、Web Deploy を Windows Server 2025＋IIS 10 上に導入して利用するための基本手順です：

### ステップ 1：IIS と必要な管理機能のインストール
PowerShell やサーバーマネージャーで以下をインストール：

```powershell
Install-WindowsFeature Web-Server, Web-Mgmt-Tools, Web-Mgmt-Service
```

Web Management Service（WMSVC）はリモートからの Web Deploy 接続に必要です citeturn0search8turn0search5。

### ステップ 2：Web Deploy 4.0 のインストール
- Microsoft から提供されている **amd64（64-bit）版 MSI** を使用。
- インストール時は **Complete（完全）インストール** オプションを選択することが推奨されます。これにより Visual Studio などからの公開にも対応できます citeturn0search5turn0search10。

### ステップ 3：Web Management Service の起動と確認
- MSI インストール後に、サービスが正しく動作しているか確認。
- 必要であれば以下のコマンドを実行して起動：

```powershell
Start-Service WMSVC
```

### ステップ 4：IIS マネージャーで公開設定
- IIS マネージャー上で対象サイトの「IIS マネージャー権限」設定や「Web Deploy 発行設定」を行うことで、特定ユーザーによる公開が可能になります（管理者以外にも権限付与可能） citeturn0search2。

---

##  一言まとめ

- **対応：** Windows Server 2025 上の IIS（IIS 10）には Web Deploy 4.0 が正式に対応しています。
- **インストール手順：** IIS → WMSVC → Web Deploy（Complete） → サービス起動 → IIS による設定の流れです。

---

司令、もし必要なら Web Deploy の PowerShell スクリプトや自動化テンプレートの例も提供できます。ご希望があればどうぞ！

送信日時（日本時間）: [[REDACTED_PHONE]]:22 JST
